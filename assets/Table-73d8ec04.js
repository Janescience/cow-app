import{a as S,W as A,o as n,c as d,w as f,s as u,H as B,X as L,Y as R,z as M,p as T,m as U,_ as Y,v as I,g as N,f as z,O as F,B as H,$ as E,F as h,J as i,d as _,t as g,K as m,L as C,k as y,n as x,I as O}from"./index-8c38d2ab.js";const J={class:"checkbox"},K=u("span",{class:"check"},null,-1),W={__name:"TableCheckboxCell",props:{type:{type:String,default:"td"},isChecked:{type:Boolean,default:!1}},emits:["checked"],setup(a,{emit:t}){const e=a,o=S(e.isChecked);return A(o,r=>{t("checked",r)}),(r,s)=>(n(),d(R(e.type),{class:"checkbox-cell"},{default:f(()=>[u("label",J,[B(u("input",{"onUpdate:modelValue":s[0]||(s[0]=k=>o.value=k),type:"checkbox"},null,512),[[L,o.value]]),K])]),_:1}))}},X={data(){return{textConfirm:"",modalConfirm:!1,funcConfirm:Function,idConfirm:null,dataSelectedConfirm:[],currentPage:0,checkedRows:[]}},props:{title:{type:String,default:""},items:{type:Array,default:[]},datas:{type:Array,default:[]},buttons:{type:Array,default:[]},hasCheckbox:Boolean,checkedData:{type:Object,default:null},perPage:{type:Number,default:10},icon:{type:String,default:""},loading:Boolean},computed:{itemsPaginated(){return this.items?this.items.slice(this.perPage*this.currentPage,this.perPage*(this.currentPage+1)):[]},numPages(){return Math.ceil((this.items?this.items.length:0)/this.perPage)},currentPageHuman(){return this.currentPage+1},pagesList(){const a=[];for(let t=0;t<this.numPages;t++)a.push(t);return a}},components:{BaseButton:T,BaseButtons:U,CardBox:Y,CardBoxModal:I,TableCheckboxCell:W,UserAvatar:N,BaseLevel:z,BaseIcon:F},methods:{getValue(a,t){const e=this.getPropByString(a,t.value);if(!t.type)return t.func?t.func(a):e;switch(t.type){case"number":return this.formatCurrency(e);case"date":return this.formatDate(e);case"image":return e;case"icon":return e}},getPropByString(a,t){if(!t)return a;let e,o=t.split(".");for(var r=0,s=o.length-1;r<s;r++){e=o[r];var k=a[e];if(k!==void 0)a=k;else break}return a[o[r]]},btnClick(a,t){switch(a){case"edit":this.edit(t.data);break;case"delete":this.confirm("ยืนยันลบรายการนี้ ใช่หรือไม่ ?",t.id,null,this.removeData);break;case"detail":this.detail(t.path+"/"+t.id);break}},removeData(){this.$emit("delete",this.idConfirm)},removeSelected(){this.$emit("deleteSelected",this.dataSelectedConfirm),this.checkedRows=[]},edit(a){this.$emit("edit",a)},detail(a){this.$router.push(a)},confirm(a,t,e,o){this.textConfirm=a,this.funcConfirm=o,this.idConfirm=t,this.dataSelectedConfirm=e,this.modalConfirm=!0},checked(a,t){a?(t.checked=!0,this.checkedRows.push(t)):(t.checked=!1,this.checkedRows=this.removeArr(this.checkedRows,e=>e._id===t._id))},countChecked(){return this.checkedRows.length>0?"(เลือก "+this.checkedRows.length+" รายการ)":""},removeArr(a,t){const e=[];return a.forEach(o=>{t(o)||e.push(o)}),e},formatDate(a){return a?H(new Date(a)).format("DD/MM/YYYY"):null},formatCurrency(a){return E(a).format(0,0)}}},q={key:0,class:"p-3 bg-gray-100/50 dark:bg-gray-800"},G={class:"overflow-x-auto"},Q={key:0,class:"text-center whitespace-nowrap"},Z={key:1},j=["data-label"],$={key:2},ee={key:1,class:"lg:w-6 whitespace-nowrap"},te={class:"p-3 lg:px-6 border-t border-gray-100 dark:border-gray-800"};function ae(a,t,e,o,r,s){const k=h("CardBoxModal"),p=h("BaseButton"),b=h("BaseButtons"),w=h("TableCheckboxCell"),P=h("UserAvatar"),D=h("BaseIcon"),V=h("BaseLevel"),v=h("CardBox");return n(),i(m,null,[_(k,{modelValue:r.modalConfirm,"onUpdate:modelValue":t[0]||(t[0]=l=>r.modalConfirm=l),title:"ยืนยันอีกครั้ง","button-label":"ยืนยัน",onConfirm:r.funcConfirm,"has-cancel":"","has-button":""},{default:f(()=>[u("p",null,g(r.textConfirm),1)]),_:1},8,["modelValue","onConfirm"]),s.itemsPaginated.length>0?(n(),d(v,{key:0,title:e.title+" "+s.countChecked(),class:"shadow-lg mb-5","has-table":"",icon:e.icon,"header-icon":""},{default:f(()=>[r.checkedRows.length>0?(n(),i("div",q,[(n(!0),i(m,null,C(r.checkedRows,l=>(n(),i("span",{key:l._id,class:"inline-block px-2 py-1 rounded-sm mr-2 text-sm bg-gray-100 dark:bg-gray-700 mb-1"},g((e.checkedData.code?s.getValue(l,e.checkedData.code)+" : ":"")+s.getValue(l,e.checkedData.label)),1))),128)),_(b,{type:"justify-start lg:justify-end","no-wrap":""},{default:f(()=>[_(p,{color:"danger",label:"ลบทั้งหมด",onClick:t[1]||(t[1]=l=>s.confirm("ยืนยันลบรายการที่เลือกทั้งหมด ใช่หรือไม่ ?",null,r.checkedRows,s.removeSelected))})]),_:1})])):y("",!0),u("div",G,[u("table",null,[u("thead",null,[u("tr",null,[e.hasCheckbox?(n(),i("th",Q,"เลือก")):y("",!0),(n(!0),i(m,null,C(e.datas,l=>(n(),i("th",{key:l.label,class:x(["whitespace-nowrap",[l.class]])},g(l.label),3))),128)),e.buttons.length>0?(n(),i("th",Z)):y("",!0)])]),u("tbody",null,[(n(!0),i(m,null,C(s.itemsPaginated,l=>(n(),i("tr",{key:l._id,class:x(l.new?"text-green-300":"")},[e.hasCheckbox?(n(),d(w,{key:0,isChecked:l.checked,class:"text-center border-b-0 lg:w-6 before:hidden",onChecked:c=>s.checked(c,l)},null,8,["isChecked","onChecked"])):y("",!0),(n(!0),i(m,null,C(e.datas,c=>(n(),i("td",{key:c.label,"data-label":c.label,class:x(["whitespace-nowrap",[c.class]])},[c.type==="image"?(n(),d(P,{key:0,avatar:s.getValue(l,c),username:"profile",class:"w-36 mx-auto lg:h-20 lg:w-20"},null,8,["avatar"])):c.type==="icon"?(n(),d(D,{key:1,path:s.getValue(l,c),size:"22"},null,8,["path"])):(n(),i("span",$,g(s.getValue(l,c)),1))],10,j))),128)),e.buttons.length>0?(n(),i("td",ee,[_(b,{type:"justify-end lg:justify-start","no-wrap":""},{default:f(()=>[(n(!0),i(m,null,C(e.buttons,c=>B((n(),d(p,{small:"",key:c.label,color:c.color,label:c.label,onClick:le=>c.type==="oth"?c.func(l):s.btnClick(c.type,{data:l,id:l._id,path:c.path})},null,8,["color","label","onClick"])),[[O,c.condition?c.condition(l):!0]])),128))]),_:2},1024)])):y("",!0)],2))),128))])])]),u("div",te,[_(V,null,{default:f(()=>[_(b,null,{default:f(()=>[(n(!0),i(m,null,C(s.pagesList,l=>(n(),d(p,{key:l,active:l===r.currentPage,label:l+1,small:"",class:"p-0 text-sm",onClick:c=>r.currentPage=l},null,8,["active","label","onClick"]))),128))]),_:1}),u("small",null,"หน้า "+g(s.currentPageHuman)+" จาก "+g(s.numPages),1)]),_:1})])]),_:1},8,["title","icon"])):e.loading?(n(),d(v,{key:1,title:e.title+" "+s.countChecked(),"header-icon":"",loading:""},null,8,["title"])):(n(),d(v,{key:2,title:e.title+" "+s.countChecked(),"header-icon":"",empty:""},null,8,["title"]))],64)}const se=M(X,[["render",ae]]);export{se as T};
