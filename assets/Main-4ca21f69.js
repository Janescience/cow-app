import{c as M,_ as q,d as L}from"./BaseDivider-9edf4e01.js";import{_ as j}from"./LayoutAuthenticated-96665147.js";import{_ as $}from"./SectionTitleBarSub-1350e779.js";import{T as A}from"./Table-2f3f3207.js";import{C as T}from"./Criteria-1b65da79.js";import{_ as F}from"./UserAvatar-64ee2716.js";import{v as N,_ as V,y as w,c as S,w as D,z as d,o as r,d as y,s as l,F as I,D as O,j as s,t as u,f as p,g as h}from"./index-ae395474.js";import{F as C}from"./food-a541e774.js";import{C as R}from"./cow-e7aeb5ac.js";import{T as P}from"./alert-019710c2.js";import"./CardBoxModal-083dba37.js";import"./FormControl-6725e5f0.js";import"./CardBoxCollapse-693e8138.js";import"./FormField-09d99245.js";import"./FormCheckRadioPicker-155ac12c.js";import"./Cow-77d0c522.js";import"./Recipe-ccc9cf97.js";import"./Vaccine-5db646be.js";import"./Corral-26e6d49e.js";const z={data(){return{perPage:12,currentPage:0,openModal:!1,modalData:null,items:[],ddlCorral:[],forms:[{label:"คอก",value:"corral",icon:"barn",type:"number"}],search:{corral:""},loading:!1,mode:"create",dataEdit:null,checked:{code:{value:"corral"},label:{value:"recipe.name"}},datas:[{label:"คอก",class:"text-center",value:"corral"},{label:"จำนวนวัว",class:"text-center",value:"numCow"},{label:"สูตรอาหาร",class:"text-center",value:"recipe.name"},{label:"จำนวนที่ให้/วัน (กก.)",class:"text-center",value:"qty"},{label:"รวมเป็นเงิน/วัน",class:"text-center",value:"amount",func:t=>t.amount.toFixed(2)},{label:"คิดเป็นเงิน/ตัว",class:"text-center",value:"amountAvg",func:t=>t.amountAvg.toFixed(2)}],buttons:[{label:"ลบ",type:"delete",color:"danger"},{label:"แก้ไข",type:"edit",color:"warning"}]}},components:{SectionMain:M,LayoutAuthenticated:j,SectionTitleBarSub:$,Table:A,Criteria:T,BaseLevel:V,UserAvatar:F,CardBox:q,BaseIcon:L},computed:{getDataCopy(){return{...this.modalData}},corral(){return this.ddlCorral},itemsPaginated(){return this.items?this.items.slice(this.perPage*this.currentPage,this.perPage*(this.currentPage+1)):[]},numPages(){return Math.ceil((this.items?this.items.length:0)/this.perPage)},currentPageHuman(){return this.currentPage+1},pagesList(){const t=[];for(let a=0;a<this.numPages;a++)t.push(a);return t}},created(){this.getDatas()},methods:{async getDatas(t){this.loading=!0;const a=await C.all(t);if(this.items=[],a.data){const _=a.data.foods,o=w.groupBy(_,"corral");for(let c of Object.keys(o)){const n=o[c];let g=0,x=0,m=0,v=0,k=0;for(let i of n)g+=i.foodDetails.reduce((f,e)=>f+e.qty,0),x+=g*new Date(i.year,i.month,0).getDate(),m+=i.foodDetails.reduce((f,e)=>f+e.amount,0),v+=m*new Date(i.year,i.month,0).getDate(),k+=i.foodDetails.length;this.items.push({corral:c,amountDay:m,amountMonth:v,qtyDay:g,qtyMonth:x,count:k,foods:n})}}this.getCorrals()},async remove(t){this.loading=!0,(await C.delete(t)).data&&this.getDatas(),this.loading=!1,P.fire({icon:"success",title:"ลบข้อมูลสำเร็จ"})},async removeSelected(t){this.loading=!0;let a=[];for(let o of t)a.push(o._id);(await C.deletes(a)).data&&(this.getReproductions(),P.fire({icon:"success",title:"ลบข้อมูลสำเร็จ"})),this.loading=!1},async getCorrals(){const t=await R.all();if(t){const a=t.data.cows,_=w.groupBy(a,"corral");for(let o of Object.keys(_))o!="undefined"&&(this.ddlCorral.push({id:o,label:o}),this.items.map(n=>n.corral).indexOf(o)<0&&this.items.push({corral:o}))}this.loading=!1},detail(t){this.$router.push({name:"foodDetail",params:{corral:t.corral}})},reset(){this.search.corral="",this.getDatas()},resetData(){this.modalData=null}}},E={key:0,class:"grid lg:gap-3 md:gap-2 gap-1 grid-cols-2 lg:grid-cols-4 md:grid-cols-3"},Q={class:"bg-orange-800 rounded-full text-orange-400 lg:text-3xl text-xl lg:w-16 lg:h-16 w-12 h-12 justify-center flex items-center font-extrabold"},H={class:"mt-2 h-18 lg:text-sm text-xs mb-1"},U={key:0,class:"dark:text-gray-400 grid grid-cols-2"},G=s("div",null," จำนวนรวม/วัน ",-1),J={class:"flex justify-end"},K={class:"underline decoration-2 dark:text-gray-100 mr-1"},W={key:1,class:"dark:text-gray-400 grid grid-cols-2"},X=s("div",null," ราคารวม/วัน ",-1),Y={class:"flex justify-end"},Z={class:"underline decoration-2 dark:text-gray-100 mr-1"},tt={key:2,class:"dark:text-gray-400 grid grid-cols-2"},et=s("div",null," จำนวนรวม/เดือน ",-1),st={class:"flex justify-end"},at={class:"underline decoration-2 dark:text-gray-100 mr-1"},ot={key:3,class:"dark:text-gray-400 grid grid-cols-2"},rt=s("div",null," ราคารวม/เดือน ",-1),nt={class:"flex justify-end"},it={class:"underline decoration-2 dark:text-gray-100 mr-1"},lt={key:4,class:"dark:text-gray-400 grid grid-cols-2"},ct=s("div",null," บันทึกแล้ว ",-1),dt={class:"flex justify-end"},ut={class:"underline decoration-2 dark:text-gray-100 mr-1"},ht={key:5,class:"dark:text-gray-600 text-center pt-5"},_t={key:1,class:"text-center py-10 text-gray-500 dark:text-gray-400"},gt=s("p",null," กำลังโหลดข้อมูล...",-1);function mt(t,a,_,o,c,n){const g=d("SectionTitleBarSub"),x=d("Criteria"),m=d("BaseLevel"),v=d("CardBox"),k=d("BaseIcon"),i=d("SectionMain"),f=d("LayoutAuthenticated");return r(),S(f,null,{default:D(()=>[y(i,null,{default:D(()=>[y(g,{icon:"corn",title:"การให้อาหาร (แยกตามคอก)"}),y(x,{grid:"grid-cols-2 lg:grid-cols-4",onSearch:n.getDatas,onReset:n.reset,forms:c.forms,search:c.search,btnLoading:c.loading},null,8,["onSearch","onReset","forms","search","btnLoading"]),c.loading?(r(),l("div",_t,[y(k,{path:"dotsCircle",size:"22",class:"animate-spin"}),gt])):(r(),l("div",E,[(r(!0),l(I,null,O(n.itemsPaginated,e=>(r(),S(v,{key:e.corral,onClick:b=>n.detail(e),hoverable:""},{default:D(()=>{var b,B;return[y(m,{type:"justify-center mt-1"},{default:D(()=>[s("div",Q,u(e.corral),1)]),_:2},1024),s("div",H,[e.qtyDay?(r(),l("div",U,[G,s("div",J,[s("div",K,u(t.$filters.number(e.qtyDay)),1),p(" กก. ")])])):h("",!0),e.qtyDay?(r(),l("p",W,[X,s("div",Y,[s("div",Z,u(t.$filters.currency(e.amountDay)),1),p(" บาท ")])])):h("",!0),e.qtyDay?(r(),l("div",tt,[et,s("div",st,[s("div",at,u(t.$filters.number(e.qtyMonth)),1),p(" กก. ")])])):h("",!0),e.qtyDay?(r(),l("p",ot,[rt,s("div",nt,[s("div",it,u(t.$filters.currency(e.amountMonth)),1),p(" บาท ")])])):h("",!0),((b=e==null?void 0:e.foods)==null?void 0:b.length)>0?(r(),l("p",lt,[ct,s("div",dt,[s("div",ut,u((B=e==null?void 0:e.foods)==null?void 0:B.length),1),p(" เดือน ")])])):h("",!0),e.qtyDay?h("",!0):(r(),l("p",ht," (ไม่ได้บันทึกการให้อาหาร) "))])]}),_:2},1032,["onClick"]))),128))]))]),_:1})]),_:1})}const Tt=N(z,[["render",mt]]);export{Tt as default};
