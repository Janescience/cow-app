import{a as U,V as C,o as n,c as i,w as f,I as p,s as V,n as g,N as S,k as _,h as T,t as j,q as b,e as D,d as m,O as q,a0 as I,y as v,z as F,E as o,p as O,m as N,l as $,i as A,K as z,J as E}from"./index-b0424bc3.js";import{_ as P}from"./FormField-83a280ab.js";import{_ as H}from"./FormCheckRadioPicker-0cebee5e.js";import{D as J}from"./Cow-be53b426.js";const K=["onClick"],M={key:1,class:"text-center py-10 text-gray-500 dark:text-gray-400"},Q=V("p",null,"ไม่มีรายการ...",-1),G=[Q],W={key:2,class:"text-center py-10 text-gray-500 dark:text-gray-400"},X=V("p",null," กำลังโหลดข้อมูล...",-1),Y={__name:"CardBoxCollapse",props:{title:{type:String,default:null},icon:{type:String,default:null},headerIcon:{type:String,default:null},rounded:{type:String,default:"md:rounded-2xl"},hasTable:Boolean,empty:Boolean,loading:Boolean,form:Boolean,hoverable:Boolean,modal:Boolean},emits:["header-icon-click","submit"],setup(t,{emit:l}){const e=t;var s=U(!1);const k=C(()=>e.form?"form":"div"),d=C(()=>{const r=[e.rounded,(e.modal,"dark:bg-gray-900")];return e.hoverable&&r.push("hover:shadow-lg transition-shadow duration-500"),r}),u=C(()=>s.value?"chevronDown":"chevronUp"),h=()=>{l("header-icon-click")},y=r=>{l("submit",r)},B=()=>{s.value=!s.value};return(r,x)=>(n(),i(I(b(k)),{class:g([b(d),"bg-white border shadow-lg border-gray-300 dark:border-gray-900"]),onSubmit:y},{default:f(()=>[t.title?(n(),p("header",{key:0,onClick:B,class:"flex items-stretch border-b border-gray-100 dark:border-gray-800"},[V("p",{class:g(["flex items-center py-3 grow font-bold",[t.icon?"px-4":"px-6"]])},[t.icon?(n(),i(S,{key:0,path:t.icon,class:"mr-3"},null,8,["path"])):_("",!0),T(" "+j(t.title),1)],2),b(u)?(n(),p("a",{key:0,href:"#",class:"flex items-center py-3 px-4 justify-center ring-blue-700 focus:ring","aria-label":"more options",onClick:D(h,["prevent"])},[m(S,{path:b(u),size:"18"},null,8,["path"])],8,K)):_("",!0)])):_("",!0),t.empty?(n(),p("div",M,G)):t.loading?(n(),p("div",W,[t.loading?(n(),i(S,{key:0,path:"dotsCircle",size:"22",class:"animate-spin"})):_("",!0),X])):b(s)?(n(),p("div",{key:3,class:g({"p-6":!t.hasTable})},[q(r.$slots,"default")],2)):_("",!0)]),_:3},40,["class"]))}};async function Z(t={}){let l="?";return t.type&&(l=l+`type=${t.type}&`),t.recipe&&(l=l+`recipe=${t.recipe}&`),t?l.replace(/&*$/,""):""}class ee{async all(l){const e=await Z(l);return v.get("/recipe"+e).then(s=>s)}get(l){return v.get(`/recipe/${l}`)}create(l){return v.post("/recipe",l)}delete(l){return v.delete(`/recipe/${l}`)}update(l,e){return v.put(`/recipe/${l}`,e)}}const te=new ee;const ae={data(){return{datas:[]}},created(){this.initialData()},computed:{value:{get(){var t;return this.valueType==="object"&&(this.modelValue.recipe_data=(t=this.modelValue)==null?void 0:t.name),this.modelValue},set(t){this.$emit("update:modelValue",t)}},user(){return this.$store.state.auth.user}},methods:{async initialData(){const t={farm:this.user.farm._id};try{const l=await te.all(t);if(this.datas=[],l&&(this.datas=l.data.recipes,this.datas.map(e=>e.recipe_data=e.name)),this.defaultValue){const e=this.datas.filter(s=>s[this.defaultType]==this.defaultValue);e&&this.handleInput(this.reduceAction(e[0]))}}catch(l){this.datas=[],console.error("Error: "+l.message)}},reduceAction(t){return this.valueType==="object"?t:t[this.valueType]},handleInput(t){this.$emit("update:value",t),this.dataSelected=this.datas.find(l=>l.name===t),this.$emit("update:dataSelected",this.dataSelected)}},props:{clear:{default:!0,type:Boolean},disabled:{default:!1,type:Boolean},dataSelected:{default:null,type:Object},defaultType:{default:null,type:Object},valueType:{default:"_id",type:Object},defaultValue:{default:null,type:Object},modelValue:{type:[String,Number,Boolean,Array,Object],default:""},multiple:{default:!1,type:Boolean}}},le={class:"relative"};function ne(t,l,e,s,k,d){const u=o("mdicon"),h=o("v-select");return n(),p("div",le,[m(h,{class:"ddl",clearable:e.clear,disabled:e.disabled,options:k.datas,reduce:d.reduceAction,label:"recipe_data",placeholder:"เลือกสูตรอาหาร",onInput:d.handleInput,modelValue:d.value,"onUpdate:modelValue":l[0]||(l[0]=y=>d.value=y),dataSelected:e.dataSelected,multiple:e.multiple},{"no-options":f(()=>[m(u,{name:"alertCircleOutline",width:"16",height:"16",class:"inline-block"}),T(" ไม่พบข้อมูล ")]),_:1},8,["clearable","disabled","options","reduce","onInput","modelValue","dataSelected","multiple"])])}const oe=F(ae,[["render",ne]]),se={props:{grid:{type:String,default:"grid-cols-4"},forms:{type:Array,default:[]},search:{type:Object,default:null},collapse:Boolean,btnSubmitLabel:{type:String,default:"ค้นหา"},btnLoading:Boolean},components:{BaseButton:O,BaseButtons:N,BaseDivider:$,CardBoxCollapse:Y,FormField:P,FormControl:A,FormCheckRadioPicker:H,DDLCow:J,DDLRecipe:oe},methods:{submit(){this.$emit("search",this.search)},reset(){this.$emit("reset",this.search)}}};function ie(t,l,e,s,k,d){const u=o("DDLCow"),h=o("DDLRecipe"),y=o("FormCheckRadioPicker"),B=o("FormControl"),r=o("FormField"),x=o("BaseDivider"),w=o("BaseButton"),L=o("BaseButtons"),R=o("CardBoxCollapse");return n(),i(R,{title:"ค้นหา",icon:"",form:"",class:"mb-2","header-icon":"",collapse:e.collapse,onSubmit:D(d.submit,["prevent"]),onReset:D(d.reset,["prevent"])},{default:f(()=>[V("div",{class:g(["grid gap-5",[e.grid]])},[(n(!0),p(E,null,z(e.forms,a=>(n(),i(r,{key:a.value,label:a.label,class:g([a.class])},{default:f(()=>[a.type==="ddl"&&a.module==="cow"?(n(),i(u,{key:0,modelValue:e.search[a.value],"onUpdate:modelValue":c=>e.search[a.value]=c,valueType:a.valueType},null,8,["modelValue","onUpdate:modelValue","valueType"])):a.type==="ddl-multiple"&&a.module==="cow"?(n(),i(u,{key:1,modelValue:e.search[a.value],"onUpdate:modelValue":c=>e.search[a.value]=c,valueType:a.valueType,mutiple:""},null,8,["modelValue","onUpdate:modelValue","valueType"])):a.type==="ddl"&&a.module==="recipe"?(n(),i(h,{key:2,modelValue:e.search[a.value],"onUpdate:modelValue":c=>e.search[a.value]=c,valueType:a.valueType},null,8,["modelValue","onUpdate:modelValue","valueType"])):a.type==="radio"?(n(),i(y,{key:3,modelValue:e.search[a.value],"onUpdate:modelValue":c=>e.search[a.value]=c,type:a.type,options:a.options,required:a.required},null,8,["modelValue","onUpdate:modelValue","type","options","required"])):(n(),i(B,{key:4,modelValue:e.search[a.value],"onUpdate:modelValue":c=>e.search[a.value]=c,icon:a.icon,options:a.options,type:a.type,required:a.required},null,8,["modelValue","onUpdate:modelValue","icon","options","type","required"]))]),_:2},1032,["label","class"]))),128))],2),m(x),m(L,{type:"justify-center","no-wrap":""},{default:f(()=>[m(w,{type:"submit",color:"info",label:e.btnSubmitLabel,loading:e.btnLoading,disabled:e.btnLoading},null,8,["label","loading","disabled"]),m(w,{type:"reset",color:"danger",label:"ล้าง"})]),_:1})]),_:1},8,["collapse","onSubmit","onReset"])}const pe=F(se,[["render",ie]]);export{pe as C,oe as D,te as R};
