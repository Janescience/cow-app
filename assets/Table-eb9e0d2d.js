import{b as V,_ as A,d as R}from"./BaseDivider-5d6d6cd6.js";import{a as L,q as M,o as s,c as d,w as k,j as u,G as B,a2 as N,O as T,v as z,h as U,_ as F,x as Y,z as h,s as c,d as g,t as m,F as f,D as y,g as C,n as b,H}from"./index-a11eb788.js";import{_ as I}from"./CardBoxModal-4190cff7.js";import{_ as E}from"./UserAvatar-8818f699.js";import{_ as O}from"./FormControl-913bfab2.js";const q={class:"checkbox"},G=u("span",{class:"check"},null,-1),J={__name:"TableCheckboxCell",props:{type:{type:String,default:"td"},isChecked:{type:Boolean,default:!1}},emits:["checked"],setup(a,{emit:t}){const e=a,o=L(e.isChecked);return M(o,i=>{t("checked",i)}),(i,r)=>(s(),d(T(e.type),{class:"checkbox-cell"},{default:k(()=>[u("label",q,[B(u("input",{"onUpdate:modelValue":r[0]||(r[0]=_=>o.value=_),type:"checkbox"},null,512),[[N,o.value]]),G])]),_:1}))}},K={data(){return{textConfirm:"",modalConfirm:!1,funcConfirm:Function,idConfirm:null,dataSelectedConfirm:[],currentPage:0,checkedRows:[]}},props:{title:{type:String,default:""},items:{type:Array,default:[]},datas:{type:Array,default:[]},buttons:{type:Array,default:[]},hasCheckbox:Boolean,checkedData:{type:Object,default:null},perPage:{type:Number,default:10},icon:{type:String,default:""},noPaging:{type:Boolean,default:!1},loading:Boolean,rounded:{type:String,default:"md:rounded-2xl"}},computed:{itemsPaginated(){return this.items?this.items.slice(this.perPage*this.currentPage,this.perPage*(this.currentPage+1)):[]},numPages(){return Math.ceil((this.items?this.items.length:0)/this.perPage)},currentPageHuman(){return this.currentPage+1},pagesList(){const a=[];for(let t=0;t<this.numPages;t++)a.push(t);return a}},components:{BaseButton:V,BaseButtons:U,CardBox:A,CardBoxModal:I,TableCheckboxCell:J,UserAvatar:E,BaseLevel:F,BaseIcon:R,FormControl:O},methods:{getValue(a,t){const e=this.getPropByString(a,t.value);if(!t.type)return t.func?t.func(a):e;switch(t.type){case"number":return this.formatNumber(e);case"currency":return this.formatCurrency(e);case"date":return this.formatDate(e);case"image":return e;case"icon":return e}},getStyle(a,t){const e=this.getPropByString(a,t.style);switch(t.type){case"icon":return e}},getPropByString(a,t){if(!t)return a;let e,o=t.split(".");for(var i=0,r=o.length-1;i<r;i++){e=o[i];var _=a[e];if(_!==void 0)a=_;else break}return a[o[i]]},btnClick(a,t){switch(a){case"edit":this.edit(t.data);break;case"delete":this.confirm("ยืนยันลบรายการนี้ ใช่หรือไม่ ?",t.id,null,this.removeData(t.data));break;case"detail":this.detail(t.path+"/"+t.id);break}},removeData(a){this.$emit("delete",this.idConfirm?this.idConfirm:a)},removeSelected(){this.$emit("deleteSelected",this.dataSelectedConfirm),this.checkedRows=[]},edit(a){this.$emit("edit",a)},detail(a){this.$router.push(a)},confirm(a,t,e,o){this.textConfirm=a,this.funcConfirm=o,this.idConfirm=t,this.dataSelectedConfirm=e,this.modalConfirm=!0},checked(a,t){a?(t.checked=!0,this.checkedRows.push(t)):(t.checked=!1,this.checkedRows=this.removeArr(this.checkedRows,e=>e._id===t._id))},countChecked(){return this.checkedRows.length>0?"(เลือก "+this.checkedRows.length+" รายการ)":""},removeArr(a,t){const e=[];return a.forEach(o=>{t(o)||e.push(o)}),e},formatDate(a){return a?Y(a).format("DD/MM/YYYY"):null},formatNumber(a){return this.$filters.number(a)},formatCurrency(a){return this.$filters.currency(a)}}},Q={key:0,class:"p-3"},W={class:"overflow-x-auto"},X={key:0,class:"text-center whitespace-nowrap"},Z={key:1},j=["data-label"],$=["href"],ee={key:3},te={key:1,class:"lg:w-6 whitespace-nowrap"},ae={key:1,class:"p-2 static border-t border-gray-100 dark:border-gray-800 shadow-lg"};function le(a,t,e,o,i,r){const _=h("CardBoxModal"),p=h("BaseButton"),x=h("BaseButtons"),P=h("TableCheckboxCell"),w=h("UserAvatar"),S=h("BaseIcon"),D=h("BaseLevel"),v=h("CardBox");return s(),c(f,null,[g(_,{modelValue:i.modalConfirm,"onUpdate:modelValue":t[0]||(t[0]=l=>i.modalConfirm=l),title:"ยืนยันอีกครั้ง","button-label":"ยืนยัน",onConfirm:i.funcConfirm,"has-cancel":"","has-button":""},{default:k(()=>[u("p",null,m(i.textConfirm),1)]),_:1},8,["modelValue","onConfirm"]),r.itemsPaginated.length>0?(s(),d(v,{key:0,title:e.title+" "+r.countChecked(),class:"shadow-lg dark:border-gray-800 border","has-table":"",rounded:e.rounded,icon:e.icon,"header-icon":""},{default:k(()=>[i.checkedRows.length>0?(s(),c("div",Q,[(s(!0),c(f,null,y(i.checkedRows,l=>(s(),c("span",{key:l._id,class:"inline-block px-2 py-1 rounded-sm mr-2 text-sm bg-gray-100 dark:bg-gray-700 mb-1"},m((e.checkedData.code?r.getValue(l,e.checkedData.code)+" : ":"")+r.getValue(l,e.checkedData.label)),1))),128)),g(x,{type:"justify-start lg:justify-end","no-wrap":""},{default:k(()=>[g(p,{color:"danger",label:"ลบทั้งหมด",onClick:t[1]||(t[1]=l=>r.confirm("ยืนยันลบรายการที่เลือกทั้งหมด ใช่หรือไม่ ?",null,i.checkedRows,r.removeSelected))})]),_:1})])):C("",!0),u("div",W,[u("table",null,[u("thead",null,[u("tr",null,[e.hasCheckbox?(s(),c("th",X,"เลือก")):C("",!0),(s(!0),c(f,null,y(e.datas,l=>(s(),c("th",{key:l.label,class:"whitespace-nowrap text-center"},m(l.label),1))),128)),e.buttons.length>0?(s(),c("th",Z)):C("",!0)])]),u("tbody",null,[(s(!0),c(f,null,y(r.itemsPaginated,l=>(s(),c("tr",{key:l._id,class:b(l.new?"text-green-300":"")},[e.hasCheckbox?(s(),d(P,{key:0,isChecked:l.checked,class:"text-center border-b-0 lg:w-6 before:hidden",onChecked:n=>r.checked(n,l)},null,8,["isChecked","onChecked"])):C("",!0),(s(!0),c(f,null,y(e.datas,n=>(s(),c("td",{key:n.label,"data-label":n.label,class:b(["whitespace-nowrap",[n.class]])},[n.type==="image"?(s(),d(w,{key:0,avatar:r.getValue(l,n),username:"profile",class:b("mx-auto h-"+n.size+" w-"+n.size)},null,8,["avatar","class"])):n.type==="icon"?(s(),d(S,{key:1,path:r.getValue(l,n),class:b(r.getStyle(l,n)),size:"18"},null,8,["path","class"])):n.link&&n.link=="cowDetail"?(s(),c("a",{key:2,href:"/manage/cow/detail/"+l.cow.id,class:"text-blue-500 underline"},m(r.getValue(l,n)),9,$)):(s(),c("span",ee,m(r.getValue(l,n)),1))],10,j))),128)),e.buttons.length>0?(s(),c("td",te,[g(x,{type:"justify-end lg:justify-start","no-wrap":""},{default:k(()=>[(s(!0),c(f,null,y(e.buttons,n=>B((s(),d(p,{small:"",key:n.label,color:n.color,label:n.label,onClick:ne=>n.type==="oth"?n.func(l):r.btnClick(n.type,{data:l,id:l._id,path:n.path})},null,8,["color","label","onClick"])),[[H,n.condition?n.condition(l):!0]])),128))]),_:2},1024)])):C("",!0)],2))),128))])])]),e.noPaging?C("",!0):(s(),c("div",ae,[g(D,null,{default:k(()=>[g(x,null,{default:k(()=>[(s(!0),c(f,null,y(r.pagesList,l=>(s(),d(p,{key:l,active:l===i.currentPage,label:l+1,teeny:"",class:"p-0 text-sm",onClick:n=>i.currentPage=l},null,8,["active","label","onClick"]))),128))]),_:1}),u("small",null,"หน้า "+m(r.currentPageHuman)+" จาก "+m(r.numPages),1)]),_:1})]))]),_:1},8,["title","rounded","icon"])):e.loading?(s(),d(v,{key:1,title:e.title+" "+r.countChecked(),"header-icon":"",icon:e.icon,class:"shadow-lg dark:border-gray-800 border",loading:""},null,8,["title","icon"])):(s(),d(v,{key:2,title:e.title+" "+r.countChecked(),"header-icon":"",icon:e.icon,class:"shadow-lg dark:border-gray-800 border",empty:""},null,8,["title","icon"]))],64)}const ue=z(K,[["render",le]]);export{ue as T};
