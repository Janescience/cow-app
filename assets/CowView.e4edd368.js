import{a as X,R as Z,o as _,c as C,w as c,p as n,H as M,T as J,U as K,V as B,N as P,O as L,Q as d,s as k,b as l,i as N,l as I,_ as O,k as R,W as $,g as Y,h as ee,X as j,t as p,j as T,d as U,S as te,P as ae,Y as le,f as se,e as oe,Z as ne,F as A,G as F}from"./index.896e1630.js";import{_ as q}from"./BaseButtons.8814e734.js";import{_ as re}from"./CardBoxModal.eb7654e8.js";import{_ as H}from"./FormField.937d6bed.js";import{a as x}from"./auth-header.e6b84db4.js";const ie={class:"checkbox"},ce=n("span",{class:"check"},null,-1),de={__name:"TableCheckboxCell",props:{type:{type:String,default:"td"},isChecked:{type:Boolean,default:!1}},emits:["checked"],setup(t,{emit:e}){const i=t,h=X(i.isChecked);return Z(h,a=>{e("checked",a)}),(a,r)=>(_(),C(K(i.type),{class:"checkbox-cell"},{default:c(()=>[n("label",ie,[M(n("input",{"onUpdate:modelValue":r[0]||(r[0]=f=>h.value=f),type:"checkbox"},null,512),[[J,h.value]]),ce])]),_:1}))}};async function ue(t={}){let e="?";return t.farm&&(e=e+`farm=${t.farm}&`),t.flag&&(e=e+`flag=${t.flag}&`),t.code&&(e=e+`code=${t.code}&`),t.name&&(e=e+`name=${t.name}&`),t.status&&(e=e+`status=${t.status}&`),t.birthDate&&(e=e+`birthDate=${t.birthDate}&`),t.corral&&(e=e+`corral=${t.corral}&`),t?e.replace(/&*$/,""):""}class me{async all(e){const i=await ue(e);return B.get("/cow"+i,{headers:x()}).then(h=>h)}get(e){return B.get(`/cow/${e}`,{headers:x()})}create(e){return B.post("/cow",e,{headers:x()})}delete(e){return B.delete(`/cow/${e}`,{headers:x()})}update(e,i){return B.put(`/cow/${e}`,i,{headers:x()})}}var S=new me;const he={data(){return{datas:[]}},created(){this.initialData()},computed:{value:{get(){return this.modelValue},set(t){this.$emit("update:modelValue",t)}}},methods:{async initialData(){const t={farm:L().farm._id};try{const e=await S.all(t);if(this.datas=[],e&&(this.datas=e.data.cows,this.datas.map(i=>i.cow_data=i.code+" : "+i.name)),this.defaultValue){const i=this.datas.filter(h=>h[this.defaultType]==this.defaultValue);i&&this.handleInput(this.reduceAction(i[0]))}}catch(e){this.datas=[],console.error("Error: "+e.message)}},reduceAction(t){return this.valueType==="object"?t:t.code},handleInput(t){this.$emit("update:value",t),this.dataSelected=this.datas.find(e=>e.cde===t||e.name===t),this.$emit("update:dataSelected",this.dataSelected)}},props:{clear:{default:!0,type:Boolean},disabled:{default:!1,type:Boolean},dataSelected:{default:null,type:Object},defaultType:{default:"code",type:Object},defaultValue:{default:null,type:Object},modelValue:{type:[String,Number,Boolean,Array,Object],default:""}}},fe={class:"relative"},_e=N(" \u0E44\u0E21\u0E48\u0E1E\u0E1A\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25 ");function pe(t,e,i,h,a,r){const f=d("mdicon"),u=d("v-select");return _(),k("div",fe,[l(u,{class:"ddl",clearable:i.clear,disabled:i.disabled,options:a.datas,reduce:r.reduceAction,label:"cow_data",placeholder:"\u0E40\u0E25\u0E37\u0E2D\u0E01\u0E42\u0E04",onInput:r.handleInput,modelValue:r.value,"onUpdate:modelValue":e[0]||(e[0]=b=>r.value=b),dataSelected:i.dataSelected},{"no-options":c(()=>[l(f,{name:"alertCircleOutline",width:"16",height:"16",class:"inline-block"}),_e]),_:1},8,["clearable","disabled","options","reduce","onInput","modelValue","dataSelected"])])}var ge=P(he,[["render",pe]]);const be={data(){return{cow:{code:"",name:"",status:"1",birthDate:new Date,corral:"",dad:"",mom:"",farm:L().farm._id},status:[{id:1,label:"\u0E17\u0E49\u0E2D\u0E07"},{id:2,label:"\u0E19\u0E21\u0E41\u0E2B\u0E49\u0E07"},{id:3,label:"\u0E43\u0E2B\u0E49\u0E1C\u0E25\u0E1C\u0E25\u0E34\u0E15"},{id:4,label:"\u0E27\u0E31\u0E27\u0E40\u0E14\u0E47\u0E01"}],loading:!1,alert:""}},emits:["update:modelValue","cancel","confirm"],computed:{value:{get(){return this.modelValue},set(t){this.$emit("update:modelValue",t)}}},methods:{confirmCancel(t){this.value=!1,this.$emit(t)},confirm(){this.confirmCancel("confirm")},cancel(){this.confirmCancel("cancel")},async create(){this.loading=!0,this.alert="";try{await S.create(this.cow)&&(this.loading=!1,this.value=!1,this.confirmCancel("confirm"))}catch(t){this.loading=!1,this.alert=t.response.data.message}}},components:{BaseButton:I,BaseButtons:q,CardBox:O,BaseDivider:R,OverlayLayer:$,FormField:H,FormControl:Y,NotificationBar:ee},props:{modelValue:{type:[String,Number,Boolean],default:null}}},ye={class:"grid lg:grid-cols-4 grid-cols-2 gap-5"};function we(t,e,i,h,a,r){const f=d("FormControl"),u=d("FormField"),b=d("NotificationBar"),v=d("BaseDivider"),g=d("BaseButton"),y=d("BaseButtons"),s=d("CardBox"),w=d("OverlayLayer");return M((_(),C(w,null,{default:c(()=>[M(l(s,{title:"\u0E40\u0E1E\u0E34\u0E48\u0E21\u0E42\u0E04",class:"shadow-lg w-full overflow-y-auto md:w-3/5 lg:w-1/1 z-50","header-icon":"close",modal:"",form:"",onSubmit:U(r.create,["prevent"]),onHeaderIconClick:r.cancel},{default:c(()=>[n("div",ye,[l(u,{label:"\u0E23\u0E2B\u0E31\u0E2A\u0E42\u0E04",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:c(()=>[l(f,{modelValue:a.cow.code,"onUpdate:modelValue":e[0]||(e[0]=m=>a.cow.code=m),icon:"barcode",required:""},null,8,["modelValue"])]),_:1}),l(u,{label:"\u0E0A\u0E37\u0E48\u0E2D\u0E42\u0E04",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:c(()=>[l(f,{modelValue:a.cow.name,"onUpdate:modelValue":e[1]||(e[1]=m=>a.cow.name=m),icon:"cow",required:""},null,8,["modelValue"])]),_:1}),l(u,{label:"\u0E27\u0E31\u0E19\u0E40\u0E01\u0E34\u0E14",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:c(()=>[l(f,{modelValue:a.cow.birthDate,"onUpdate:modelValue":e[2]||(e[2]=m=>a.cow.birthDate=m),icon:"calendar",type:"date",required:""},null,8,["modelValue"])]),_:1}),l(u,{label:"\u0E2A\u0E16\u0E32\u0E19\u0E30",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:c(()=>[l(f,{modelValue:a.cow.status,"onUpdate:modelValue":e[3]||(e[3]=m=>a.cow.status=m),options:a.status,icon:"",required:""},null,8,["modelValue","options"])]),_:1}),l(u,{label:"\u0E04\u0E2D\u0E01"},{default:c(()=>[l(f,{modelValue:a.cow.corral,"onUpdate:modelValue":e[4]||(e[4]=m=>a.cow.corral=m),icon:"barn"},null,8,["modelValue"])]),_:1}),l(u,{label:"\u0E1E\u0E48\u0E2D\u0E1E\u0E31\u0E19\u0E18\u0E38\u0E4C"},{default:c(()=>[l(f,{modelValue:a.cow.dad,"onUpdate:modelValue":e[5]||(e[5]=m=>a.cow.dad=m),icon:"genderMale"},null,8,["modelValue"])]),_:1}),l(u,{label:"\u0E41\u0E21\u0E48\u0E1E\u0E31\u0E19\u0E18\u0E38\u0E4C"},{default:c(()=>[l(f,{modelValue:a.cow.mom,"onUpdate:modelValue":e[6]||(e[6]=m=>a.cow.mom=m),icon:"genderFemale"},null,8,["modelValue"])]),_:1})]),a.alert?(_(),C(b,{key:0,color:"danger",outline:"",icon:"alertCircleOutline"},{default:c(()=>[N(p(a.alert),1)]),_:1})):T("",!0),l(v),l(y,{type:"justify-center"},{default:c(()=>[l(g,{label:"\u0E1A\u0E31\u0E19\u0E17\u0E36\u0E01",color:"success",type:"submit",loading:a.loading},null,8,["loading"]),l(g,{label:"\u0E22\u0E01\u0E40\u0E25\u0E34\u0E01",color:"danger",onClick:r.cancel},null,8,["onClick"])]),_:1})]),_:1},8,["onSubmit","onHeaderIconClick"]),[[j,r.value]])]),_:1},512)),[[j,r.value]])}var Ce=P(be,[["render",we]]),ve=e=>{var e=new Date(e),i=e.getYear(),h=e.getMonth(),a=e.getDate(),r=new Date,f=r.getYear(),u=r.getMonth(),b=r.getDate(),s={},w="",v=f-i;if(u>=h)var g=u-h;else{v--;var g=12+u-h}if(b>=a)var y=b-a;else{g--;var y=31+b-a;g<0&&(g=11,v--)}var s={years:v,months:g,days:y},w="";return s.years>0&&s.months>0&&s.days>0?w=s.years+" \u0E1B\u0E35 "+s.months+" \u0E40\u0E14\u0E37\u0E2D\u0E19 "+s.days+" \u0E27\u0E31\u0E19":s.years==0&&s.months==0&&s.days>0?w=s.days+" \u0E27\u0E31\u0E19":s.years>0&&s.months==0&&s.days==0?ageageString=s.years+" \u0E1B\u0E35 (\u0E27\u0E31\u0E19\u0E40\u0E01\u0E34\u0E14)":s.years>0&&s.months>0&&s.days==0?ageageString=s.years+" \u0E1B\u0E35 "+s.months+" \u0E40\u0E14\u0E37\u0E2D\u0E19":s.years==0&&s.months>0&&s.days>0?ageageString=s.months+" \u0E40\u0E14\u0E37\u0E2D\u0E19 "+s.days+" \u0E27\u0E31\u0E19":s.years>0&&s.months==0&&s.days>0?ageageString=s.years+" \u0E1B\u0E35 "+s.days+" \u0E27\u0E31\u0E19":s.years==0&&s.months>0&&s.days==0&&(ageageString=s.months+" \u0E40\u0E14\u0E37\u0E2D\u0E19"),w};const ke={data(){return{modalCreate:!1,status:[{id:"",label:"\u0E17\u0E31\u0E49\u0E07\u0E2B\u0E21\u0E14"},{id:1,label:"\u0E17\u0E49\u0E2D\u0E07"},{id:2,label:"\u0E19\u0E21\u0E41\u0E2B\u0E49\u0E07"},{id:3,label:"\u0E43\u0E2B\u0E49\u0E1C\u0E25\u0E1C\u0E25\u0E34\u0E15"},{id:4,label:"\u0E27\u0E31\u0E27\u0E40\u0E14\u0E47\u0E01"}],textConfirm:"",modalConfirm:!1,funcConfirm:Function,idConfirm:null,perPage:10,currentPage:0,checkedRows:[],items:[],search:{code:null,status:"",birthDate:null,corral:"",flag:"Y",farm:L().farm._id},loading:!1}},components:{SectionMain:te,LayoutAuthenticated:ae,BaseButton:I,BaseIcon:le,BaseButtons:q,CardBox:O,UserAvatar:se,TableCheckboxCell:de,CardBoxModal:re,BaseLevel:oe,FormControl:Y,FormField:H,BaseDivider:R,DDLCow:ge,CreateCowModal:Ce},created(){this.getCows()},computed:{itemsPaginated(){return this.items?this.items.slice(this.perPage*this.currentPage,this.perPage*(this.currentPage+1)):[]},numPages(){return Math.ceil((this.items?this.items.length:0)/this.perPage)},currentPageHuman(){return this.currentPage+1},pagesList(){const t=[];for(let e=0;e<this.numPages;e++)t.push(e);return t}},methods:{async getCows(){this.loading=!0;const t=await S.all(this.search);this.items=[],t.data&&(this.items=t.data.cows),this.loading=!1},async removeCow(){this.loading=!0,(await S.update(this.idConfirm,{flag:"N"})).data&&this.getCows(),this.loading=!1},reset(){this.search.code=null,this.search.status="",this.search.birthDate=null,this.search.corral=""},checked(t,e){t?(e.checked=!0,this.checkedRows.push(e)):(e.checked=!1,this.checkedRows=this.removeArr(this.checkedRows,i=>i._id===e._id))},removeArr(t,e){const i=[];return t.forEach(h=>{e(h)||i.push(h)}),i},confirm(t,e,i){this.textConfirm=t,this.funcConfirm=i,this.idConfirm=e,this.modalConfirm=!0},countChecked(){return this.checkedRows.length>0?"(\u0E40\u0E25\u0E37\u0E2D\u0E01 "+this.checkedRows.length+" \u0E23\u0E32\u0E22\u0E01\u0E32\u0E23)":""},calAge(t){return ve(t)},formatDate(t){return t?ne(new Date(t)).format("DD/MM/YYYY"):""}}},Ve={class:"px-6 sm:px-0 mb-6 flex items-center justify-between"},Be={class:"flex items-center justify-start"},xe=n("h1",{class:"text-2xl"}," \u0E42\u0E04 ",-1),De={class:"grid lg:grid-cols-4 md:grid-cols-3 grid-cols-2 gap-5"},Se={key:0,class:"p-3 bg-gray-100/50 dark:bg-gray-800"},Ae={class:"overflow-x-auto"},Fe=n("thead",null,[n("tr",null,[n("th",{class:"text-center whitespace-nowrap"},"\u0E40\u0E25\u0E37\u0E2D\u0E01"),n("th",{class:"text-center whitespace-nowrap"},"\u0E23\u0E39\u0E1B\u0E20\u0E32\u0E1E"),n("th",{class:"text-center whitespace-nowrap"},"\u0E23\u0E2B\u0E31\u0E2A\u0E42\u0E04"),n("th",{class:"text-center whitespace-nowrap"},"\u0E0A\u0E37\u0E48\u0E2D\u0E42\u0E04 "),n("th",{class:"text-center whitespace-nowrap"},"\u0E27\u0E31\u0E19\u0E40\u0E01\u0E34\u0E14"),n("th",{class:"text-center"},"\u0E2D\u0E32\u0E22\u0E38 "),n("th",{class:"text-center"},"\u0E2A\u0E16\u0E32\u0E19\u0E30 "),n("th",{class:"text-center"},"\u0E04\u0E2D\u0E01 "),n("th",{class:"text-center whitespace-nowrap"},"\u0E1E\u0E48\u0E2D\u0E1E\u0E31\u0E19\u0E18\u0E38\u0E4C "),n("th",{class:"text-center whitespace-nowrap"},"\u0E41\u0E21\u0E48\u0E1E\u0E31\u0E19\u0E18\u0E38\u0E4C "),n("th")])],-1),Me={class:"border-b-0 lg:w-6 before:hidden"},Ue={"data-label":"\u0E23\u0E2B\u0E31\u0E2A\u0E42\u0E04",class:"whitespace-nowrap"},Pe={"data-label":"\u0E0A\u0E37\u0E48\u0E2D\u0E42\u0E04",class:"whitespace-nowrap"},Le={"data-label":"\u0E27\u0E31\u0E19\u0E40\u0E01\u0E34\u0E14",class:"text-center"},je={"data-label":"\u0E2D\u0E32\u0E22\u0E38",class:"whitespace-nowrap"},Ne={"data-label":"\u0E2A\u0E16\u0E32\u0E19\u0E30",class:"whitespace-nowrap"},Ie={"data-label":"\u0E04\u0E2D\u0E01"},Oe={"data-label":"\u0E1E\u0E48\u0E2D\u0E1E\u0E31\u0E19\u0E18\u0E38\u0E4C",class:"whitespace-nowrap"},Re={"data-label":"\u0E41\u0E21\u0E48\u0E1E\u0E31\u0E19\u0E18\u0E38\u0E4C",class:"whitespace-nowrap"},Ye={class:"lg:w-6 whitespace-nowrap"},Te={class:"p-3 lg:px-6 border-t border-gray-100 dark:border-gray-800"};function qe(t,e,i,h,a,r){const f=d("BaseIcon"),u=d("BaseButton"),b=d("CreateCowModal"),v=d("CardBoxModal"),g=d("DDLCow"),y=d("FormField"),s=d("FormControl"),w=d("BaseDivider"),m=d("BaseButtons"),D=d("CardBox"),E=d("TableCheckboxCell"),z=d("UserAvatar"),Q=d("BaseLevel"),G=d("SectionMain"),W=d("LayoutAuthenticated");return _(),C(W,null,{default:c(()=>[l(G,null,{default:c(()=>[n("section",Ve,[n("div",Be,[l(f,{path:"cow",size:"30",class:"mr-3"}),xe]),l(u,{label:"\u0E40\u0E1E\u0E34\u0E48\u0E21\u0E42\u0E04",color:"success",onClick:e[0]||(e[0]=o=>a.modalCreate=!0)})]),l(b,{modelValue:a.modalCreate,"onUpdate:modelValue":e[1]||(e[1]=o=>a.modalCreate=o),onConfirm:r.getCows},null,8,["modelValue","onConfirm"]),l(v,{modelValue:a.modalConfirm,"onUpdate:modelValue":e[2]||(e[2]=o=>a.modalConfirm=o),title:"\u0E22\u0E37\u0E19\u0E22\u0E31\u0E19\u0E2D\u0E35\u0E01\u0E04\u0E23\u0E31\u0E49\u0E07","button-label":"\u0E22\u0E37\u0E19\u0E22\u0E31\u0E19",onConfirm:a.funcConfirm,"has-cancel":"","has-button":""},{default:c(()=>[n("p",null,p(a.textConfirm),1)]),_:1},8,["modelValue","onConfirm"]),l(D,{title:"\u0E04\u0E49\u0E19\u0E2B\u0E32\u0E42\u0E04",icon:"",form:"",class:"mb-3","header-icon":"",onSubmit:U(r.getCows,["prevent"]),onReset:U(r.reset,["prevent"])},{default:c(()=>[n("div",De,[l(y,{label:"\u0E42\u0E04"},{default:c(()=>[l(g,{modelValue:a.search.code,"onUpdate:modelValue":e[3]||(e[3]=o=>a.search.code=o)},null,8,["modelValue"])]),_:1}),l(y,{label:"\u0E27\u0E31\u0E19\u0E40\u0E01\u0E34\u0E14"},{default:c(()=>[l(s,{modelValue:a.search.birthDate,"onUpdate:modelValue":e[4]||(e[4]=o=>a.search.birthDate=o),icon:"calendar",type:"date"},null,8,["modelValue"])]),_:1}),l(y,{label:"\u0E2A\u0E16\u0E32\u0E19\u0E30"},{default:c(()=>[l(s,{modelValue:a.search.status,"onUpdate:modelValue":e[5]||(e[5]=o=>a.search.status=o),options:a.status},null,8,["modelValue","options"])]),_:1}),l(y,{label:"\u0E04\u0E2D\u0E01"},{default:c(()=>[l(s,{modelValue:a.search.corral,"onUpdate:modelValue":e[6]||(e[6]=o=>a.search.corral=o),icon:"barn"},null,8,["modelValue"])]),_:1})]),l(w),l(m,{type:"justify-center","no-wrap":""},{default:c(()=>[l(u,{type:"submit",color:"info",label:"\u0E04\u0E49\u0E19\u0E2B\u0E32"}),l(u,{type:"reset",color:"danger",label:"\u0E25\u0E49\u0E32\u0E07"})]),_:1})]),_:1},8,["onSubmit","onReset"]),r.itemsPaginated.length>0?(_(),C(D,{key:0,title:"\u0E23\u0E32\u0E22\u0E01\u0E32\u0E23\u0E42\u0E04 "+r.countChecked(),class:"shadow-lg","has-table":"","header-icon":""},{default:c(()=>[a.checkedRows.length>0?(_(),k("div",Se,[(_(!0),k(A,null,F(a.checkedRows,o=>(_(),k("span",{key:o._id,class:"inline-block px-2 py-1 rounded-sm mr-2 text-sm bg-gray-100 dark:bg-gray-700 mb-1"},p(o.name),1))),128)),l(m,{type:"justify-start lg:justify-end","no-wrap":""},{default:c(()=>[l(u,{color:"danger",label:"\u0E25\u0E1A\u0E17\u0E31\u0E49\u0E07\u0E2B\u0E21\u0E14",onClick:e[7]||(e[7]=o=>t.isModalActive=!0)})]),_:1})])):T("",!0),n("div",Ae,[n("table",null,[Fe,n("tbody",null,[(_(!0),k(A,null,F(r.itemsPaginated,o=>(_(),k("tr",{key:o._id},[l(E,{isChecked:o.checked,class:"text-center border-b-0 lg:w-6 before:hidden",onChecked:V=>r.checked(V,o)},null,8,["isChecked","onChecked"]),n("td",Me,[l(z,{username:o._id,class:"w-24 h-24 mx-auto lg:w-12 lg:h-12"},null,8,["username"])]),n("td",Ue,[n("span",null,p(o.code),1)]),n("td",Pe,p(o.name),1),n("td",Le,p(r.formatDate(o.birthDate)),1),n("td",je,p(r.calAge(o.birthDate)),1),n("td",Ne,p(a.status[o.status].label),1),n("td",Ie,p(o.corral),1),n("td",Oe,p(o.dad),1),n("td",Re,p(o.mom),1),n("td",Ye,[l(m,{type:"justify-end lg:justify-start","no-wrap":""},{default:c(()=>[l(u,{color:"danger",label:"\u0E25\u0E1A",onClick:V=>r.confirm("\u0E22\u0E37\u0E19\u0E22\u0E31\u0E19\u0E25\u0E1A\u0E42\u0E04 "+o.name+" \u0E43\u0E0A\u0E48\u0E2B\u0E23\u0E37\u0E2D\u0E44\u0E21\u0E48 ?",o._id,r.removeCow)},null,8,["onClick"]),l(u,{color:"warning",label:"\u0E41\u0E01\u0E49\u0E44\u0E02",onClick:V=>t.edit(o)},null,8,["onClick"]),l(u,{color:"info",label:"\u0E23\u0E32\u0E22\u0E25\u0E30\u0E40\u0E2D\u0E35\u0E22\u0E14",onClick:V=>t.detail(o._id)},null,8,["onClick"])]),_:2},1024)])]))),128))])])]),n("div",Te,[l(Q,null,{default:c(()=>[l(m,null,{default:c(()=>[(_(!0),k(A,null,F(r.pagesList,o=>(_(),C(u,{key:o,active:o===a.currentPage,label:o+1,small:"",onClick:V=>a.currentPage=o},null,8,["active","label","onClick"]))),128))]),_:1}),n("small",null,"\u0E2B\u0E19\u0E49\u0E32 "+p(r.currentPageHuman)+" \u0E08\u0E32\u0E01 "+p(r.numPages),1)]),_:1})])]),_:1},8,["title"])):a.loading?(_(),C(D,{key:1,loading:""})):(_(),C(D,{key:2,empty:""}))]),_:1})]),_:1})}var We=P(ke,[["render",qe]]);export{We as default};
