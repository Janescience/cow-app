import{_ as le}from"./LayoutAuthenticated-17d23cff.js";import{b as Y,_ as J,a as K,c as oe,d as ae}from"./BaseDivider-651bf36c.js";import{v as Q,h as W,_ as X,z as i,G as E,H,o as m,c as h,w as r,d as o,f as q,j as c,t as p,g as B,e as se,s as w,F as z,D as R,n as U}from"./index-7b26548e.js";import{_ as Z}from"./UserAvatar-56f44fe3.js";import{_ as $}from"./FormField-05841f90.js";import{_ as ee}from"./FormControl-ff33c853.js";import{T as re}from"./Table-aee9812e.js";import{C as ne}from"./Criteria-7c8a9a00.js";import{_ as ie}from"./SectionTitleBarSub-3fac5b83.js";import{a as ce}from"./CardBoxModal-2cd8a859.js";import{_ as de}from"./NotificationBar-02507950.js";import{I as ue}from"./ImageUpload-17449427.js";import{C}from"./cow-811c6f18.js";import{s as D,q as me,a as te}from"./cow-539f0ad0.js";import{T as G}from"./alert-35d3e771.js";import{g as ge}from"./age-calculate-3b5fe841.js";import"./CardBoxCollapse-1ffcc796.js";import"./FormCheckRadioPicker-dded445b.js";import"./Cow-1ccd6cd5.js";import"./Recipe-6ae0ca8b.js";import"./Vaccine-adab6678.js";import"./Corral-5e377561.js";const fe={data(){return{cow:{image:null,file:null,code:"",name:"",status:1,birthDate:null,adopDate:null,corral:"",dad:"",mom:"",quality:1,weight:null,sex:"F"},status:D("create"),quality:me("create"),sex:te("create"),loading:!1,alert:""}},emits:["update:modelValue","cancel","confirm"],computed:{value:{get(){return this.modelValue},set(l){this.$emit("update:modelValue",l)}},user(){return this.$store.state.auth.user}},watch:{dataEdit:{handler(l,e){l!=null&&this.mode=="edit"&&(this.cow=l,this.cow.image=this.cow.image?this.cow.image:"/image/img-mockup.png")},deep:!0}},methods:{clear(){console.log("clear"),this.$emit("update:dataEdit",null),this.cow.image=null,this.cow.file=null,this.cow.code="",this.cow.name="",this.cow.birthDate="",this.cow.adopDate="",this.cow.status=1,this.cow.corral="",this.cow.dad="",this.cow.mom="",this.cow.weight=null,this.cow.sex="F",delete this.cow._id},confirmCancel(l){this.value=!1,this.$emit(l)},confirm(){this.clear(),this.confirmCancel("confirm")},cancel(){this.clear(),this.confirmCancel("cancel")},async submit(){this.loading=!0,this.alert="";try{const l=await C.create(this.cow);if(l){const e=l.data.newCow;e.file=this.cow.file,await C.upload(e),this.loading=!1,this.value=!1,this.confirm(),G.fire({icon:"success",title:"บันทึกข้อมูลสำเร็จ"})}}catch(l){console.error("Error : ",l),this.loading=!1,this.alert=l.response.data.message,G.fire({icon:"error",title:"บันทึกข้อมูลไม่สำเร็จ"})}},getFile(l){this.cow.file=l}},components:{BaseButton:Y,BaseButtons:W,CardBox:J,BaseDivider:K,OverlayLayer:ce,FormField:$,FormControl:ee,NotificationBar:de,UserAvatar:Z,BaseLevel:X,ImageUpload:ue},props:{modelValue:{type:[String,Number,Boolean],default:null},mode:{type:String,default:""},dataEdit:{type:Object,default:null}}},pe={class:"grid lg:grid-cols-4 grid-cols-2 gap-5 mt-3"};function he(l,e,g,f,t,n){const v=i("ImageUpload"),V=i("BaseLevel"),d=i("FormControl"),u=i("FormField"),y=i("NotificationBar"),_=i("BaseDivider"),b=i("BaseButton"),k=i("BaseButtons"),F=i("CardBox"),S=i("OverlayLayer");return E((m(),h(S,null,{default:r(()=>[E(o(F,{title:g.mode==="create"?"เพิ่มโค":"แก้ไขโค",class:"shadow-lg w-full md:w-3/5 lg:w-1/1 z-50","header-icon":"close",modal:"",form:"",onSubmit:se(n.submit,["prevent"]),onHeaderIconClick:n.cancel},{default:r(()=>[o(v,{modelValue:t.cow.image,"onUpdate:modelValue":e[0]||(e[0]=a=>t.cow.image=a),onFile:n.getFile},null,8,["modelValue","onFile"]),o(V,{type:"justify-center mb-6 text-sm"},{default:r(()=>[q(" อัพโหลดรูปภาพ (คลิกที่รูป) ")]),_:1}),c("div",pe,[o(u,{label:"รหัสโค",help:"* ห้ามว่าง"},{default:r(()=>[o(d,{modelValue:t.cow.code,"onUpdate:modelValue":e[1]||(e[1]=a=>t.cow.code=a),icon:"barcode",required:""},null,8,["modelValue"])]),_:1}),o(u,{label:"ชื่อโค",help:"* ห้ามว่าง"},{default:r(()=>[o(d,{modelValue:t.cow.name,"onUpdate:modelValue":e[2]||(e[2]=a=>t.cow.name=a),icon:"cow",required:""},null,8,["modelValue"])]),_:1}),o(u,{label:"เพศ",help:"* ห้ามว่าง"},{default:r(()=>[o(d,{modelValue:t.cow.sex,"onUpdate:modelValue":e[3]||(e[3]=a=>t.cow.sex=a),options:t.sex,required:""},null,8,["modelValue","options"])]),_:1}),o(u,{label:"น้ำหนัก(กก.)"},{default:r(()=>[o(d,{modelValue:t.cow.weight,"onUpdate:modelValue":e[4]||(e[4]=a=>t.cow.weight=a),icon:"scale",type:"number"},null,8,["modelValue"])]),_:1}),o(u,{label:"วันเกิด",help:"* ห้ามว่าง"},{default:r(()=>[o(d,{modelValue:t.cow.birthDate,"onUpdate:modelValue":e[5]||(e[5]=a=>t.cow.birthDate=a),icon:"calendar",type:"date",required:""},null,8,["modelValue"])]),_:1}),o(u,{label:"วันที่นำเข้าฟาร์ม",help:"* ห้ามว่าง"},{default:r(()=>[o(d,{modelValue:t.cow.adopDate,"onUpdate:modelValue":e[6]||(e[6]=a=>t.cow.adopDate=a),icon:"calendar",type:"date",required:""},null,8,["modelValue"])]),_:1}),o(u,{label:"สถานะ",help:"* ห้ามว่าง"},{default:r(()=>[o(d,{modelValue:t.cow.status,"onUpdate:modelValue":e[7]||(e[7]=a=>t.cow.status=a),options:t.status,icon:"",required:""},null,8,["modelValue","options"])]),_:1}),o(u,{label:"คุณภาพน้ำนม",help:"* ห้ามว่าง"},{default:r(()=>[o(d,{modelValue:t.cow.quality,"onUpdate:modelValue":e[8]||(e[8]=a=>t.cow.quality=a),options:t.quality,icon:""},null,8,["modelValue","options"])]),_:1}),o(u,{label:"คอก"},{default:r(()=>[o(d,{modelValue:t.cow.corral,"onUpdate:modelValue":e[9]||(e[9]=a=>t.cow.corral=a),icon:"barn"},null,8,["modelValue"])]),_:1}),o(u,{label:"พ่อพันธุ์"},{default:r(()=>[o(d,{modelValue:t.cow.dad,"onUpdate:modelValue":e[10]||(e[10]=a=>t.cow.dad=a),icon:"genderMale"},null,8,["modelValue"])]),_:1}),o(u,{label:"แม่พันธุ์"},{default:r(()=>[o(d,{modelValue:t.cow.mom,"onUpdate:modelValue":e[11]||(e[11]=a=>t.cow.mom=a),icon:"genderFemale"},null,8,["modelValue"])]),_:1})]),t.alert?(m(),h(y,{key:0,color:"danger",outline:"",icon:"alertCircleOutline"},{default:r(()=>[q(p(t.alert),1)]),_:1})):B("",!0),o(_),o(k,{type:"justify-center"},{default:r(()=>[o(b,{label:"บันทึก",color:"success",type:"submit",loading:t.loading},null,8,["loading"]),o(b,{label:"ยกเลิก",color:"danger",onClick:n.cancel},null,8,["onClick"])]),_:1})]),_:1},8,["title","onSubmit","onHeaderIconClick"]),[[H,n.value]])]),_:1},512)),[[H,n.value]])}const _e=Q(fe,[["render",he]]),we={data(){return{perPage:18,currentPage:0,modalCow:!1,cowStatus:D(),items:[],forms:[{label:"โค",value:"code",type:"ddl",module:"cow",valueType:"code"},{label:"เพศ",value:"sex",options:te()},{label:"สถานะ",value:"status",options:D()},{label:"คอก",value:"corral",type:"ddl",module:"corral",valueType:"id"}],search:{code:null,status:"",quality:"",corral:null,sex:"",flag:"Y"},mode:"create",loading:!1}},computed:{itemsPaginated(){return this.items?this.items.slice(this.perPage*this.currentPage,this.perPage*(this.currentPage+1)):[]},numPages(){return Math.ceil((this.items?this.items.length:0)/this.perPage)},currentPageHuman(){return this.currentPage+1},pagesList(){const l=[];for(let e=0;e<this.numPages;e++)l.push(e);return l},user(){return this.$store.state.auth.user}},components:{SectionMain:oe,LayoutAuthenticated:le,BaseButton:Y,BaseIcon:ae,BaseButtons:W,CardBox:J,FormControl:ee,FormField:$,BaseDivider:K,CreateCowModal:_e,Table:re,SectionTitleBarSub:ie,Criteria:ne,UserAvatar:Z,BaseLevel:X},created(){this.getCows()},methods:{async getCows(){this.loading=!0;const l=await C.all(this.search);this.items=[],l.data&&(this.items=l.data.cows,this.loading=!1)},async removeCow(l){this.loading=!0,(await C.update(l,{flag:"N"})).data&&this.getCows(),this.loading=!1},detail(l){this.$router.push({name:"cowDetail",params:{id:l._id}})},reset(){this.search.code=null,this.search.status="",this.search.quality="",this.search.sex="",this.search.corral=""},filter(l){const e={},g={},f={},t={};return l.sex=="F"?(t.icon="genderFemale",t.style="text-rose-500 bg-red-300 rounded-full  p-1 mr-1"):l.sex=="M"&&(t.icon="genderMale",t.style="text-blue-500 bg-indigo-300 rounded-full p-1 mr-1"),l.status==1?(e.icon="humanPregnant",e.style="text-blue-500 bg-indigo-900 rounded-full  p-1 mr-1"):l.status==2?(e.icon="waterOff",e.style="text-rose-500 bg-red-900 rounded-full p-1 mr-1"):l.status==3?(e.icon="water",e.style="text-white bg-teal-700 rounded-full p-1 mr-1"):l.status==4&&(e.icon="babyFaceOutline",e.style="text-yellow-400 bg-amber-900 rounded-full mr-1"),e.desc=this.cowStatus[l.status].label,l.grade==="A+"?g.style="text-lime-500":l.grade==="A"?g.style="text-green-500":l.grade==="B"?g.style="text-white":l.grade==="C"?g.style="text-orange-500":l.grade==="D"&&(g.style="text-red-500"),l.quality==1?(f.icon="medalOutline",f.style="text-green-600  bg-gray-800 rounded-full"):l.quality==3?(f.icon="medalOutline",f.style="text-red-600 bg-gray-800 rounded-full"):l.quality==2&&(f.icon="medalOutline",f.style="text-gray-400 bg-gray-800 rounded-full"),{status:e,grade:g,quality:f,sex:t}},calAge(l){return ge(l).ageString}}},ye={key:0,class:"grid lg:gap-3 md:gap-2 gap-1 grid-cols-3 lg:grid-cols-6 md:grid-cols-4"},be={class:"flex justify-between md:text-sm text-xs p-2"},xe={class:""},Be=c("hr",{class:"border-1 dark:border-gray-800 border-gray-300"},null,-1),Ce={class:"text-center mt-2"},ve=c("hr",{class:"border-1 dark:border-gray-800 border-gray-300"},null,-1),Ve={class:"lg:text-lg text-xs flex justify-center"},ke={class:"dark:text-gray-400 text-gray-500 mr-1"},Fe=c("hr",{class:"border-1 dark:border-gray-800 border-gray-300"},null,-1),Se={class:"justify-center flex lg:p-2 p-1"},Ue={key:1,class:"text-center py-10 text-gray-500 dark:text-gray-400"},qe=c("p",null," กำลังโหลดข้อมูล...",-1),De={class:"p-3 mt-2 border-t border-gray-100 dark:border-gray-800 dark:bg-gray-900 lg:rounded-lg shadow-lg"};function Pe(l,e,g,f,t,n){const v=i("SectionTitleBarSub"),V=i("CreateCowModal"),d=i("Criteria"),u=i("UserAvatar"),y=i("BaseLevel"),_=i("BaseIcon"),b=i("CardBox"),k=i("BaseButton"),F=i("BaseButtons"),S=i("SectionMain"),a=i("LayoutAuthenticated");return m(),h(a,null,{default:r(()=>[o(S,null,{default:r(()=>[o(v,{icon:"cow",title:"โค",btnText:"เพิ่มโค","has-btn-add":"",onOpenModal:e[0]||(e[0]=s=>{t.mode="create",t.modalCow=!0})}),o(V,{modelValue:t.modalCow,"onUpdate:modelValue":e[1]||(e[1]=s=>t.modalCow=s),onConfirm:n.getCows,mode:t.mode,dataEdit:l.dataEdit},null,8,["modelValue","onConfirm","mode","dataEdit"]),o(d,{grid:"grid-cols-2 md:grid-cols-3 lg:grid-cols-5",onSearch:n.getCows,onReset:n.reset,forms:t.forms,search:t.search},null,8,["onSearch","onReset","forms","search"]),t.loading?(m(),w("div",Ue,[o(_,{path:"dotsCircle",size:"22",class:"animate-spin"}),qe])):(m(),w("div",ye,[(m(!0),w(z,null,R(n.itemsPaginated,s=>(m(),h(b,{key:s.name,onClick:x=>n.detail(s),class:"bg-gray-100","has-table":"",hoverable:""},{default:r(()=>{var x,P,L,M,A,O,T,j,I,N;return[c("div",be,[c("div",null,"คอก "+p(s.corral||"-"),1),c("p",xe,p(n.calAge(s.birthDate)),1)]),Be,o(y,{type:"justify-center"},{default:r(()=>[o(u,{username:"profile-card",class:"lg:w-20 lg:h-20 w-16 h-16 mt-2",avatar:s.image},null,8,["avatar"])]),_:2},1024),c("div",Ce,[ve,c("h4",Ve,[c("p",ke,p(s.code),1),q(" - "+p(s.name),1)]),Fe,c("div",Se,[s.sex?(m(),h(_,{key:0,class:U((P=(x=n.filter(s))==null?void 0:x.sex)==null?void 0:P.style),path:(M=(L=n.filter(s))==null?void 0:L.sex)==null?void 0:M.icon,w:"w-4 lg:w-6",h:"h-4 lg:h-6"},null,8,["class","path"])):B("",!0),s.grade?(m(),w("p",{key:1,class:U(((O=(A=n.filter(s))==null?void 0:A.grade)==null?void 0:O.style)+" flex items-center justify-center font-extrabold  lg:text-base text-sm text-center bg-gray-800 rounded-full lg:h-6 lg:w-6 w-4 h-4 shadow-xl mr-1")},[c("div",null,p(s.grade),1)],2)):B("",!0),s.status?(m(),h(_,{key:2,class:U((j=(T=n.filter(s))==null?void 0:T.status)==null?void 0:j.style),path:(N=(I=n.filter(s))==null?void 0:I.status)==null?void 0:N.icon,w:"w-4 lg:w-6",h:"h-4 lg:h-6"},null,8,["class","path"])):B("",!0)])])]}),_:2},1032,["onClick"]))),128))])),c("div",De,[o(y,null,{default:r(()=>[o(F,null,{default:r(()=>[(m(!0),w(z,null,R(n.pagesList,s=>(m(),h(k,{key:s,active:s===t.currentPage,label:s+1,teeny:"",onClick:x=>t.currentPage=s},null,8,["active","label","onClick"]))),128))]),_:1}),c("small",null,"หน้า "+p(n.currentPageHuman)+" จาก "+p(n.numPages),1)]),_:1})])]),_:1})]),_:1})}const tt=Q(we,[["render",Pe]]);export{tt as default};
