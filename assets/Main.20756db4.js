import{N as B,l as x,_ as T,k as N,R as E,g as R,h as F,e as L,Q as o,H as v,T as y,o as k,c as w,w as r,b as l,p as U,i as O,t as A,j as q,d as H,a0 as m,Z as c,O as j,S as I,P as z,V as P}from"./index.f7691b8e.js";import{D as Z,T as G,a as J}from"./Criteria.3da13a2c.js";import{_ as K}from"./BaseButtons.c3d0341f.js";import{_ as W}from"./FormField.e8483ac0.js";import{M}from"./milking.c689e9d4.js";import{a as f}from"./auth-header.df4f3205.js";import"./CardBoxModal.d154ab7a.js";const X={data(){return{milk:{cow:null,date:new Date,morningQty:0,afternoonQty:0,amount:0},loading:!1,alert:""}},emits:["update:modelValue","cancel","confirm"],computed:{sumQty(){return this.milk.morningQty+this.milk.afternoonQty},calAmount(){return this.milk.amount=(this.milk.morningQty+this.milk.afternoonQty)*100,this.milk.amount},value:{get(){return this.modelValue},set(t){this.$emit("update:modelValue",t)}}},watch:{dataEdit:{handler(t,e){t!=null&&this.mode=="edit"&&(this.milk=t,this.milk.date=new Date(t.date))},deep:!0}},methods:{clear(){var t;this.mode==="edit"&&this.$emit("update:dataEdit",null),this.milk.cow=null,this.milk.date=new Date,this.milk.morningQty=0,this.milk.afternoonQty=0,this.milk.amount=0,(t=this.milk)==null||delete t._id},confirmCancel(t){this.value=!1,this.$emit(t)},confirm(){this.clear(),this.confirmCancel("confirm")},cancel(){this.clear(),this.confirmCancel("cancel")},async submit(){this.loading=!0,this.alert="";try{this.mode==="create"?await M.create(this.milk)&&(this.loading=!1,this.value=!1,this.confirmCancel("confirm")):await M.update(this.milk._id,this.milk)&&(this.loading=!1,this.value=!1,this.confirmCancel("confirm"))}catch(t){console.error("Error : ",t),this.loading=!1,this.alert=t.response.data.message}}},components:{BaseButton:x,BaseButtons:K,CardBox:T,BaseDivider:N,OverlayLayer:E,FormField:W,FormControl:R,NotificationBar:F,BaseLevel:L,DDLCow:Z},props:{modelValue:{type:[String,Number,Boolean],default:null},mode:{type:String,default:""},dataEdit:{type:Object,default:null}}},$={class:"grid grid-cols-1 lg:grid-cols-2 gap-3 mt-1"};function ee(t,e,i,p,a,n){const d=o("FormControl"),u=o("FormField"),_=o("DDLCow"),b=o("NotificationBar"),g=o("BaseDivider"),h=o("BaseButton"),D=o("BaseButtons"),S=o("CardBox"),Q=o("OverlayLayer");return v((k(),w(Q,null,{default:r(()=>[v(l(S,{title:i.mode==="create"?"\u0E40\u0E1E\u0E34\u0E48\u0E21\u0E01\u0E32\u0E23\u0E23\u0E35\u0E14\u0E19\u0E21":"\u0E41\u0E01\u0E49\u0E44\u0E02\u0E01\u0E32\u0E23\u0E23\u0E35\u0E14\u0E19\u0E21",class:"shadow-lg w-full overflow-y-auto lg:w-1/3 z-50","header-icon":"close",modal:"",form:"",onSubmit:H(n.submit,["prevent"]),onHeaderIconClick:n.cancel},{default:r(()=>[U("div",$,[l(u,{label:"\u0E27\u0E31\u0E19\u0E17\u0E35\u0E48\u0E23\u0E35\u0E14\u0E19\u0E21",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:r(()=>[l(d,{modelValue:a.milk.date,"onUpdate:modelValue":e[0]||(e[0]=s=>a.milk.date=s),icon:"calendar",type:"date",required:""},null,8,["modelValue"])]),_:1}),l(u,{label:"\u0E42\u0E04",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:r(()=>[l(_,{modelValue:a.milk.cow,"onUpdate:modelValue":e[1]||(e[1]=s=>a.milk.cow=s)},null,8,["modelValue"])]),_:1}),l(u,{label:"\u0E1B\u0E23\u0E34\u0E21\u0E32\u0E13\u0E19\u0E49\u0E33\u0E19\u0E21/\u0E40\u0E0A\u0E49\u0E32",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:r(()=>[l(d,{modelValue:a.milk.morningQty,"onUpdate:modelValue":e[2]||(e[2]=s=>a.milk.morningQty=s),type:"number",icon:"weatherSunsetUp"},null,8,["modelValue"])]),_:1}),l(u,{label:"\u0E1B\u0E23\u0E34\u0E21\u0E32\u0E13\u0E19\u0E49\u0E33\u0E19\u0E21/\u0E1A\u0E48\u0E32\u0E22",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:r(()=>[l(d,{modelValue:a.milk.afternoonQty,"onUpdate:modelValue":e[3]||(e[3]=s=>a.milk.afternoonQty=s),type:"number",icon:"weatherSunsetDown"},null,8,["modelValue"])]),_:1}),l(u,{label:"\u0E1B\u0E23\u0E34\u0E21\u0E32\u0E13\u0E19\u0E49\u0E33\u0E19\u0E21\u0E23\u0E27\u0E21",help:"\u0E04\u0E33\u0E19\u0E27\u0E13\u0E2D\u0E31\u0E15\u0E42\u0E19\u0E21\u0E31\u0E15\u0E34"},{default:r(()=>[l(d,{modelValue:n.sumQty,"onUpdate:modelValue":e[4]||(e[4]=s=>n.sumQty=s),type:"number",disabled:"",icon:"water"},null,8,["modelValue"])]),_:1}),l(u,{label:"\u0E08\u0E33\u0E19\u0E27\u0E19\u0E40\u0E07\u0E34\u0E19\u0E23\u0E27\u0E21",help:"\u0E04\u0E33\u0E19\u0E27\u0E13\u0E2D\u0E31\u0E15\u0E42\u0E19\u0E21\u0E31\u0E15\u0E34 (\u0E23\u0E32\u0E04\u0E32\u0E19\u0E21/\u0E01\u0E01. = 100.00)"},{default:r(()=>[l(d,{modelValue:n.calAmount,"onUpdate:modelValue":e[5]||(e[5]=s=>n.calAmount=s),type:"number",icon:"cashMultiple"},null,8,["modelValue"])]),_:1})]),a.alert?(k(),w(b,{key:0,color:"danger",outline:"",icon:"alertCircleOutline"},{default:r(()=>[O(A(a.alert),1)]),_:1})):q("",!0),l(g),l(D,{type:"justify-center"},{default:r(()=>[l(h,{label:"\u0E1A\u0E31\u0E19\u0E17\u0E36\u0E01",color:"success",type:"submit",loading:a.loading},null,8,["loading"]),l(h,{label:"\u0E22\u0E01\u0E40\u0E25\u0E34\u0E01",color:"danger",onClick:n.cancel},null,8,["onClick"])]),_:1})]),_:1},8,["title","onSubmit","onHeaderIconClick"]),[[y,n.value]])]),_:1},512)),[[y,n.value]])}var te=B(X,[["render",ee]]);async function ae(t={}){let e="?";if(t.farm&&(e=e+`farm=${t.farm}&`),t.cow&&(e=e+`cow=${t.cow}&`),t.loginDate){const i=c(new Date(t.loginDate)).format("YYYY-MM-DD");e=e+`loginDate=${i}&`}if(t.estrusDate){const i=c(new Date(t.estrusDate)).format("YYYY-MM-DD");e=e+`estrusDate=${i}&`}if(t.matingDate){const i=c(new Date(t.matingDate)).format("YYYY-MM-DD");e=e+`matingDate=${i}&`}if(t.checkDate){const i=c(new Date(t.checkDate)).format("YYYY-MM-DD");e=e+`checkDate=${i}&`}return t.status&&(e=e+`status=${t.status}&`),t.result&&(e=e+`result=${t.result}&`),t?e.replace(/&*$/,""):""}class le{async all(e){const i=await ae(e);return m.get("/reproduction"+i,{headers:f()}).then(p=>p)}get(e){return m.get(`/reproduction/${e}`,{headers:f()})}create(e){return e.birthDate&&(e.birthDate=c(new Date(e.birthDate)).format("YYYY-MM-DD")),e.loginDate&&(e.loginDate=c(new Date(e.loginDate)).format("YYYY-MM-DD")),e.estrusDate&&(e.estrusDate=c(new Date(e.estrusDate)).format("YYYY-MM-DD")),e.matingDate&&(e.matingDate=c(new Date(e.matingDate)).format("YYYY-MM-DD")),e.checkDate&&(e.checkDate=c(new Date(e.checkDate)).format("YYYY-MM-DD")),m.post("/reproduction",e,{headers:f()})}delete(e){return m.delete(`/reproduction/${e}`,{headers:f()})}update(e,i){return m.put(`/reproduction/${e}`,i,{headers:f()})}}var Y=new le;const C=()=>[{id:"",label:"\u0E17\u0E31\u0E49\u0E07\u0E2B\u0E21\u0E14"},{id:1,label:"\u0E2D\u0E22\u0E39\u0E48\u0E43\u0E19\u0E01\u0E23\u0E30\u0E1A\u0E27\u0E19\u0E01\u0E32\u0E23"},{id:2,label:"\u0E15\u0E31\u0E49\u0E07\u0E04\u0E23\u0E23\u0E20\u0E4C"},{id:3,label:"\u0E04\u0E25\u0E2D\u0E14\u0E25\u0E39\u0E01\u0E41\u0E25\u0E49\u0E27"},{id:4,label:"\u0E2A\u0E37\u0E1A\u0E1E\u0E31\u0E19\u0E18\u0E38\u0E4C\u0E44\u0E21\u0E48\u0E2A\u0E33\u0E40\u0E23\u0E47\u0E08"}],V=()=>[{id:"",label:"\u0E17\u0E31\u0E49\u0E07\u0E2B\u0E21\u0E14"},{id:1,label:"\u0E1C\u0E34\u0E14\u0E1B\u0E01\u0E15\u0E34"},{id:2,label:"\u0E44\u0E02\u0E48\u0E40\u0E25\u0E47\u0E01"},{id:3,label:"\u0E15\u0E31\u0E49\u0E07\u0E23\u0E2D\u0E1A"},{id:4,label:"F(\u0E0B\u0E49\u0E32\u0E22)"},{id:5,label:"F(\u0E02\u0E27\u0E32)"}],ne={data(){return{openModal:!1,items:[],forms:[{label:"\u0E42\u0E04",value:"cow",type:"ddl",module:"cow"},{label:"\u0E27\u0E31\u0E19\u0E17\u0E35\u0E48\u0E40\u0E02\u0E49\u0E32\u0E23\u0E30\u0E1A\u0E1A\u0E2A\u0E37\u0E1A\u0E1E\u0E31\u0E19\u0E18\u0E38\u0E4C",value:"loginDate",icon:"calendar",type:"date"},{label:"\u0E27\u0E31\u0E19\u0E17\u0E35\u0E48\u0E40\u0E1B\u0E47\u0E19\u0E2A\u0E31\u0E14",value:"estrusDate",icon:"calendar",type:"date"},{label:"\u0E27\u0E31\u0E19\u0E17\u0E35\u0E48\u0E1C\u0E2A\u0E21\u0E1E\u0E31\u0E19\u0E18\u0E38\u0E4C",value:"matingDate",icon:"calendar",type:"date"},{label:"\u0E27\u0E31\u0E19\u0E17\u0E35\u0E48\u0E15\u0E23\u0E27\u0E08\u0E17\u0E49\u0E2D\u0E07",value:"checkDate",icon:"calendar",type:"date"},{label:"\u0E2A\u0E16\u0E32\u0E19\u0E30",value:"status",options:C()},{label:"\u0E1C\u0E25\u0E25\u0E31\u0E1E\u0E18\u0E4C",value:"result",options:V()}],search:{cow:null,loginDate:null,estrusDate:null,matingDate:null,checkDate:null,status:"",result:"",farm:j().farm._id},loading:!1,mode:"create",dataEdit:null,checked:{code:{value:"seq"},label:{value:"cow.name"}},datas:[{label:"\u0E04\u0E23\u0E31\u0E49\u0E07\u0E17\u0E35\u0E48",class:"text-center",value:"seq"},{label:"\u0E42\u0E04",value:"cow.name"},{label:"\u0E27\u0E31\u0E19\u0E17\u0E35\u0E48\u0E40\u0E02\u0E49\u0E32\u0E23\u0E30\u0E1A\u0E1A\u0E2A\u0E37\u0E1A\u0E1E\u0E31\u0E19\u0E18\u0E38\u0E4C",class:"text-center",value:"loginDate",type:"date"},{label:"\u0E1C\u0E25",func:t=>V()[t.result].label},{label:"\u0E27\u0E31\u0E19\u0E17\u0E35\u0E48\u0E40\u0E1B\u0E47\u0E19\u0E2A\u0E31\u0E14",class:"text-center",value:"estrusDate",type:"date"},{label:"\u0E27\u0E31\u0E19\u0E17\u0E35\u0E48\u0E1C\u0E2A\u0E21\u0E1E\u0E31\u0E19\u0E18\u0E38\u0E4C",class:"text-center",value:"matingDate",type:"date"},{label:"\u0E27\u0E31\u0E19\u0E17\u0E35\u0E48\u0E15\u0E23\u0E27\u0E08\u0E17\u0E49\u0E2D\u0E07",class:"text-center",value:"checkDate",type:"date"},{label:"\u0E1E\u0E48\u0E2D\u0E1E\u0E31\u0E19\u0E18\u0E38\u0E4C",value:"dad"},{label:"\u0E2A\u0E16\u0E32\u0E19\u0E30",func:t=>C()[t.status].label},{label:"\u0E27\u0E34\u0E18\u0E35\u0E23\u0E31\u0E01\u0E29\u0E32",value:"howTo"}],button:{edit:!0,delete:!0}}},components:{SectionMain:I,LayoutAuthenticated:z,SectionTitleBarSub:P,Table:G,Modal:te,Criteria:J},created(){this.getReproductions()},methods:{async getReproductions(t){this.loading=!0;const e=await Y.all(t);this.items=[],e.data&&(this.items=e.data.reproducts),this.loading=!1},async remove(t){this.loading=!0,(await Y.delete(t)).data&&this.getReproductions(),this.loading=!1},edit(t){this.dataEdit=t,this.dataEdit.cow=t.cow._id,this.mode="edit",this.openModal=!0},reset(){this.search.cow=null,this.search.date=null}}};function oe(t,e,i,p,a,n){const d=o("SectionTitleBarSub"),u=o("MilkModal"),_=o("Criteria"),b=o("Table"),g=o("SectionMain"),h=o("LayoutAuthenticated");return k(),w(h,null,{default:r(()=>[l(g,null,{default:r(()=>[l(d,{icon:"reproduction",title:"\u0E01\u0E32\u0E23\u0E2A\u0E37\u0E1A\u0E1E\u0E31\u0E19\u0E18\u0E38\u0E4C",btnText:"\u0E40\u0E1E\u0E34\u0E48\u0E21\u0E01\u0E32\u0E23\u0E2A\u0E37\u0E1A\u0E1E\u0E31\u0E19\u0E18\u0E38\u0E4C","has-btn-add":"",onOpenModal:e[0]||(e[0]=D=>{a.mode="create",a.openModal=!0})}),l(u,{modelValue:a.openModal,"onUpdate:modelValue":e[1]||(e[1]=D=>a.openModal=D),mode:a.mode,dataEdit:a.dataEdit,onConfirm:n.getReproductions,onCancel:n.getReproductions},null,8,["modelValue","mode","dataEdit","onConfirm","onCancel"]),l(_,{grid:"grid-cols-2 lg:grid-cols-7",onSearch:n.getReproductions,onReset:n.reset,forms:a.forms,search:a.search},null,8,["onSearch","onReset","forms","search"]),l(b,{title:"\u0E23\u0E32\u0E22\u0E01\u0E32\u0E23\u0E2A\u0E37\u0E1A\u0E1E\u0E31\u0E19\u0E18\u0E38\u0E4C","has-checkbox":"","checked-data":a.checked,items:a.items,datas:a.datas,button:a.button,onEdit:n.edit,onDelete:n.remove,onDeleteSelected:t.removeSelected},null,8,["checked-data","items","datas","button","onEdit","onDelete","onDeleteSelected"])]),_:1})]),_:1})}var fe=B(ne,[["render",oe]]);export{fe as default};
