import{h as D,N,O,a2 as F,y as U,k as E,x as L,R as Q,p as R,q as W,_ as H,U as A,Q as d,H as M,T as q,o as m,i as b,w as o,b as l,d as s,e as x,t as h,v as B,a as C,F as I,G as z,l as G,S as P,P as j,V as J}from"./index.69daac65.js";import{T as K,a as X}from"./Criteria.443f655a.js";import{_ as Y}from"./BaseButtons.70e24a77.js";import{_ as Z}from"./FormField.977b1f59.js";import{D as $}from"./Vaccine.0c837ce2.js";import{T as k}from"./alert.ecc24268.js";import{a as g}from"./auth-header.517986b8.js";import"./CardBoxModal.29352803.js";async function ee(t={}){let e="?";return t.farm&&(e=e+`farm=${t.farm}&`),t.type&&(e=e+`type=${t.type}&`),t.recipe&&(e=e+`recipe=${t.recipe}&`),t?e.replace(/&*$/,""):""}class te{async all(e){const r=await ee(e);return D.get("/recipe"+r,{headers:g()}).then(f=>f)}get(e){return D.get(`/recipe/${e}`,{headers:g()})}create(e){return D.post("/recipe",e,{headers:g()})}delete(e){return D.delete(`/recipe/${e}`,{headers:g()})}update(e,r){return D.put(`/recipe/${e}`,r,{headers:g()})}}var V=new te;const S=t=>t==="create"?[{id:1,label:"\u0E2B\u0E22\u0E32\u0E1A"},{id:2,label:"\u0E1C\u0E2A\u0E21\u0E40\u0E2D\u0E07"},{id:3,label:"\u0E2A\u0E33\u0E40\u0E23\u0E47\u0E08\u0E23\u0E39\u0E1B"}]:[{id:"",label:"\u0E17\u0E31\u0E49\u0E07\u0E2B\u0E21\u0E14"},{id:1,label:"\u0E2B\u0E22\u0E32\u0E1A"},{id:2,label:"\u0E1C\u0E2A\u0E21\u0E40\u0E2D\u0E07"},{id:3,label:"\u0E2A\u0E33\u0E40\u0E23\u0E47\u0E08\u0E23\u0E39\u0E1B"}],ae={data(){return{recipe:{code:"",name:"",type:1,amount:0,farm:O().farm._id},recipeDetail:{},recipeDetails:[],type:S("create"),loading:!1,alertError:"",alertWarning:"",alertDetail:""}},emits:["update:modelValue","cancel","confirm"],computed:{value:{get(){return this.modelValue},set(t){this.$emit("update:modelValue",t)}}},watch:{data(t){t&&this.mode==="edit"&&(this.recipe=t,this.recipe.dateCurrent=new Date(t.dateCurrent),this.recipe.dateNext=new Date(t.dateNext))},"recipe.frequency"(t){t&&(this.recipe.dateNext=F(new Date(this.recipe.dateCurrent),t))},"recipeDetail.cost"(t){var e,r;t&&((e=this.recipeDetail)==null?void 0:e.qty)?this.recipeDetail.amount=t*((r=this.recipeDetail)==null?void 0:r.qty):this.recipeDetail.amount=null},"recipeDetail.qty"(t){var e,r;t&&((e=this.recipeDetail)==null?void 0:e.cost)?this.recipeDetail.amount=t*((r=this.recipeDetail)==null?void 0:r.cost):this.recipeDetail.amount=null}},methods:{clear(){this.recipe.dateCurrent=new Date,this.recipe.dateNext=null,this.recipe.vaccine="",this.recipe.frequency="",this.recipe.remark=""},confirmCancel(t){this.value=!1,this.$emit(t)},confirm(){this.clear(),this.confirmCancel("confirm")},cancel(){this.clear(),this.confirmCancel("cancel")},addDetail(){var t,e,r,f,a;this.alertDetail="",((t=this.recipeDetail)==null?void 0:t.food)&&((e=this.recipeDetail)==null?void 0:e.qty)&&((r=this.recipeDetail)==null?void 0:r.cost)?this.recipeDetails.filter(u=>{var c;return u.food===((c=this.recipeDetail)==null?void 0:c.food)}).length<=0?((f=this.recipeDetail)==null?void 0:f.qty)<=1?this.recipeDetails.reduce((c,p)=>c+p,0)<=1?(this.recipeDetails.push(this.recipeDetail),this.recipe.amount+=(a=this.recipeDetail)==null?void 0:a.amount,this.recipeDetail={}):this.alertDetail="\u0E08\u0E33\u0E19\u0E27\u0E19\u0E17\u0E35\u0E48\u0E43\u0E0A\u0E49\u0E23\u0E27\u0E21\u0E2B\u0E49\u0E32\u0E21\u0E40\u0E01\u0E34\u0E19 1 \u0E01\u0E01.":this.alertDetail="\u0E08\u0E33\u0E19\u0E27\u0E19\u0E17\u0E35\u0E48\u0E43\u0E0A\u0E49\u0E2B\u0E49\u0E32\u0E21\u0E40\u0E01\u0E34\u0E19 1 \u0E01\u0E01.":this.alertDetail="\u0E2D\u0E32\u0E2B\u0E32\u0E23/\u0E27\u0E31\u0E15\u0E16\u0E38\u0E14\u0E34\u0E1A \u0E0B\u0E49\u0E33":this.alertDetail="\u0E01\u0E23\u0E38\u0E13\u0E32\u0E01\u0E23\u0E2D\u0E01\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25\u0E43\u0E2B\u0E49\u0E04\u0E23\u0E1A"},removeDetail(t){var r;let e=this.recipeDetails.indexOf(t);e!==-1&&(this.recipe.amount-=(r=this.recipeDetails[e])==null?void 0:r.amount,this.recipeDetails.splice(e,1))},async submit(){this.loading=!0,this.alert="",this.alertWarning="";try{this.mode==="create"?this.recipeDetails.reduce((e,r)=>e+r,0)===1?await V.create({recipe:this.recipe,recipeDetail:this.recipeDetails})&&(this.loading=!1,this.value=!1,this.confirmCancel("confirm"),k.fire({icon:"success",title:"\u0E1A\u0E31\u0E19\u0E17\u0E36\u0E01\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25\u0E2A\u0E33\u0E40\u0E23\u0E47\u0E08"})):this.alertWarning="\u0E01\u0E23\u0E38\u0E13\u0E32\u0E40\u0E1E\u0E34\u0E48\u0E21 \u0E23\u0E32\u0E22\u0E01\u0E32\u0E23\u0E2D\u0E32\u0E2B\u0E32\u0E23/\u0E27\u0E31\u0E15\u0E16\u0E38\u0E14\u0E34\u0E1A \u0E43\u0E2B\u0E49\u0E04\u0E23\u0E1A 1 \u0E01\u0E01.":await V.update(this.recipe._id,this.recipe)&&(this.loading=!1,this.value=!1,this.confirmCancel("confirm"))}catch(t){console.error("Error : ",t),this.clear(),this.loading=!1,this.alertError=await t.response.data.message,k.fire({icon:"error",title:"\u0E1A\u0E31\u0E19\u0E17\u0E36\u0E01\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25\u0E44\u0E21\u0E48\u0E2A\u0E33\u0E40\u0E23\u0E47\u0E08"})}}},components:{BaseButton:U,BaseButtons:Y,CardBox:E,BaseDivider:L,OverlayLayer:Q,FormField:Z,FormControl:R,NotificationBar:W,BaseLevel:H,DDLVaccine:$,BaseIcon:A},props:{modelValue:{type:[String,Number,Boolean],default:null},data:{type:Object,default:null},mode:{type:String,default:""}}},le={class:"grid grid-cols-2 lg:grid-cols-4 gap-5"},ie={class:"grid grid-cols-2 lg:grid-cols-6 gap-5"},re=s("header",{class:"flex items-stretch border-b border-gray-100 dark:border-gray-800"},[s("p",{class:"flex items-center py-3 grow font-bold"}," \u0E23\u0E32\u0E22\u0E01\u0E32\u0E23\u0E2D\u0E32\u0E2B\u0E32\u0E23/\u0E27\u0E31\u0E15\u0E16\u0E38\u0E14\u0E34\u0E1A ")],-1),se={key:1,class:"overflow-x-auto"},oe=s("thead",null,[s("tr",null,[s("th",{class:"whitespace-nowrap text-center"}," \u0E2D\u0E32\u0E2B\u0E32\u0E23/\u0E27\u0E31\u0E15\u0E16\u0E38\u0E14\u0E34\u0E1A "),s("th",{class:"whitespace-nowrap text-center"}," \u0E23\u0E32\u0E04\u0E32/\u0E01\u0E01. "),s("th",{class:"whitespace-nowrap text-center"}," \u0E08\u0E33\u0E19\u0E27\u0E19\u0E17\u0E35\u0E48\u0E43\u0E0A\u0E49 (\u0E01\u0E01.) "),s("th",{class:"whitespace-nowrap text-center"}," \u0E08\u0E33\u0E19\u0E27\u0E19\u0E40\u0E07\u0E34\u0E19 "),s("th")])],-1),ne={"data-label":"\u0E2D\u0E32\u0E2B\u0E32\u0E23/\u0E27\u0E31\u0E15\u0E16\u0E38\u0E14\u0E34\u0E1A"},ce={"data-label":"\u0E23\u0E32\u0E04\u0E32/\u0E01\u0E01.",class:"text-center"},de={"data-label":"\u0E08\u0E33\u0E19\u0E27\u0E19\u0E17\u0E35\u0E48\u0E43\u0E0A\u0E49 (\u0E01\u0E01.)",class:"text-center"},ue={"data-label":"\u0E08\u0E33\u0E19\u0E27\u0E19\u0E40\u0E07\u0E34\u0E19",class:"text-right"},pe={class:"lg:w-6 whitespace-nowrap"},me={key:2,class:"text-center py-10 text-gray-500 dark:text-gray-400"},he=s("p",null,"\u0E44\u0E21\u0E48\u0E21\u0E35\u0E23\u0E32\u0E22\u0E01\u0E32\u0E23...",-1),fe=[he];function _e(t,e,r,f,a,n){const u=d("FormControl"),c=d("FormField"),p=d("BaseButton"),_=d("BaseButtons"),y=d("NotificationBar"),v=d("CardBox"),w=d("BaseDivider"),T=d("OverlayLayer");return M((m(),b(T,null,{default:o(()=>[M(l(v,{title:(this.mode==="create"?"\u0E1A\u0E31\u0E19\u0E17\u0E36\u0E01":"\u0E41\u0E01\u0E49\u0E44\u0E02")+"\u0E2A\u0E39\u0E15\u0E23\u0E2D\u0E32\u0E2B\u0E32\u0E23",class:"shadow-lg w-full overflow-y-auto lg:w-2/3 z-50","header-icon":"close",modal:"",form:"",onSubmit:G(n.submit,["prevent"]),onHeaderIconClick:n.cancel},{default:o(()=>[s("div",le,[l(c,{label:"\u0E0A\u0E37\u0E48\u0E2D\u0E2A\u0E39\u0E15\u0E23\u0E2D\u0E32\u0E2B\u0E32\u0E23",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:o(()=>[l(u,{modelValue:a.recipe.name,"onUpdate:modelValue":e[0]||(e[0]=i=>a.recipe.name=i),icon:"potMixOutline",required:""},null,8,["modelValue"])]),_:1}),l(c,{label:"\u0E1B\u0E23\u0E30\u0E40\u0E20\u0E17\u0E2D\u0E32\u0E2B\u0E32\u0E23",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:o(()=>[l(u,{modelValue:a.recipe.type,"onUpdate:modelValue":e[1]||(e[1]=i=>a.recipe.type=i),options:a.type,required:""},null,8,["modelValue","options"])]),_:1}),l(c,{label:"\u0E08\u0E33\u0E19\u0E27\u0E19\u0E40\u0E07\u0E34\u0E19\u0E23\u0E27\u0E21 \u0E15\u0E48\u0E2D 1 \u0E01\u0E01."},{default:o(()=>[l(u,{modelValue:a.recipe.amount,"onUpdate:modelValue":e[2]||(e[2]=i=>a.recipe.amount=i),icon:"cashMultiple",type:"number",required:""},null,8,["modelValue"])]),_:1})]),l(v,{title:"\u0E23\u0E32\u0E22\u0E25\u0E30\u0E40\u0E2D\u0E35\u0E22\u0E14\u0E2A\u0E39\u0E15\u0E23\u0E2D\u0E32\u0E2B\u0E32\u0E23",class:"shadow-lg dark:bg-slate-700","header-icon":""},{default:o(()=>[s("div",ie,[l(c,{label:"\u0E2D\u0E32\u0E2B\u0E32\u0E23/\u0E27\u0E31\u0E15\u0E16\u0E38\u0E14\u0E34\u0E1A",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07",class:"col-span-2"},{default:o(()=>[l(u,{modelValue:a.recipeDetail.food,"onUpdate:modelValue":e[3]||(e[3]=i=>a.recipeDetail.food=i),icon:"foodVariant"},null,8,["modelValue"])]),_:1}),l(c,{label:"\u0E23\u0E32\u0E04\u0E32/\u0E01\u0E01.",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:o(()=>[l(u,{modelValue:a.recipeDetail.cost,"onUpdate:modelValue":e[4]||(e[4]=i=>a.recipeDetail.cost=i),icon:"cash",type:"number"},null,8,["modelValue"])]),_:1}),l(c,{label:"\u0E08\u0E33\u0E19\u0E27\u0E19\u0E17\u0E35\u0E48\u0E43\u0E0A\u0E49 (\u0E01\u0E01.)",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07 (\u0E2B\u0E49\u0E32\u0E21\u0E40\u0E01\u0E34\u0E19 1 \u0E01\u0E01.)"},{default:o(()=>[l(u,{icon:"scale",type:"number",modelValue:a.recipeDetail.qty,"onUpdate:modelValue":e[5]||(e[5]=i=>a.recipeDetail.qty=i)},null,8,["modelValue"])]),_:1}),l(c,{label:"\u0E08\u0E33\u0E19\u0E27\u0E19\u0E40\u0E07\u0E34\u0E19"},{default:o(()=>[l(u,{modelValue:a.recipeDetail.amount,"onUpdate:modelValue":e[6]||(e[6]=i=>a.recipeDetail.amount=i),icon:"cashMultiple",type:"number"},null,8,["modelValue"])]),_:1}),l(_,{type:"justify-center"},{default:o(()=>[l(p,{label:"\u0E40\u0E1E\u0E34\u0E48\u0E21",color:"success",onClick:n.addDetail},null,8,["onClick"]),l(p,{label:"\u0E25\u0E49\u0E32\u0E07",color:"danger",onClick:e[7]||(e[7]=i=>t.resetDetail())})]),_:1})]),a.alertDetail?(m(),b(y,{key:0,color:"warning",outline:"",icon:"alertCircleOutline"},{default:o(()=>[x(h(a.alertDetail),1)]),_:1})):B("",!0),re,a.recipeDetails.length>0?(m(),C("div",se,[s("table",null,[oe,s("tbody",null,[(m(!0),C(I,null,z(a.recipeDetails,i=>(m(),C("tr",{key:i.food},[s("td",ne,h(i.food),1),s("td",ce,h(i.cost),1),s("td",de,h(i.qty),1),s("td",ue,h(i.amount),1),s("td",pe,[l(_,{type:"justify-end lg:justify-start","no-wrap":""},{default:o(()=>[l(p,{color:"danger",label:"\u0E25\u0E1A",onClick:be=>n.removeDetail(i)},null,8,["onClick"])]),_:2},1024)])]))),128))])])])):(m(),C("div",me,fe))]),_:1}),a.alertError?(m(),b(y,{key:0,color:"danger",outline:"",icon:"alertCircleOutline"},{default:o(()=>[x(h(a.alertError),1)]),_:1})):B("",!0),a.alertWarning?(m(),b(y,{key:1,color:"warning",outline:"",icon:"alertCircleOutline"},{default:o(()=>[x(h(a.alertWarning),1)]),_:1})):B("",!0),l(w),l(_,{type:"justify-center"},{default:o(()=>[l(p,{label:"\u0E1A\u0E31\u0E19\u0E17\u0E36\u0E01",color:"success",type:"submit",loading:a.loading},null,8,["loading"]),l(p,{label:"\u0E22\u0E01\u0E40\u0E25\u0E34\u0E01",color:"danger",onClick:n.cancel},null,8,["onClick"])]),_:1})]),_:1},8,["title","onSubmit","onHeaderIconClick"]),[[q,n.value]])]),_:1},512)),[[q,n.value]])}var ye=N(ae,[["render",_e]]);const De={data(){return{openModal:!1,modalData:null,items:[],forms:[{label:"\u0E2A\u0E39\u0E15\u0E23\u0E2D\u0E32\u0E2B\u0E32\u0E23",value:"recipe",icon:"recipe"},{label:"\u0E1B\u0E23\u0E30\u0E40\u0E20\u0E17",value:"type",options:S()}],search:{recipe:"",type:"",farm:O().farm._id},loading:!1,mode:"create",dataEdit:null,checked:{code:{value:"code"},label:{value:"name"}},datas:[{label:"\u0E2A\u0E39\u0E15\u0E23\u0E2D\u0E32\u0E2B\u0E32\u0E23",class:"text-center",value:"name"},{label:"\u0E1B\u0E23\u0E30\u0E40\u0E20\u0E17",class:"text-center",func:t=>S()[t.type].label},{label:"\u0E23\u0E32\u0E04\u0E32/\u0E01\u0E01.",class:"text-center",value:"amount"}],buttons:[{label:"\u0E25\u0E1A",type:"delete",color:"danger"},{label:"\u0E41\u0E01\u0E49\u0E44\u0E02",type:"edit",color:"warning"}]}},components:{SectionMain:P,LayoutAuthenticated:j,SectionTitleBarSub:J,Table:K,Modal:ye,Criteria:X},created(){this.getDatas()},methods:{async getDatas(){this.loading=!0;const t=await V.all(this.search);this.items=[],t.data&&(this.items=t.data.recipes),this.loading=!1},async remove(t){this.loading=!0,(await V.delete(t)).data&&this.getDatas(),this.loading=!1,k.fire({icon:"success",title:"\u0E25\u0E1A\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25\u0E2A\u0E33\u0E40\u0E23\u0E47\u0E08"})},edit(t){this.modalData=t,this.mode="edit",this.openModal=!0},reset(){this.search.recipe="",this.search.type="",this.getDatas()}}};function ge(t,e,r,f,a,n){const u=d("SectionTitleBarSub"),c=d("Modal"),p=d("Criteria"),_=d("Table"),y=d("SectionMain"),v=d("LayoutAuthenticated");return m(),b(v,null,{default:o(()=>[l(y,null,{default:o(()=>[l(u,{icon:"calculatorVariantOutline",title:"\u0E2A\u0E39\u0E15\u0E23\u0E2D\u0E32\u0E2B\u0E32\u0E23","has-btn-add":"",onOpenModal:e[0]||(e[0]=w=>{a.mode="create",a.openModal=!0}),btnText:"\u0E40\u0E1E\u0E34\u0E48\u0E21\u0E2A\u0E39\u0E15\u0E23\u0E2D\u0E32\u0E2B\u0E32\u0E23"}),l(c,{modelValue:a.openModal,"onUpdate:modelValue":e[1]||(e[1]=w=>a.openModal=w),data:a.modalData,mode:a.mode,onConfirm:n.getDatas,onCancel:n.getDatas},null,8,["modelValue","data","mode","onConfirm","onCancel"]),l(p,{grid:"grid-cols-2 lg:grid-cols-4",onSearch:n.getDatas,onReset:n.reset,forms:a.forms,search:a.search},null,8,["onSearch","onReset","forms","search"]),l(_,{title:"\u0E23\u0E32\u0E22\u0E01\u0E32\u0E23\u0E2A\u0E39\u0E15\u0E23\u0E2D\u0E32\u0E2B\u0E32\u0E23","has-checkbox":"","checked-data":a.checked,items:a.items,datas:a.datas,buttons:a.buttons,onEdit:n.edit,onDelete:n.remove,onDeleteSelected:t.removeSelected,loading:a.loading},null,8,["checked-data","items","datas","buttons","onEdit","onDelete","onDeleteSelected","loading"])]),_:1})]),_:1})}var Me=N(De,[["render",ge]]);export{Me as default};
