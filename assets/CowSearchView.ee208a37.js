import{N as C,e as S,Q as n,o as w,c as b,w as i,p as y,O as U,l as k,_ as F,k as x,R as N,g as E,h as O,f as j,H as B,T as V,b as l,i as L,t as R,j as Y,d as q,S as H,P as z,U as P,V as Q}from"./index.d9459ccd.js";import{_ as A}from"./BaseButtons.a219570e.js";import{_ as M}from"./FormField.70d11339.js";import{C as v,D as G,T as J,a as K}from"./Criteria.0da58ea3.js";import"./CardBoxModal.1507fbc3.js";import"./auth-header.3292437b.js";const W={computed:{value:{get(){return this.modelValue},set(o){this.$emit("update:modelValue",o)}}},methods:{chooseImg(){let o=document.getElementById("imageUpload");o!=null&&o.click()},handleFile(o){var a=o.target.files||o.dataTransfer.files;!a.length||this.createBase64(a[0])},createBase64(o){var a=new FileReader;a.onload=f=>{this.value=f.target.result},a.readAsDataURL(o)}},components:{BaseLevel:S},props:{modelValue:{type:String,default:""}}},X=["src"];function Z(o,a,f,p,t,s){const g=n("BaseLevel");return w(),b(g,{type:"justify-center mb-1"},{default:i(()=>[y("input",{id:"imageUpload",onChange:a[0]||(a[0]=(...m)=>s.handleFile&&s.handleFile(...m)),type:"file",accept:"image/*",hidden:""},null,32),y("img",{class:"w-56 cursor-pointer rounded-lg",onClick:a[1]||(a[1]=(...m)=>s.chooseImg&&s.chooseImg(...m)),src:s.value},null,8,X)]),_:1})}var $=C(W,[["render",Z]]);const ee={data(){return{cow:{image:"../../src/assets/image/img-mockup.png",code:"",name:"",status:"1",birthDate:null,corral:"",dad:"",mom:"",farm:U().farm._id},status:[{id:1,label:"\u0E17\u0E49\u0E2D\u0E07"},{id:2,label:"\u0E19\u0E21\u0E41\u0E2B\u0E49\u0E07"},{id:3,label:"\u0E43\u0E2B\u0E49\u0E1C\u0E25\u0E1C\u0E25\u0E34\u0E15"},{id:4,label:"\u0E27\u0E31\u0E27\u0E40\u0E14\u0E47\u0E01"}],loading:!1,alert:""}},emits:["update:modelValue","cancel","confirm"],computed:{value:{get(){return this.modelValue},set(o){this.$emit("update:modelValue",o)}}},watch:{dataEdit:{handler(o,a){o!=null&&this.mode=="edit"&&(this.cow=o,this.cow.image=this.cow.image?this.cow.image:"../../src/assets/image/img-mockup.png")},deep:!0}},methods:{clear(){this.$emit("update:dataEdit",null),this.cow.image="../../src/assets/image/img-mockup.png",this.cow.code="",this.cow.name="",this.cow.birthDate=null,this.cow.status=1,this.cow.corral="",this.cow.dad="",this.cow.mom="",delete this.cow._id},confirmCancel(o){this.value=!1,this.$emit(o)},confirm(){this.clear(),this.confirmCancel("confirm")},cancel(){this.clear(),this.confirmCancel("cancel")},async submit(){this.loading=!0,this.alert="";try{this.mode==="create"?await v.create(this.cow)&&(this.loading=!1,this.value=!1,this.confirmCancel("confirm")):await v.update(this.cow._id,this.cow)&&(this.loading=!1,this.value=!1,this.confirmCancel("confirm"))}catch(o){console.error("Error : ",o),this.loading=!1,this.alert=o.response.data.message}}},components:{BaseButton:k,BaseButtons:A,CardBox:F,BaseDivider:x,OverlayLayer:N,FormField:M,FormControl:E,NotificationBar:O,UserAvatar:j,BaseLevel:S,ImageUpload:$},props:{modelValue:{type:[String,Number,Boolean],default:null},mode:{type:String,default:""},dataEdit:{type:Object,default:null}}},ae=L(" \u0E2D\u0E31\u0E1E\u0E42\u0E2B\u0E25\u0E14\u0E23\u0E39\u0E1B\u0E20\u0E32\u0E1E (\u0E04\u0E25\u0E34\u0E01\u0E17\u0E35\u0E48\u0E23\u0E39\u0E1B) "),te={class:"grid lg:grid-cols-4 grid-cols-2 gap-5 mt-3"};function oe(o,a,f,p,t,s){const g=n("ImageUpload"),m=n("BaseLevel"),d=n("FormControl"),c=n("FormField"),h=n("NotificationBar"),_=n("BaseDivider"),e=n("BaseButton"),u=n("BaseButtons"),T=n("CardBox"),I=n("OverlayLayer");return B((w(),b(I,null,{default:i(()=>[B(l(T,{title:f.mode==="create"?"\u0E40\u0E1E\u0E34\u0E48\u0E21\u0E42\u0E04":"\u0E41\u0E01\u0E49\u0E44\u0E02\u0E42\u0E04",class:"shadow-lg w-full overflow-y-auto md:w-3/5 lg:w-1/1 z-50","header-icon":"close",modal:"",form:"",onSubmit:q(s.submit,["prevent"]),onHeaderIconClick:s.cancel},{default:i(()=>[l(g,{modelValue:t.cow.image,"onUpdate:modelValue":a[0]||(a[0]=r=>t.cow.image=r)},null,8,["modelValue"]),l(m,{type:"justify-center mb-6"},{default:i(()=>[ae]),_:1}),y("div",te,[l(c,{label:"\u0E23\u0E2B\u0E31\u0E2A\u0E42\u0E04",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:i(()=>[l(d,{modelValue:t.cow.code,"onUpdate:modelValue":a[1]||(a[1]=r=>t.cow.code=r),icon:"barcode",required:""},null,8,["modelValue"])]),_:1}),l(c,{label:"\u0E0A\u0E37\u0E48\u0E2D\u0E42\u0E04",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:i(()=>[l(d,{modelValue:t.cow.name,"onUpdate:modelValue":a[2]||(a[2]=r=>t.cow.name=r),icon:"cow",required:""},null,8,["modelValue"])]),_:1}),l(c,{label:"\u0E27\u0E31\u0E19\u0E40\u0E01\u0E34\u0E14",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:i(()=>[l(d,{modelValue:t.cow.birthDate,"onUpdate:modelValue":a[3]||(a[3]=r=>t.cow.birthDate=r),icon:"calendar",type:"date",required:""},null,8,["modelValue"])]),_:1}),l(c,{label:"\u0E2A\u0E16\u0E32\u0E19\u0E30",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:i(()=>[l(d,{modelValue:t.cow.status,"onUpdate:modelValue":a[4]||(a[4]=r=>t.cow.status=r),options:t.status,icon:"",required:""},null,8,["modelValue","options"])]),_:1}),l(c,{label:"\u0E04\u0E2D\u0E01"},{default:i(()=>[l(d,{modelValue:t.cow.corral,"onUpdate:modelValue":a[5]||(a[5]=r=>t.cow.corral=r),icon:"barn"},null,8,["modelValue"])]),_:1}),l(c,{label:"\u0E1E\u0E48\u0E2D\u0E1E\u0E31\u0E19\u0E18\u0E38\u0E4C"},{default:i(()=>[l(d,{modelValue:t.cow.dad,"onUpdate:modelValue":a[6]||(a[6]=r=>t.cow.dad=r),icon:"genderMale"},null,8,["modelValue"])]),_:1}),l(c,{label:"\u0E41\u0E21\u0E48\u0E1E\u0E31\u0E19\u0E18\u0E38\u0E4C"},{default:i(()=>[l(d,{modelValue:t.cow.mom,"onUpdate:modelValue":a[7]||(a[7]=r=>t.cow.mom=r),icon:"genderFemale"},null,8,["modelValue"])]),_:1})]),t.alert?(w(),b(h,{key:0,color:"danger",outline:"",icon:"alertCircleOutline"},{default:i(()=>[L(R(t.alert),1)]),_:1})):Y("",!0),l(_),l(u,{type:"justify-center"},{default:i(()=>[l(e,{label:"\u0E1A\u0E31\u0E19\u0E17\u0E36\u0E01",color:"success",type:"submit",loading:t.loading},null,8,["loading"]),l(e,{label:"\u0E22\u0E01\u0E40\u0E25\u0E34\u0E01",color:"danger",onClick:s.cancel},null,8,["onClick"])]),_:1})]),_:1},8,["title","onSubmit","onHeaderIconClick"]),[[V,s.value]])]),_:1},512)),[[V,s.value]])}var le=C(ee,[["render",oe]]),se=a=>{var a=new Date(a),f=a.getYear(),p=a.getMonth(),t=a.getDate(),s=new Date,g=s.getYear(),m=s.getMonth(),d=s.getDate(),e={},u="",c=g-f;if(m>=p)var h=m-p;else{c--;var h=12+m-p}if(d>=t)var _=d-t;else{h--;var _=31+d-t;h<0&&(h=11,c--)}var e={years:c,months:h,days:_},u="";return e.years>0&&e.months>0&&e.days>0?u=e.years+" \u0E1B\u0E35 "+e.months+" \u0E40\u0E14\u0E37\u0E2D\u0E19 "+e.days+" \u0E27\u0E31\u0E19":e.years==0&&e.months==0&&e.days>0?u=e.days+" \u0E27\u0E31\u0E19":e.years>0&&e.months==0&&e.days==0?u=e.years+" \u0E1B\u0E35 (\u0E27\u0E31\u0E19\u0E40\u0E01\u0E34\u0E14)":e.years>0&&e.months>0&&e.days==0?u=e.years+" \u0E1B\u0E35 "+e.months+" \u0E40\u0E14\u0E37\u0E2D\u0E19":e.years==0&&e.months>0&&e.days>0?u=e.months+" \u0E40\u0E14\u0E37\u0E2D\u0E19 "+e.days+" \u0E27\u0E31\u0E19":e.years>0&&e.months==0&&e.days>0?u=e.years+" \u0E1B\u0E35 "+e.days+" \u0E27\u0E31\u0E19":e.years==0&&e.months>0&&e.days==0&&(u=e.months+" \u0E40\u0E14\u0E37\u0E2D\u0E19"),u};const D=()=>[{id:"",label:"\u0E17\u0E31\u0E49\u0E07\u0E2B\u0E21\u0E14"},{id:1,label:"\u0E17\u0E49\u0E2D\u0E07"},{id:2,label:"\u0E19\u0E21\u0E41\u0E2B\u0E49\u0E07"},{id:3,label:"\u0E43\u0E2B\u0E49\u0E1C\u0E25\u0E1C\u0E25\u0E34\u0E15"},{id:4,label:"\u0E27\u0E31\u0E27\u0E40\u0E14\u0E47\u0E01"}],ne={data(){return{modalCow:!1,items:[],forms:[{label:"\u0E42\u0E04",value:"code",type:"ddl",module:"cow",valueType:"code"},{label:"\u0E27\u0E31\u0E19\u0E40\u0E01\u0E34\u0E14",value:"birthDate",icon:"calendar",type:"date"},{label:"\u0E2A\u0E16\u0E32\u0E19\u0E30",value:"status",options:D()},{label:"\u0E04\u0E2D\u0E01",value:"corral",icon:"barn"}],search:{code:null,status:"",birthDate:null,corral:"",flag:"Y",farm:U().farm._id},loading:!1,mode:"create",dataEdit:null,checked:{code:{value:"code"},label:{value:"name"}},datas:[{label:"\u0E23\u0E39\u0E1B\u0E20\u0E32\u0E1E",class:"text-center",value:"image",type:"image"},{label:"\u0E23\u0E2B\u0E31\u0E2A\u0E42\u0E04",value:"code"},{label:"\u0E0A\u0E37\u0E48\u0E2D\u0E42\u0E04",value:"name"},{label:"\u0E27\u0E31\u0E19\u0E40\u0E01\u0E34\u0E14",class:"text-center",value:"birthDate",type:"date"},{label:"\u0E2D\u0E32\u0E22\u0E38",class:"text-center",func:o=>this.calAge(o.birthDate)},{label:"\u0E2A\u0E16\u0E32\u0E19\u0E30",func:o=>D()[o.status].label},{label:"\u0E04\u0E2D\u0E01",value:"corral"},{label:"\u0E1E\u0E48\u0E2D\u0E1E\u0E31\u0E19\u0E18\u0E38\u0E4C",value:"dad"},{label:"\u0E41\u0E21\u0E48\u0E1E\u0E31\u0E19\u0E18\u0E38\u0E4C",value:"mom"}],button:{edit:!0,delete:!0,detail:{path:"/manage/cow/detail"}}}},components:{SectionMain:H,LayoutAuthenticated:z,BaseButton:k,BaseIcon:P,BaseButtons:A,CardBox:F,FormControl:E,FormField:M,BaseDivider:x,DDLCow:G,CreateCowModal:le,Table:J,SectionTitleBarSub:Q,Criteria:K},created(){this.getCows()},methods:{async getCows(){this.loading=!0;const o=await v.all(this.search);this.items=[],o.data&&(this.items=o.data.cows),this.loading=!1},async removeCow(){this.loading=!0,(await v.update(this.idConfirm,{flag:"N"})).data&&this.getCows(),this.loading=!1},edit(o){this.dataEdit=o,this.mode="edit",this.dataEdit.birthDate=new Date(this.dataEdit.birthDate),this.modalCow=!0},reset(){this.search.code=null,this.search.status="",this.search.birthDate=null,this.search.corral=""},calAge(o){return se(o)}}};function re(o,a,f,p,t,s){const g=n("SectionTitleBarSub"),m=n("CreateCowModal"),d=n("Criteria"),c=n("Table"),h=n("SectionMain"),_=n("LayoutAuthenticated");return w(),b(_,null,{default:i(()=>[l(h,null,{default:i(()=>[l(g,{icon:"cow",title:"\u0E42\u0E04",btnText:"\u0E40\u0E1E\u0E34\u0E48\u0E21\u0E42\u0E04","has-btn-add":"",onOpenModal:a[0]||(a[0]=e=>{t.mode="create",t.modalCow=!0})}),l(m,{modelValue:t.modalCow,"onUpdate:modelValue":a[1]||(a[1]=e=>t.modalCow=e),onConfirm:s.getCows,onCancel:s.getCows,mode:t.mode,dataEdit:t.dataEdit},null,8,["modelValue","onConfirm","onCancel","mode","dataEdit"]),l(d,{title:"\u0E04\u0E49\u0E19\u0E2B\u0E32\u0E42\u0E04",grid:"grid-cols-2 lg:grid-cols-4",onSearch:s.getCows,onReset:s.reset,forms:t.forms,search:t.search},null,8,["onSearch","onReset","forms","search"]),l(c,{title:"\u0E23\u0E32\u0E22\u0E01\u0E32\u0E23\u0E42\u0E04","has-checkbox":"","checked-data":t.checked,datas:t.datas,items:t.items,button:t.button,onEdit:s.edit,onDelete:s.removeCow},null,8,["checked-data","datas","items","button","onEdit","onDelete"])]),_:1})]),_:1})}var fe=C(ne,[["render",re]]);export{fe as default};
