import{b as C,_ as S,a as x,d as M,c as N}from"./BaseDivider-5d6d6cd6.js";import{_ as L}from"./LayoutAuthenticated-188296d3.js";import{_ as T}from"./SectionTitleBarSub-bf101c49.js";import{T as U}from"./Table-eb9e0d2d.js";import{C as F}from"./Criteria-6bddc43b.js";import{v,h as O,_ as W,z as n,G as D,H as V,o as g,c as k,w as r,d as l,j as q,f as E,t as H,g as A,e as j}from"./index-a11eb788.js";import{a as I}from"./CardBoxModal-4190cff7.js";import{_ as R}from"./FormField-eae473e8.js";import{_ as z}from"./FormControl-913bfab2.js";import{_ as G}from"./NotificationBar-c518edd8.js";import{T as f}from"./alert-eb15281a.js";import{W as u}from"./worker-4c545087.js";import{_ as P}from"./FormCheckRadioPicker-e4bf5636.js";import"./UserAvatar-8818f699.js";import"./CardBoxCollapse-432b6c08.js";import"./Cow-523e81c3.js";import"./cow-1c284aa3.js";import"./Recipe-226a7e18.js";import"./Vaccine-69f9d8fc.js";import"./Corral-a31b28fc.js";const w=t=>t==="ddl"?[{id:"",label:"ทั้งหมด"},{id:"W",label:"ทำงาน"},{id:"L",label:"เลิกจ้าง"},{id:"S",label:"พัก"}]:{W:"ทำงาน",L:"เลิกจ้าง",S:"พัก"},J={data(){return{worker:{name:"",age:"",duty:"",startDate:new Date,endDate:null,phoneNumber:"",country:"",status:"W",salary:"",remark:"",change:!0},status:w("ddl"),loading:!1,alert:""}},emits:["update:modelValue","cancel","confirm"],computed:{value:{get(){return this.modelValue},set(t){this.$emit("update:modelValue",t)}},user(){return this.$store.state.auth.user}},watch:{data(t){t&&this.mode==="edit"&&(this.worker=t,this.worker.startDate=new Date(t.startDate),this.worker.endDate=t.endDate?new Date(t.endDate):null)}},methods:{clear(){this.worker.name="",this.worker.age="",this.worker.startDate=new Date,this.worker.endDate=null,this.worker.country="",this.worker.phoneNumber="",this.worker.duty="",this.worker.remark="",this.worker.salary="",this.worker.status="W"},confirmCancel(t){this.value=!1,this.$emit(t)},confirm(){this.clear(),this.confirmCancel("confirm")},cancel(){this.clear(),this.confirmCancel("cancel")},async submit(){this.loading=!0,this.alert="";try{this.mode==="create"?await u.create(this.worker)&&(this.loading=!1,this.value=!1,this.confirmCancel("confirm")):await u.update(this.worker._id,this.worker)&&(this.loading=!1,this.value=!1,this.confirmCancel("confirm")),f.fire({icon:"success",title:"บันทึกข้อมูลสำเร็จ"})}catch(t){console.error("Error : ",t),this.loading=!1,this.alert=t.response.data.message,f.fire({icon:"error",title:"บันทึกข้อมูลไม่สำเร็จ"})}}},components:{BaseButton:C,BaseButtons:O,CardBox:S,BaseDivider:x,OverlayLayer:I,FormField:R,FormControl:z,NotificationBar:G,BaseLevel:W,FormCheckRadioPicker:P,BaseIcon:M},props:{modelValue:{type:[String,Number,Boolean],default:null},data:{type:Object,default:null},mode:{type:String,default:""}}},K={class:"grid grid-cols-2 lg:grid-cols-3 gap-5"};function Q(t,a,y,p,e,s){const i=n("FormControl"),d=n("FormField"),h=n("NotificationBar"),_=n("BaseDivider"),m=n("BaseButton"),b=n("BaseButtons"),c=n("CardBox"),B=n("OverlayLayer");return D((g(),k(B,null,{default:r(()=>[D(l(c,{title:"คนงาน "+(this.mode==="create"?"":"(แก้ไข)"),class:"shadow-lg w-full lg:w-1/2 z-50","header-icon":"close",modal:"",form:"",onSubmit:j(s.submit,["prevent"]),onHeaderIconClick:s.cancel},{default:r(()=>[q("div",K,[l(d,{label:"ชื่อ",help:"* ห้ามว่าง"},{default:r(()=>[l(i,{modelValue:e.worker.name,"onUpdate:modelValue":a[0]||(a[0]=o=>e.worker.name=o),icon:"accountEdit",required:""},null,8,["modelValue"])]),_:1}),l(d,{label:"อายุ"},{default:r(()=>[l(i,{modelValue:e.worker.age,"onUpdate:modelValue":a[1]||(a[1]=o=>e.worker.age=o),type:"number",icon:"cardAccountDetails"},null,8,["modelValue"])]),_:1}),l(d,{label:"เบอร์โทรศัพท์"},{default:r(()=>[l(i,{modelValue:e.worker.phoneNumber,"onUpdate:modelValue":a[2]||(a[2]=o=>e.worker.phoneNumber=o),icon:"phone"},null,8,["modelValue"])]),_:1}),l(d,{label:"ประเทศ",help:"* ห้ามว่าง"},{default:r(()=>[l(i,{modelValue:e.worker.country,"onUpdate:modelValue":a[3]||(a[3]=o=>e.worker.country=o),icon:"flag",required:""},null,8,["modelValue"])]),_:1}),l(d,{label:"วันที่เริ่มงาน",help:"* ห้ามว่าง"},{default:r(()=>[l(i,{modelValue:e.worker.startDate,"onUpdate:modelValue":a[4]||(a[4]=o=>e.worker.startDate=o),icon:"calendar",type:"date",required:""},null,8,["modelValue"])]),_:1}),l(d,{label:"วันที่สิ้นสุดงาน"},{default:r(()=>[l(i,{modelValue:e.worker.endDate,"onUpdate:modelValue":a[5]||(a[5]=o=>e.worker.endDate=o),icon:"calendar",type:"date"},null,8,["modelValue"])]),_:1}),l(d,{label:"หน้าที่",help:"* ห้ามว่าง"},{default:r(()=>[l(i,{modelValue:e.worker.duty,"onUpdate:modelValue":a[6]||(a[6]=o=>e.worker.duty=o),icon:"shovel",required:""},null,8,["modelValue"])]),_:1}),l(d,{label:"เงินเดือน",help:"* ห้ามว่าง"},{default:r(()=>[l(i,{modelValue:e.worker.salary,"onUpdate:modelValue":a[7]||(a[7]=o=>e.worker.salary=o),type:"number",icon:"cashMultiple",required:""},null,8,["modelValue"])]),_:1}),l(d,{label:"สถานะ"},{default:r(()=>[l(i,{modelValue:e.worker.status,"onUpdate:modelValue":a[8]||(a[8]=o=>e.worker.status=o),options:e.status},null,8,["modelValue","options"])]),_:1}),l(d,{label:"หมายเหตุ"},{default:r(()=>[l(i,{modelValue:e.worker.remark,"onUpdate:modelValue":a[9]||(a[9]=o=>e.worker.remark=o),type:"textarea"},null,8,["modelValue"])]),_:1})]),e.alert?(g(),k(h,{key:0,color:"danger",outline:"",icon:"alertCircleOutline"},{default:r(()=>[E(H(e.alert),1)]),_:1})):A("",!0),l(_),l(b,{type:"justify-center"},{default:r(()=>[l(m,{label:"บันทึก",color:"success",type:"submit",loading:e.loading},null,8,["loading"]),l(m,{label:"ยกเลิก",color:"danger",onClick:s.cancel},null,8,["onClick"])]),_:1})]),_:1},8,["title","onSubmit","onHeaderIconClick"]),[[V,s.value]])]),_:1},512)),[[V,s.value]])}const X=v(J,[["render",Q]]),Y={data(){return{openModal:!1,modalData:null,items:[],forms:[{label:"สถานะ",value:"status",options:w("ddl")}],search:{status:""},loading:!1,mode:"create",dataEdit:null,checked:{code:{value:"name"},label:{value:"duty"}},datas:[{label:"ชื่อ",value:"name"},{label:"อายุ",class:"text-center",value:"age"},{label:"วันที่เริ่มงาน",class:"text-center",value:"startDate",type:"date"},{label:"วันที่สิ้นสุดงาน",class:"text-center",value:"endDate",type:"date"},{label:"หน้าที่",value:"duty"},{label:"เงินเดือน",value:"salary",class:"text-right"},{label:"เบอร​์โทรศัพท์",class:"text-center",value:"phoneNumber"},{label:"สถานะ",func:t=>w()[t.status]},{label:"ประเทศ",value:"country"},{label:"หมายเหตุ",value:"remark"}],buttons:[{label:"ลบ",type:"delete",color:"danger"},{label:"แก้ไข",type:"edit",color:"warning"},{label:"เงินเดือน",type:"oth",color:"light",func:t=>{this.salary(t)}}]}},components:{SectionMain:N,LayoutAuthenticated:L,SectionTitleBarSub:T,Table:U,Modal:X,Criteria:F},computed:{getDataCopy(){return{...this.modalData}}},created(){this.getDatas()},methods:{async getDatas(t){this.loading=!0;const a=await u.all(t);this.items=[],a.data&&(this.items=a.data.workers),this.loading=!1},async remove(t){this.loading=!0,(await u.delete(t)).data&&this.getDatas(),this.loading=!1,f.fire({icon:"success",title:"ลบข้อมูลสำเร็จ"})},async removeSelected(t){this.loading=!0;let a=[];for(let p of t)a.push(p._id);(await u.deletes(a)).data&&(this.getDatas(),f.fire({icon:"success",title:"ลบข้อมูลสำเร็จ"})),this.loading=!1},salary(t){this.$router.push({name:"salary",params:{id:t._id}})},edit(t){this.modalData=t,this.mode="edit",this.openModal=!0},reset(){this.search.status="",this.getDatas()},resetData(){this.modalData=null}}};function Z(t,a,y,p,e,s){const i=n("SectionTitleBarSub"),d=n("Modal"),h=n("Criteria"),_=n("Table"),m=n("SectionMain"),b=n("LayoutAuthenticated");return g(),k(b,null,{default:r(()=>[l(m,null,{default:r(()=>[l(i,{icon:"accountHardHat",title:"คนงาน","has-btn-add":"",onOpenModal:a[0]||(a[0]=c=>{e.mode="create",e.openModal=!0}),btnText:"เพิ่มคนงาน"}),l(d,{modelValue:e.openModal,"onUpdate:modelValue":a[1]||(a[1]=c=>e.openModal=c),data:s.getDataCopy,mode:e.mode,onConfirm:s.getDatas,onCancel:s.resetData},null,8,["modelValue","data","mode","onConfirm","onCancel"]),l(h,{grid:"grid-cols-2 lg:grid-cols-4",onSearch:s.getDatas,onReset:s.reset,forms:e.forms,search:e.search,btnLoading:e.loading},null,8,["onSearch","onReset","forms","search","btnLoading"]),l(_,{title:"รายการคนงาน","has-checkbox":"","checked-data":e.checked,items:e.items,datas:e.datas,buttons:e.buttons,onEdit:s.edit,onDelete:s.remove,onDeleteSelected:s.removeSelected,loading:e.loading},null,8,["checked-data","items","datas","buttons","onEdit","onDelete","onDeleteSelected","loading"])]),_:1})]),_:1})}const ke=v(Y,[["render",Z]]);export{ke as default};
