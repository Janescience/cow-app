import{b as V,_ as A,d as R}from"./BaseDivider-128ffef2.js";import{a as M,q as F,o as s,c as u,w as b,j as h,G as P,a2 as N,O as T,v as z,h as U,_ as Y,x as H,z as m,s as i,d as C,t as f,F as k,D as y,g as d,n as x,H as B}from"./index-f90e0597.js";import{_ as I}from"./CardBoxModal-c6f30598.js";import{_ as E}from"./UserAvatar-e6276c17.js";import{_ as O}from"./FormControl-6d788e17.js";const q={class:"checkbox"},G=h("span",{class:"check"},null,-1),J={__name:"TableCheckboxCell",props:{type:{type:String,default:"td"},isChecked:{type:Boolean,default:!1}},emits:["checked"],setup(t,{emit:e}){const r=t,o=M(r.isChecked);return F(o,l=>{e("checked",l)}),(l,n)=>(s(),u(T(r.type),{class:"checkbox-cell"},{default:b(()=>[h("label",q,[P(h("input",{"onUpdate:modelValue":n[0]||(n[0]=_=>o.value=_),type:"checkbox"},null,512),[[N,o.value]]),G])]),_:1}))}},K={data(){return{textConfirm:"",modalConfirm:!1,funcConfirm:Function,idConfirm:null,dataSelectedConfirm:[],currentPage:0,checkedRows:[]}},props:{title:{type:String,default:""},items:{type:Array,default:[]},datas:{type:Array,default:[]},buttons:{type:Array,default:[]},hasCheckbox:Boolean,checkedData:{type:Object,default:null},perPage:{type:Number,default:10},icon:{type:String,default:""},noPaging:{type:Boolean,default:!1},loading:Boolean,rounded:{type:String,default:"md:rounded-2xl"}},computed:{itemsPaginated(){return this.items?this.items.slice(this.perPage*this.currentPage,this.perPage*(this.currentPage+1)):[]},numPages(){return Math.ceil((this.items?this.items.length:0)/this.perPage)},currentPageHuman(){return this.currentPage+1},pagesListFirst(){const t=[];if(this.numPages<7)for(let e=0;e<this.numPages;e++)t.push(e);else if(this.currentPage+3>this.numPages-3)for(let e=this.currentPage;e<this.numPages-3;e++)t.push(e);else for(let e=this.currentPage;e<this.currentPage+3;e++)t.push(e);return t},pagesListLast(){const t=[];for(let e=this.numPages-3;e<this.numPages;e++)t.push(e);return t}},components:{BaseButton:V,BaseButtons:U,CardBox:A,CardBoxModal:I,TableCheckboxCell:J,UserAvatar:E,BaseLevel:Y,BaseIcon:R,FormControl:O},methods:{getValue(t,e){const r=this.getPropByString(t,e.value);if(!e.type)return e.func?e.func(t):r;switch(e.type){case"number":return this.formatNumber(r);case"currency":return this.formatCurrency(r);case"date":return this.formatDate(r);case"image":return r;case"icon":return r}},getStyle(t,e){const r=this.getPropByString(t,e.style);switch(e.type){case"icon":return r}},getPropByString(t,e){if(!e)return t;let r,o=e.split(".");for(var l=0,n=o.length-1;l<n;l++){r=o[l];var _=t[r];if(_!==void 0)t=_;else break}return t[o[l]]},btnClick(t,e){switch(t){case"edit":this.edit(e.data);break;case"delete":this.confirm("ยืนยันลบรายการนี้ ใช่หรือไม่ ?",e.id,null,this.removeData(e.data));break;case"detail":this.detail(e.path+"/"+e.id);break}},removeData(t){this.$emit("delete",this.idConfirm?this.idConfirm:t)},removeSelected(){this.$emit("deleteSelected",this.dataSelectedConfirm),this.checkedRows=[]},edit(t){this.$emit("edit",t)},detail(t){this.$router.push(t)},confirm(t,e,r,o){this.textConfirm=t,this.funcConfirm=o,this.idConfirm=e,this.dataSelectedConfirm=r,this.modalConfirm=!0},checked(t,e){t?(e.checked=!0,this.checkedRows.push(e)):(e.checked=!1,this.checkedRows=this.removeArr(this.checkedRows,r=>r._id===e._id))},countChecked(){return this.checkedRows.length>0?"(เลือก "+this.checkedRows.length+" รายการ)":""},removeArr(t,e){const r=[];return t.forEach(o=>{e(o)||r.push(o)}),r},formatDate(t){return t?H(t).format("DD/MM/YYYY"):null},formatNumber(t){return this.$filters.number(t)},formatCurrency(t){return this.$filters.currency(t)}}},Q={key:0,class:"p-3"},W={class:"overflow-x-auto"},X={key:0,class:"text-center whitespace-nowrap"},Z={key:1},j=["data-label"],$=["href"],ee={key:3},te={key:1,class:"lg:w-6 whitespace-nowrap"},re={key:1,class:"p-2 static border-t border-gray-100 dark:border-gray-800 shadow md:rounded-xl"},ae={key:2,class:"text-lg"};function ne(t,e,r,o,l,n){const _=m("CardBoxModal"),g=m("BaseButton"),v=m("BaseButtons"),w=m("TableCheckboxCell"),D=m("UserAvatar"),S=m("BaseIcon"),L=m("BaseLevel"),p=m("CardBox");return s(),i(k,null,[C(_,{modelValue:l.modalConfirm,"onUpdate:modelValue":e[0]||(e[0]=a=>l.modalConfirm=a),title:"ยืนยันอีกครั้ง","button-label":"ยืนยัน",onConfirm:l.funcConfirm,"has-cancel":"","has-button":""},{default:b(()=>[h("p",null,f(l.textConfirm),1)]),_:1},8,["modelValue","onConfirm"]),n.itemsPaginated.length>0?(s(),u(p,{key:0,title:r.title+" "+n.countChecked(),class:"shadow-lg dark:border-gray-800 border","has-table":"",rounded:r.rounded,icon:r.icon,"header-icon":""},{default:b(()=>[l.checkedRows.length>0?(s(),i("div",Q,[(s(!0),i(k,null,y(l.checkedRows,a=>(s(),i("span",{key:a._id,class:"inline-block px-2 py-1 rounded-sm mr-2 text-sm bg-gray-100 dark:bg-gray-700 mb-1"},f((r.checkedData.code?n.getValue(a,r.checkedData.code)+" : ":"")+n.getValue(a,r.checkedData.label)),1))),128)),C(v,{type:"justify-start lg:justify-end","no-wrap":""},{default:b(()=>[C(g,{color:"danger",label:"ลบทั้งหมด",onClick:e[1]||(e[1]=a=>n.confirm("ยืนยันลบรายการที่เลือกทั้งหมด ใช่หรือไม่ ?",null,l.checkedRows,n.removeSelected))})]),_:1})])):d("",!0),h("div",W,[h("table",null,[h("thead",null,[h("tr",null,[r.hasCheckbox?(s(),i("th",X,"เลือก")):d("",!0),(s(!0),i(k,null,y(r.datas,a=>(s(),i("th",{key:a.label,class:"whitespace-nowrap text-center"},f(a.label),1))),128)),r.buttons.length>0?(s(),i("th",Z)):d("",!0)])]),h("tbody",null,[(s(!0),i(k,null,y(n.itemsPaginated,a=>(s(),i("tr",{key:a._id,class:x(a.new?"text-green-300":"")},[r.hasCheckbox?(s(),u(w,{key:0,isChecked:a.checked,class:"text-center border-b-0 lg:w-6 before:hidden",onChecked:c=>n.checked(c,a)},null,8,["isChecked","onChecked"])):d("",!0),(s(!0),i(k,null,y(r.datas,c=>(s(),i("td",{key:c.label,"data-label":c.label,class:x(["whitespace-nowrap",[c.class]])},[c.type==="image"?(s(),u(D,{key:0,avatar:n.getValue(a,c),username:"profile",class:x("mx-auto h-"+c.size+" w-"+c.size)},null,8,["avatar","class"])):c.type==="icon"?(s(),u(S,{key:1,path:n.getValue(a,c),class:x(n.getStyle(a,c)),size:"18"},null,8,["path","class"])):c.link&&c.link=="cowDetail"?(s(),i("a",{key:2,href:"/manage/cow/detail/"+a.cow.id,class:"text-blue-500 underline"},f(n.getValue(a,c)),9,$)):(s(),i("span",ee,f(n.getValue(a,c)),1))],10,j))),128)),r.buttons.length>0?(s(),i("td",te,[C(v,{type:"justify-end lg:justify-start","no-wrap":""},{default:b(()=>[(s(!0),i(k,null,y(r.buttons,c=>P((s(),u(g,{small:"",key:c.label,color:c.color,label:c.label,onClick:se=>c.type==="oth"?c.func(a):n.btnClick(c.type,{data:a,id:a._id,path:c.path})},null,8,["color","label","onClick"])),[[B,c.condition?c.condition(a):!0]])),128))]),_:2},1024)])):d("",!0)],2))),128))])])]),r.noPaging?d("",!0):(s(),i("div",re,[C(L,{class:"md:flex-nowrap flex-wrap",type:"md:justify-between justify-center"},{default:b(()=>[C(v,{classAddon:"mr-2 last:mr-0 mb-3"},{default:b(()=>[n.numPages>6?(s(),u(g,{key:0,icon:"chevronDoubleLeft",teeny:"",class:"p-0 text-xs dark:bg-gray-900 border dark:border-gray-800 border-gray-300 dark:text-gray-500",onClick:e[2]||(e[2]=a=>l.currentPage=0)})):d("",!0),n.numPages>6?(s(),u(g,{key:1,icon:"chevronLeft",teeny:"",class:"p-0 text-xs dark:bg-gray-900 border dark:border-gray-800 border-gray-300 dark:text-gray-500",onClick:e[3]||(e[3]=a=>l.currentPage=l.currentPage>0?l.currentPage-1:l.currentPage)})):d("",!0),(s(!0),i(k,null,y(n.pagesListFirst,a=>P((s(),u(g,{key:a,active:a===l.currentPage,label:a+1,teeny:"",class:"p-0 text-xs dark:bg-gray-900 dark:text-gray-500 border dark:border-gray-800 border-gray-300",onClick:c=>l.currentPage=a},null,8,["active","label","onClick"])),[[B,n.numPages>6?l.currentPage<n.numPages-3:!0]])),128)),n.numPages>6&&l.currentPage<n.numPages-6?(s(),i("p",ae,"...")):d("",!0),(s(!0),i(k,null,y(n.pagesListLast,a=>P((s(),u(g,{key:a,active:a===l.currentPage,label:a+1,teeny:"",class:"p-0 text-xs dark:bg-gray-900 dark:text-gray-500 border dark:border-gray-800 border-gray-300",onClick:c=>l.currentPage=a},null,8,["active","label","onClick"])),[[B,n.numPages>6]])),128)),n.numPages>6?(s(),u(g,{key:3,icon:"chevronRight",teeny:"",class:"p-0 text-xs dark:bg-gray-900 dark:text-gray-500 border dark:border-gray-800 border-gray-300",onClick:e[4]||(e[4]=a=>l.currentPage=l.currentPage==n.numPages-1?l.currentPage:l.currentPage+1)})):d("",!0),n.numPages>6?(s(),u(g,{key:4,icon:"chevronDoubleRight",teeny:"",class:"p-0 text-xs dark:bg-gray-900 border dark:border-gray-800 border-gray-300 dark:text-gray-500",onClick:e[5]||(e[5]=a=>l.currentPage=n.numPages-1)})):d("",!0)]),_:1}),h("small",null,"หน้า "+f(n.currentPageHuman)+" จาก "+f(n.numPages),1)]),_:1})]))]),_:1},8,["title","rounded","icon"])):r.loading?(s(),u(p,{key:1,title:r.title+" "+n.countChecked(),"header-icon":"",icon:r.icon,class:"shadow-lg dark:border-gray-800 border",loading:""},null,8,["title","icon"])):(s(),u(p,{key:2,title:r.title+" "+n.countChecked(),"header-icon":"",icon:r.icon,class:"shadow-lg dark:border-gray-800 border",empty:""},null,8,["title","icon"]))],64)}const de=z(K,[["render",ne]]);export{de as T};
