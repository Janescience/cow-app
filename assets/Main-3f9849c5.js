import{y as h,z as g,S as _,B as b,C as y,c as S,w as i,D as a,o as T,d as o}from"./index-273b3c22.js";import{T as x}from"./Table-6deaa913.js";import{C as v}from"./Criteria-ad5d9f4e.js";import{t as r,s as c,N as C,L as D}from"./notification-f780d0c6.js";import{T as l}from"./alert-7576a7bd.js";import"./FormField-1815475f.js";import"./FormCheckRadioPicker-f02674ee.js";import"./Cow-a971260c.js";import"./cow-99325b1e.js";const M={data(){return{items:[],forms:[{label:"วันที่",value:"createdAt",icon:"calendar",type:"date"},{label:"ประเภท",value:"type",options:r("ddl")},{label:"สถานะ",value:"status",options:c("ddl")}],search:{createdAt:null,type:"",status:""},loading:!1,datas:[{label:"วันที่",class:"text-center",func:t=>g(t.createdAt).format("DD/MM/YYYY HH:mm:ss")},{label:"ประเภท",class:"text-center",func:t=>r()[t.type]},{label:"ข้อความ",class:"text-center",value:"message"},{label:"สถานะ",class:"text-center",func:t=>c()[t.status]}]}},components:{SectionMain:_,LayoutAuthenticated:b,SectionTitleBarSub:y,Table:x,Criteria:v},computed:{user(){return this.$store.state.auth.user}},created(){this.getDatas()},methods:{async getDatas(){this.loading=!0;const t=await C.get(this.search);this.items=[],t.data&&(this.items=t.data.notifications),this.loading=!1},async notify(t){this.loading=!0;try{(await D.notify({message:t,lineToken:this.user.farm.lineToken})).data&&(this.loading=!1,l.fire({icon:"success",title:"แจ้งเตือนสำเร็จ"}),this.getDatas())}catch{this.loading=!1,l.fire({icon:"error",title:"แจ้งเตือนไม่สำเร็จ"})}},reset(){this.search.recipe=null,this.search.corral="",this.getDatas()}}};function A(t,s,B,k,e,n){const u=a("SectionTitleBarSub"),m=a("Criteria"),d=a("Table"),f=a("SectionMain"),p=a("LayoutAuthenticated");return T(),S(p,null,{default:i(()=>[o(f,null,{default:i(()=>[o(u,{icon:"bellCogOutline",title:"ประวัติการแจ้งเตือน","has-btn-add":"","btn-text":"ทดสอบแจ้งเตือน",onOpenModal:s[0]||(s[0]=L=>n.notify("ทดสอบการแจ้งเตือน"))}),o(m,{grid:"grid-cols-2 lg:grid-cols-4",onSearch:n.getDatas,onReset:n.reset,forms:e.forms,search:e.search},null,8,["onSearch","onReset","forms","search"]),o(d,{title:"รายการแจ้งเตือน",items:e.items,datas:e.datas,loading:e.loading},null,8,["items","datas","loading"])]),_:1})]),_:1})}const q=h(M,[["render",A]]);export{q as default};
