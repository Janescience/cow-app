import{a as U,W as L,o as s,c as u,w as f,p as h,H as O,X as R,Y as N,N as P,l as Y,_ as F,f as I,e as H,Z as T,$ as E,Q as d,s as i,b as m,t as k,F as b,G as C,j as p,n as x,a0 as B,O as q,i as Q,k as j,g as z,d as A}from"./index.d9459ccd.js";import{_ as M}from"./BaseButtons.a219570e.js";import{_ as G}from"./CardBoxModal.1507fbc3.js";import{_ as W}from"./FormField.70d11339.js";import{a as w}from"./auth-header.3292437b.js";const X={class:"checkbox"},Z=h("span",{class:"check"},null,-1),$={__name:"TableCheckboxCell",props:{type:{type:String,default:"td"},isChecked:{type:Boolean,default:!1}},emits:["checked"],setup(t,{emit:e}){const a=t,c=U(a.isChecked);return L(c,r=>{e("checked",r)}),(r,n)=>(s(),u(N(a.type),{class:"checkbox-cell"},{default:f(()=>[h("label",X,[O(h("input",{"onUpdate:modelValue":n[0]||(n[0]=_=>c.value=_),type:"checkbox"},null,512),[[R,c.value]]),Z])]),_:1}))}},J={data(){return{textConfirm:"",modalConfirm:!1,funcConfirm:Function,idConfirm:null,dataSelectedConfirm:[],perPage:10,currentPage:0,checkedRows:[],loading:!1}},props:{title:{type:String,default:""},items:{type:Array,default:[]},datas:{type:Array,default:[]},button:{type:Object,default:null},hasCheckbox:Boolean,checkedData:{type:Object,default:null}},computed:{itemsPaginated(){return this.items?this.items.slice(this.perPage*this.currentPage,this.perPage*(this.currentPage+1)):[]},numPages(){return Math.ceil((this.items?this.items.length:0)/this.perPage)},currentPageHuman(){return this.currentPage+1},pagesList(){const t=[];for(let e=0;e<this.numPages;e++)t.push(e);return t}},components:{BaseButton:Y,BaseButtons:M,CardBox:F,CardBoxModal:G,TableCheckboxCell:$,UserAvatar:I,BaseLevel:H},methods:{getValue(t,e){const a=this.getPropByString(t,e.value);if(!e.type)return e.func?e.func(t):a;switch(e.type){case"number":return this.formatCurrency(a);case"date":return this.formatDate(a);case"image":return a}},getPropByString(t,e){if(!e)return t;let a,c=e.split(".");for(var r=0,n=c.length-1;r<n;r++){a=c[r];var _=t[a];if(_!==void 0)t=_;else break}return t[c[r]]},removeData(){this.$emit("delete",this.idConfirm)},removeSelected(){this.$emit("deleteSelected",this.dataSelectedConfirm)},edit(t){this.$emit("edit",t)},detail(t){this.$router.push(t)},confirm(t,e,a,c){this.textConfirm=t,this.funcConfirm=c,this.idConfirm=e,this.dataSelectedConfirm=a,this.modalConfirm=!0},checked(t,e){t?(e.checked=!0,this.checkedRows.push(e)):(e.checked=!1,this.checkedRows=this.removeArr(this.checkedRows,a=>a._id===e._id))},countChecked(){return this.checkedRows.length>0?"(\u0E40\u0E25\u0E37\u0E2D\u0E01 "+this.checkedRows.length+" \u0E23\u0E32\u0E22\u0E01\u0E32\u0E23)":""},removeArr(t,e){const a=[];return t.forEach(c=>{e(c)||a.push(c)}),a},formatDate(t){return t?T(new Date(t)).format("DD/MM/YYYY"):""},formatCurrency(t){return E(t).format(0,0)}}},K={key:0,class:"p-3 bg-gray-100/50 dark:bg-gray-800"},ee={class:"overflow-x-auto"},te={key:0,class:"text-center whitespace-nowrap"},ae=h("th",null,null,-1),le=["data-label"],ne={key:1},se={key:1,class:"lg:w-6 whitespace-nowrap"},re={class:"p-3 lg:px-6 border-t border-gray-100 dark:border-gray-800"};function ce(t,e,a,c,r,n){const _=d("CardBoxModal"),y=d("BaseButton"),g=d("BaseButtons"),V=d("TableCheckboxCell"),D=d("UserAvatar"),S=d("BaseLevel"),v=d("CardBox");return s(),i(b,null,[m(_,{modelValue:r.modalConfirm,"onUpdate:modelValue":e[0]||(e[0]=l=>r.modalConfirm=l),title:"\u0E22\u0E37\u0E19\u0E22\u0E31\u0E19\u0E2D\u0E35\u0E01\u0E04\u0E23\u0E31\u0E49\u0E07","button-label":"\u0E22\u0E37\u0E19\u0E22\u0E31\u0E19",onConfirm:r.funcConfirm,"has-cancel":"","has-button":""},{default:f(()=>[h("p",null,k(r.textConfirm),1)]),_:1},8,["modelValue","onConfirm"]),n.itemsPaginated.length>0?(s(),u(v,{key:0,title:a.title+" "+n.countChecked(),class:"shadow-lg","has-table":"","header-icon":""},{default:f(()=>[r.checkedRows.length>0?(s(),i("div",K,[(s(!0),i(b,null,C(r.checkedRows,l=>(s(),i("span",{key:l._id,class:"inline-block px-2 py-1 rounded-sm mr-2 text-sm bg-gray-100 dark:bg-gray-700 mb-1"},k(n.getValue(l,a.checkedData.code)+" : "+n.getValue(l,a.checkedData.label)),1))),128)),m(g,{type:"justify-start lg:justify-end","no-wrap":""},{default:f(()=>[m(y,{color:"danger",label:"\u0E25\u0E1A\u0E17\u0E31\u0E49\u0E07\u0E2B\u0E21\u0E14",onClick:e[1]||(e[1]=l=>n.confirm("\u0E22\u0E37\u0E19\u0E22\u0E31\u0E19\u0E25\u0E1A\u0E23\u0E32\u0E22\u0E01\u0E32\u0E23\u0E17\u0E35\u0E48\u0E40\u0E25\u0E37\u0E2D\u0E01\u0E17\u0E31\u0E49\u0E07\u0E2B\u0E21\u0E14 \u0E43\u0E0A\u0E48\u0E2B\u0E23\u0E37\u0E2D\u0E44\u0E21\u0E48 ?",null,r.checkedRows,n.removeSelected))})]),_:1})])):p("",!0),h("div",ee,[h("table",null,[h("thead",null,[h("tr",null,[a.hasCheckbox?(s(),i("th",te,"\u0E40\u0E25\u0E37\u0E2D\u0E01")):p("",!0),(s(!0),i(b,null,C(a.datas,l=>(s(),i("th",{key:l.label,class:x(["whitespace-nowrap",[l.class]])},k(l.label),3))),128)),ae])]),h("tbody",null,[(s(!0),i(b,null,C(n.itemsPaginated,l=>(s(),i("tr",{key:l._id},[a.hasCheckbox?(s(),u(V,{key:0,isChecked:l.checked,class:"text-center border-b-0 lg:w-6 before:hidden",onChecked:o=>n.checked(o,l)},null,8,["isChecked","onChecked"])):p("",!0),(s(!0),i(b,null,C(a.datas,o=>(s(),i("td",{key:o.label,"data-label":o.label,class:x(["whitespace-nowrap",[o.class]])},[o.type==="image"?(s(),u(D,{key:0,avatar:n.getValue(l,o),class:"w-36 mx-auto lg:h-20 lg:w-20"},null,8,["avatar"])):(s(),i("span",ne,k(n.getValue(l,o)),1))],10,le))),128)),a.button?(s(),i("td",se,[m(g,{type:"justify-end lg:justify-start","no-wrap":""},{default:f(()=>[a.button.delete?(s(),u(y,{key:0,color:"danger",label:"\u0E25\u0E1A",onClick:o=>n.confirm("\u0E22\u0E37\u0E19\u0E22\u0E31\u0E19\u0E25\u0E1A\u0E23\u0E32\u0E22\u0E01\u0E32\u0E23\u0E19\u0E35\u0E49 \u0E43\u0E0A\u0E48\u0E2B\u0E23\u0E37\u0E2D\u0E44\u0E21\u0E48 ?",l._id,null,n.removeData)},null,8,["onClick"])):p("",!0),a.button.edit?(s(),u(y,{key:1,color:"warning",label:"\u0E41\u0E01\u0E49\u0E44\u0E02",onClick:o=>n.edit(l)},null,8,["onClick"])):p("",!0),a.button.detail?(s(),u(y,{key:2,color:"info",label:"\u0E23\u0E32\u0E22\u0E25\u0E30\u0E40\u0E2D\u0E35\u0E22\u0E14",onClick:o=>n.detail(a.button.detail.path+"/"+l._id)},null,8,["onClick"])):p("",!0)]),_:2},1024)])):p("",!0)]))),128))])])]),h("div",re,[m(S,null,{default:f(()=>[m(g,null,{default:f(()=>[(s(!0),i(b,null,C(n.pagesList,l=>(s(),u(y,{key:l,active:l===r.currentPage,label:l+1,small:"",onClick:o=>r.currentPage=l},null,8,["active","label","onClick"]))),128))]),_:1}),h("small",null,"\u0E2B\u0E19\u0E49\u0E32 "+k(n.currentPageHuman)+" \u0E08\u0E32\u0E01 "+k(n.numPages),1)]),_:1})])]),_:1},8,["title"])):r.loading?(s(),u(v,{key:1,loading:""})):(s(),u(v,{key:2,empty:""}))],64)}var Be=P(J,[["render",ce]]);async function oe(t={}){let e="?";if(t.farm&&(e=e+`farm=${t.farm}&`),t.flag&&(e=e+`flag=${t.flag}&`),t.code&&(e=e+`code=${t.code}&`),t.name&&(e=e+`name=${t.name}&`),t.status&&(e=e+`status=${t.status}&`),t.birthDate){const a=T(new Date(t.birthDate)).format("YYYY-MM-DD");e=e+`birthDate=${a}&`}return t.corral&&(e=e+`corral=${t.corral}&`),t?e.replace(/&*$/,""):""}class ie{async all(e){const a=await oe(e);return B.get("/cow"+a,{headers:w()}).then(c=>c)}get(e){return B.get(`/cow/${e}`,{headers:w()})}create(e){return e.birthDate&&(e.birthDate=T(new Date(e.birthDate)).format("YYYY-MM-DD")),B.post("/cow",e,{headers:w()})}delete(e){return B.delete(`/cow/${e}`,{headers:w()})}update(e,a){return B.put(`/cow/${e}`,a,{headers:w()})}}var de=new ie;const ue={data(){return{datas:[]}},created(){this.initialData()},computed:{value:{get(){return this.modelValue},set(t){this.$emit("update:modelValue",t)}}},methods:{async initialData(){const t={farm:q().farm._id};try{const e=await de.all(t);if(this.datas=[],e&&(this.datas=e.data.cows,this.datas.map(a=>a.cow_data=a.code+" : "+a.name)),this.defaultValue){const a=this.datas.filter(c=>c[this.defaultType]==this.defaultValue);a&&this.handleInput(this.reduceAction(a[0]))}}catch(e){this.datas=[],console.error("Error: "+e.message)}},reduceAction(t){return this.valueType==="object"?t:t[this.valueType]},handleInput(t){this.$emit("update:value",t),this.dataSelected=this.datas.find(e=>e.cde===t||e.name===t),this.$emit("update:dataSelected",this.dataSelected)}},props:{clear:{default:!0,type:Boolean},disabled:{default:!1,type:Boolean},dataSelected:{default:null,type:Object},defaultType:{default:null,type:Object},valueType:{default:"_id",type:Object},defaultValue:{default:null,type:Object},modelValue:{type:[String,Number,Boolean,Array,Object],default:""}}},he={class:"relative"},me=Q(" \u0E44\u0E21\u0E48\u0E1E\u0E1A\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25 ");function fe(t,e,a,c,r,n){const _=d("mdicon"),y=d("v-select");return s(),i("div",he,[m(y,{class:"ddl",clearable:a.clear,disabled:a.disabled,options:r.datas,reduce:n.reduceAction,label:"cow_data",placeholder:"\u0E40\u0E25\u0E37\u0E2D\u0E01\u0E42\u0E04",onInput:n.handleInput,modelValue:n.value,"onUpdate:modelValue":e[0]||(e[0]=g=>n.value=g),dataSelected:a.dataSelected},{"no-options":f(()=>[m(_,{name:"alertCircleOutline",width:"16",height:"16",class:"inline-block"}),me]),_:1},8,["clearable","disabled","options","reduce","onInput","modelValue","dataSelected"])])}var _e=P(ue,[["render",fe]]);const ye={props:{title:{type:String,default:""},grid:{type:String,default:"grid-cols-4"},forms:{type:Array,default:[]},search:{type:Object,default:null}},components:{BaseButton:Y,BaseButtons:M,BaseDivider:j,CardBox:F,FormField:W,FormControl:z,DDLCow:_e},methods:{submit(){this.$emit("search",this.search)},reset(){this.$emit("reset",this.search)}}};function ge(t,e,a,c,r,n){const _=d("DDLCow"),y=d("FormControl"),g=d("FormField"),V=d("BaseDivider"),D=d("BaseButton"),S=d("BaseButtons"),v=d("CardBox");return s(),u(v,{title:a.title,icon:"",form:"",class:"mb-3","header-icon":"",onSubmit:A(n.submit,["prevent"]),onReset:A(n.reset,["prevent"])},{default:f(()=>[h("div",{class:x(["grid gap-5",[a.grid]])},[(s(!0),i(b,null,C(a.forms,l=>(s(),u(g,{key:l.value,label:l.label,class:x([l.class])},{default:f(()=>[l.type==="ddl"&&l.module==="cow"?(s(),u(_,{key:0,modelValue:a.search[l.value],"onUpdate:modelValue":o=>a.search[l.value]=o,valueType:l.valueType},null,8,["modelValue","onUpdate:modelValue","valueType"])):(s(),u(y,{key:1,modelValue:a.search[l.value],"onUpdate:modelValue":o=>a.search[l.value]=o,icon:l.icon,options:l.options,type:l.type},null,8,["modelValue","onUpdate:modelValue","icon","options","type"]))]),_:2},1032,["label","class"]))),128))],2),m(V),m(S,{type:"justify-center","no-wrap":""},{default:f(()=>[m(D,{type:"submit",color:"info",label:"\u0E04\u0E49\u0E19\u0E2B\u0E32"}),m(D,{type:"reset",color:"danger",label:"\u0E25\u0E49\u0E32\u0E07"})]),_:1})]),_:1},8,["title","onSubmit","onReset"])}var we=P(ye,[["render",ge]]);export{de as C,_e as D,Be as T,we as a};
