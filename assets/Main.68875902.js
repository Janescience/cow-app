import{h as u,$ as h,N as V,O as w,a2 as M,y as k,k as Y,x as T,R as q,p as F,q as L,_ as U,U as O,Q as n,H as B,T as N,o as y,i as D,w as l,b as o,d as E,e as H,t as P,v as R,l as A,S as I,P as j,V as Q}from"./index.a37edb95.js";import{T as z,a as G}from"./Criteria.e7a2f5fd.js";import{_ as J}from"./BaseButtons.048c6afb.js";import{_ as K,a as W}from"./FormField.c2711203.js";import{D as X}from"./Vaccine.e5814b36.js";import{T as x}from"./alert.f4e30098.js";import{a as m}from"./auth-header.ced71286.js";import"./CardBoxModal.fb7be500.js";async function Z(t={}){let e="?";if(t.farm&&(e=e+`farm=${t.farm}&`),t.dateCurrent){const i=h(new Date(t.dateCurrent)).format("YYYY-MM-DD");e=e+`dateCurrent=${i}&`}if(t.dateNext){const i=h(new Date(t.dateNext)).format("YYYY-MM-DD");e=e+`dateNext=${i}&`}return t.vaccine&&(e=e+`vaccine=${t.vaccine}&`),t?e.replace(/&*$/,""):""}class ${async all(e){const i=await Z(e);return u.get("/protection"+i,{headers:m()}).then(v=>v)}get(e){return u.get(`/protection/${e}`,{headers:m()})}create(e){return e.dateCurrent&&(e.dateCurrent=h(new Date(e.dateCurrent)).format("YYYY-MM-DD")),e.dateNext&&(e.dateNext=h(new Date(e.dateNext)).format("YYYY-MM-DD")),u.post("/protection",e,{headers:m()})}delete(e){return u.delete(`/protection/${e}`,{headers:m()})}update(e,i){return u.put(`/protection/${e}`,i,{headers:m()})}}var _=new $;const ee={data(){return{protection:{dateCurrent:new Date,dateNext:null,vaccine:"",frequency:null,remark:"",farm:w().farm._id},loading:!1,alert:""}},emits:["update:modelValue","cancel","confirm"],computed:{value:{get(){return this.modelValue},set(t){this.$emit("update:modelValue",t)}}},watch:{data(t){t&&this.mode==="edit"&&(this.protection=t,this.protection.dateCurrent=new Date(t.dateCurrent),this.protection.dateNext=new Date(t.dateNext))},"protection.frequency"(t){t&&(this.protection.dateNext=M(new Date(this.protection.dateCurrent),t))}},methods:{clear(){this.protection.dateCurrent=new Date,this.protection.dateNext=null,this.protection.vaccine="",this.protection.frequency="",this.protection.remark=""},confirmCancel(t){this.value=!1,this.$emit(t)},confirm(){this.clear(),this.confirmCancel("confirm")},cancel(){this.clear(),this.confirmCancel("cancel")},async submit(){this.loading=!0,this.alert="";try{this.mode==="create"?await _.create(this.protection)&&(this.loading=!1,this.value=!1,this.confirmCancel("confirm")):await _.update(this.protection._id,this.protection)&&(this.loading=!1,this.value=!1,this.confirmCancel("confirm")),x.fire({icon:"success",title:"\u0E1A\u0E31\u0E19\u0E17\u0E36\u0E01\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25\u0E2A\u0E33\u0E40\u0E23\u0E47\u0E08"})}catch(t){console.error("Error : ",t),this.clear(),this.loading=!1,this.alert=await t.response.data.message,x.fire({icon:"error",title:"\u0E1A\u0E31\u0E19\u0E17\u0E36\u0E01\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25\u0E44\u0E21\u0E48\u0E2A\u0E33\u0E40\u0E23\u0E47\u0E08"})}}},components:{BaseButton:k,BaseButtons:J,CardBox:Y,BaseDivider:T,OverlayLayer:q,FormField:K,FormControl:F,NotificationBar:L,BaseLevel:U,DDLVaccine:X,FormCheckRadioPicker:W,BaseIcon:O},props:{modelValue:{type:[String,Number,Boolean],default:null},data:{type:Object,default:null},mode:{type:String,default:""}}},te={class:"grid grid-cols-1 lg:grid-cols-3 gap-8"};function ae(t,e,i,v,a,r){const s=n("FormControl"),d=n("FormField"),g=n("NotificationBar"),C=n("BaseDivider"),f=n("BaseButton"),b=n("BaseButtons"),p=n("CardBox"),S=n("OverlayLayer");return B((y(),D(S,null,{default:l(()=>[B(o(p,{title:(this.mode==="create"?"\u0E1A\u0E31\u0E19\u0E17\u0E36\u0E01":"\u0E41\u0E01\u0E49\u0E44\u0E02")+"\u0E01\u0E32\u0E23\u0E1B\u0E49\u0E2D\u0E07\u0E01\u0E31\u0E19/\u0E1A\u0E33\u0E23\u0E38\u0E07",class:"shadow-lg w-full overflow-y-auto lg:w-1/2 z-50","header-icon":"close",modal:"",form:"",onSubmit:A(r.submit,["prevent"]),onHeaderIconClick:r.cancel},{default:l(()=>[E("div",te,[o(d,{label:"\u0E27\u0E31\u0E04\u0E0B\u0E35\u0E19",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:l(()=>[o(s,{modelValue:a.protection.vaccine,"onUpdate:modelValue":e[0]||(e[0]=c=>a.protection.vaccine=c),icon:"needle",required:""},null,8,["modelValue"])]),_:1}),o(d,{label:"\u0E04\u0E27\u0E32\u0E21\u0E16\u0E35\u0E48/\u0E27\u0E31\u0E04\u0E0B\u0E35\u0E19 (\u0E40\u0E14\u0E37\u0E2D\u0E19)",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:l(()=>[o(s,{modelValue:a.protection.frequency,"onUpdate:modelValue":e[1]||(e[1]=c=>a.protection.frequency=c),icon:"calendarClock",type:"number",required:""},null,8,["modelValue"])]),_:1}),o(d,{label:"\u0E09\u0E35\u0E14\u0E27\u0E31\u0E04\u0E0B\u0E35\u0E19\u0E25\u0E48\u0E32\u0E2A\u0E38\u0E14",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:l(()=>[o(s,{modelValue:a.protection.dateCurrent,"onUpdate:modelValue":e[2]||(e[2]=c=>a.protection.dateCurrent=c),icon:"calendar",type:"date",required:""},null,8,["modelValue"])]),_:1}),o(d,{label:"\u0E09\u0E35\u0E14\u0E27\u0E31\u0E04\u0E0B\u0E35\u0E19\u0E04\u0E23\u0E31\u0E49\u0E07\u0E15\u0E48\u0E2D\u0E44\u0E1B",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:l(()=>[o(s,{modelValue:a.protection.dateNext,"onUpdate:modelValue":e[3]||(e[3]=c=>a.protection.dateNext=c),icon:"calendar",type:"date",required:""},null,8,["modelValue"])]),_:1}),o(d,{label:"\u0E2B\u0E21\u0E32\u0E22\u0E40\u0E2B\u0E15\u0E38"},{default:l(()=>[o(s,{modelValue:a.protection.remark,"onUpdate:modelValue":e[4]||(e[4]=c=>a.protection.remark=c),type:"textarea"},null,8,["modelValue"])]),_:1})]),a.alert?(y(),D(g,{key:0,color:"danger",outline:"",icon:"alertCircleOutline"},{default:l(()=>[H(P(a.alert),1)]),_:1})):R("",!0),o(C),o(b,{type:"justify-center"},{default:l(()=>[o(f,{label:"\u0E1A\u0E31\u0E19\u0E17\u0E36\u0E01",color:"success",type:"submit",loading:a.loading},null,8,["loading"]),o(f,{label:"\u0E22\u0E01\u0E40\u0E25\u0E34\u0E01",color:"danger",onClick:r.cancel},null,8,["onClick"])]),_:1})]),_:1},8,["title","onSubmit","onHeaderIconClick"]),[[N,r.value]])]),_:1},512)),[[N,r.value]])}var oe=V(ee,[["render",ae]]);const ne={data(){return{openModal:!1,modalData:null,items:[],forms:[{label:"\u0E27\u0E31\u0E04\u0E0B\u0E35\u0E19",value:"vaccine",icon:"needle"},{label:"\u0E09\u0E35\u0E14\u0E27\u0E31\u0E04\u0E0B\u0E35\u0E19\u0E25\u0E48\u0E32\u0E2A\u0E38\u0E14",value:"dateCurrent",icon:"calendar",type:"date"},{label:"\u0E09\u0E35\u0E14\u0E27\u0E31\u0E04\u0E0B\u0E35\u0E19\u0E04\u0E23\u0E31\u0E49\u0E07\u0E15\u0E48\u0E2D\u0E44\u0E1B",value:"dateNext",icon:"calendar",type:"date"}],search:{dateCurrent:null,dateNext:null,vaccine:"",farm:w().farm._id},loading:!1,mode:"create",dataEdit:null,checked:{label:{value:"vaccine"}},datas:[{label:"\u0E27\u0E31\u0E04\u0E0B\u0E35\u0E19",class:"text-center",value:"vaccine"},{label:"\u0E04\u0E27\u0E32\u0E21\u0E16\u0E35\u0E48/\u0E27\u0E31\u0E04\u0E0B\u0E35\u0E19 (\u0E40\u0E14\u0E37\u0E2D\u0E19)",class:"text-center",value:"frequency"},{label:"\u0E09\u0E35\u0E14\u0E27\u0E31\u0E04\u0E0B\u0E35\u0E19\u0E25\u0E48\u0E32\u0E2A\u0E38\u0E14",class:"text-center",value:"dateCurrent",type:"date"},{label:"\u0E09\u0E35\u0E14\u0E27\u0E31\u0E04\u0E0B\u0E35\u0E19\u0E04\u0E23\u0E31\u0E49\u0E07\u0E15\u0E48\u0E2D\u0E44\u0E1B",class:"text-center",value:"dateNext",type:"date"},{label:"\u0E2B\u0E21\u0E32\u0E22\u0E40\u0E2B\u0E15\u0E38",class:"text-center",value:"remark"}],buttons:[{label:"\u0E25\u0E1A",type:"delete",color:"danger"},{label:"\u0E41\u0E01\u0E49\u0E44\u0E02",type:"edit",color:"warning"}]}},components:{SectionMain:I,LayoutAuthenticated:j,SectionTitleBarSub:Q,Table:z,Modal:oe,Criteria:G},created(){this.getDatas()},methods:{async getDatas(t){this.loading=!0;const e=await _.all(t);this.items=[],e.data&&(this.items=e.data.protections),this.loading=!1},async remove(t){this.loading=!0,(await _.delete(t)).data&&this.getDatas(),this.loading=!1,x.fire({icon:"success",title:"\u0E25\u0E1A\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25\u0E2A\u0E33\u0E40\u0E23\u0E47\u0E08"})},edit(t){this.modalData=t,this.mode="edit",this.openModal=!0},reset(){this.search.dateCurrent=null,this.search.dateNext=null,this.search.vaccine=""}}};function re(t,e,i,v,a,r){const s=n("SectionTitleBarSub"),d=n("Modal"),g=n("Criteria"),C=n("Table"),f=n("SectionMain"),b=n("LayoutAuthenticated");return y(),D(b,null,{default:l(()=>[o(f,null,{default:l(()=>[o(s,{icon:"doctor",title:"\u0E01\u0E32\u0E23\u0E1B\u0E49\u0E2D\u0E07\u0E01\u0E31\u0E19/\u0E1A\u0E33\u0E23\u0E38\u0E07","has-btn-add":"",onOpenModal:e[0]||(e[0]=p=>{a.mode="create",a.openModal=!0}),btnText:"\u0E40\u0E1E\u0E34\u0E48\u0E21\u0E01\u0E32\u0E23\u0E1B\u0E49\u0E2D\u0E07\u0E01\u0E31\u0E19/\u0E1A\u0E33\u0E23\u0E38\u0E07"}),o(d,{modelValue:a.openModal,"onUpdate:modelValue":e[1]||(e[1]=p=>a.openModal=p),data:a.modalData,mode:a.mode,onConfirm:r.getDatas,onCancel:r.getDatas},null,8,["modelValue","data","mode","onConfirm","onCancel"]),o(g,{grid:"grid-cols-2 lg:grid-cols-4",onSearch:r.getDatas,onReset:r.reset,forms:a.forms,search:a.search},null,8,["onSearch","onReset","forms","search"]),o(C,{title:"\u0E23\u0E32\u0E22\u0E01\u0E32\u0E23\u0E1B\u0E49\u0E2D\u0E07\u0E01\u0E31\u0E19/\u0E1A\u0E33\u0E23\u0E38\u0E07","has-checkbox":"","checked-data":a.checked,items:a.items,datas:a.datas,buttons:a.buttons,onEdit:r.edit,onDelete:r.remove,onDeleteSelected:t.removeSelected,loading:a.loading},null,8,["checked-data","items","datas","buttons","onEdit","onDelete","onDeleteSelected","loading"])]),_:1})]),_:1})}var pe=V(ne,[["render",re]]);export{pe as default};
