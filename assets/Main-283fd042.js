import{y as h,z as b,B as g,S as _,C as S,D as y,c as T,w as o,E as s,o as v,d as i}from"./index-29b3fa17.js";import{T as x}from"./Table-e4257c05.js";import{C as B}from"./Criteria-1d5dab72.js";import{N as C}from"./notification-7cab9a01.js";import{T as r}from"./alert-d203e791.js";import"./FormField-6448e018.js";import"./FormCheckRadioPicker-eb74b3b9.js";import"./Cow-e4209c40.js";import"./cow-9109c21e.js";import"./Vaccine-13de54fd.js";const D="/line";class M{notify(e){return h.post(D+"/notify",e)}}const A=new M,l=t=>t=="ddl"?[{id:"",label:"ทั้งหมด"},{id:"S",label:"สำเร็จ"},{id:"F",label:"ไม่สำเร็จ"}]:{S:"สำเร็จ",F:"ไม่สำเร็จ"},c=t=>t=="ddl"?[{id:"",label:"ทั้งหมด"},{id:"B",label:"ระบบ(ตามเงื่อนไข)"},{id:"T",label:"ทดสอบจากผู้ใช้"},{id:"S",label:"ระบบ(อัตโนมัติ)"}]:{B:"ระบบ(ตามเงื่อนไข)",T:"ทดสอบจากผู้ใช้",S:"ระบบ(อัตโนมัติ)"},L={data(){return{items:[],forms:[{label:"วันที่",value:"createdAt",icon:"calendar",type:"date"},{label:"ประเภท",value:"type",options:c("ddl")},{label:"สถานะ",value:"status",options:l("ddl")}],search:{createdAt:null,type:"",status:""},loading:!1,datas:[{label:"วันที่",class:"text-center",func:t=>g(t.createdAt).format("DD/MM/YYYY HH:mm:ss")},{label:"ประเภท",class:"text-center",func:t=>c()[t.type]},{label:"ข้อความ",class:"text-center",value:"message"},{label:"สถานะ",class:"text-center",func:t=>l()[t.status]}]}},components:{SectionMain:_,LayoutAuthenticated:S,SectionTitleBarSub:y,Table:x,Criteria:B},computed:{user(){return this.$store.state.auth.user}},created(){this.getDatas()},methods:{async getDatas(){this.loading=!0;const t=await C.getLogs(this.search);this.items=[],t.data&&(this.items=t.data.notifications),this.loading=!1},async notify(t){this.loading=!0;try{(await A.notify({message:t,lineToken:this.user.farm.lineToken})).data&&(this.loading=!1,r.fire({icon:"success",title:"แจ้งเตือนสำเร็จ"}),this.getDatas())}catch{this.loading=!1,r.fire({icon:"error",title:"แจ้งเตือนไม่สำเร็จ"})}},reset(){this.search.recipe=null,this.search.corral="",this.getDatas()}}};function k(t,e,w,Y,a,n){const d=s("SectionTitleBarSub"),u=s("Criteria"),m=s("Table"),f=s("SectionMain"),p=s("LayoutAuthenticated");return v(),T(p,null,{default:o(()=>[i(f,null,{default:o(()=>[i(d,{icon:"bellCogOutline",title:"ประวัติการแจ้งเตือน","has-btn-add":"","btn-text":"ทดสอบแจ้งเตือน",onOpenModal:e[0]||(e[0]=N=>n.notify("ทดสอบการแจ้งเตือน"))}),i(u,{grid:"grid-cols-2 lg:grid-cols-4",onSearch:n.getDatas,onReset:n.reset,forms:a.forms,search:a.search},null,8,["onSearch","onReset","forms","search"]),i(m,{title:"รายการแจ้งเตือน",items:a.items,datas:a.datas,loading:a.loading},null,8,["items","datas","loading"])]),_:1})]),_:1})}const G=b(L,[["render",k]]);export{G as default};
