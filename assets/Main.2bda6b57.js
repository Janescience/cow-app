import{N as p,O as q,P as M,a2 as T,l as F,_ as U,k as L,T as O,g as E,h as R,e as H,V as A,R as n,H as S,U as x,o as _,c as w,w as i,b as l,p as r,s as k,G as I,t as f,F as Q,i as z,j as G,d as P,S as W,Q as J,W as K}from"./index.f97125be.js";import{T as X,a as Y}from"./Criteria.d4833eac.js";import{_ as Z}from"./BaseButtons.07ee3b28.js";import{_ as j}from"./FormField.df2dd74a.js";import{D as $}from"./Vaccine.91ea82d4.js";import{T as C}from"./alert.47f2d01b.js";import{a as h}from"./auth-header.84d021ee.js";import"./CardBoxModal.af42791d.js";async function ee(t={}){let e="?";return t.farm&&(e=e+`farm=${t.farm}&`),t.type&&(e=e+`type=${t.type}&`),t.recipe&&(e=e+`recipe=${t.recipe}&`),t?e.replace(/&*$/,""):""}class te{async all(e){const u=await ee(e);return p.get("/recipe"+u,{headers:h()}).then(V=>V)}get(e){return p.get(`/recipe/${e}`,{headers:h()})}create(e){return p.post("/recipe",e,{headers:h()})}delete(e){return p.delete(`/recipe/${e}`,{headers:h()})}update(e,u){return p.put(`/recipe/${e}`,u,{headers:h()})}}var v=new te;const B=t=>t==="create"?[{id:1,label:"\u0E2B\u0E22\u0E32\u0E1A"},{id:2,label:"\u0E1C\u0E2A\u0E21\u0E40\u0E2D\u0E07"},{id:3,label:"\u0E2A\u0E33\u0E40\u0E23\u0E47\u0E08\u0E23\u0E39\u0E1B"}]:[{id:"",label:"\u0E17\u0E31\u0E49\u0E07\u0E2B\u0E21\u0E14"},{id:1,label:"\u0E2B\u0E22\u0E32\u0E1A"},{id:2,label:"\u0E1C\u0E2A\u0E21\u0E40\u0E2D\u0E07"},{id:3,label:"\u0E2A\u0E33\u0E40\u0E23\u0E47\u0E08\u0E23\u0E39\u0E1B"}],ae={data(){return{recipe:{code:"",name:"",type:1,amount:"",farm:M().farm._id},recipeDetail:{},recipeDetails:[],type:B("create"),loading:!1,alert:""}},emits:["update:modelValue","cancel","confirm"],computed:{value:{get(){return this.modelValue},set(t){this.$emit("update:modelValue",t)}}},watch:{data(t){t&&this.mode==="edit"&&(this.recipe=t,this.recipe.dateCurrent=new Date(t.dateCurrent),this.recipe.dateNext=new Date(t.dateNext))},"recipe.frequency"(t){t&&(this.recipe.dateNext=T(new Date(this.recipe.dateCurrent),t))}},methods:{clear(){this.recipe.dateCurrent=new Date,this.recipe.dateNext=null,this.recipe.vaccine="",this.recipe.frequency="",this.recipe.remark=""},confirmCancel(t){this.value=!1,this.$emit(t)},confirm(){this.clear(),this.confirmCancel("confirm")},cancel(){this.clear(),this.confirmCancel("cancel")},async submit(){this.loading=!0,this.alert="";try{this.mode==="create"?await v.create(this.recipe)&&(this.loading=!1,this.value=!1,this.confirmCancel("confirm")):await v.update(this.recipe._id,this.recipe)&&(this.loading=!1,this.value=!1,this.confirmCancel("confirm")),C.fire({icon:"success",title:"\u0E1A\u0E31\u0E19\u0E17\u0E36\u0E01\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25\u0E2A\u0E33\u0E40\u0E23\u0E47\u0E08"})}catch(t){console.error("Error : ",t),this.clear(),this.loading=!1,this.alert=await t.response.data.message,C.fire({icon:"error",title:"\u0E1A\u0E31\u0E19\u0E17\u0E36\u0E01\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25\u0E44\u0E21\u0E48\u0E2A\u0E33\u0E40\u0E23\u0E47\u0E08"})}}},components:{BaseButton:F,BaseButtons:Z,CardBox:U,BaseDivider:L,OverlayLayer:O,FormField:j,FormControl:E,NotificationBar:R,BaseLevel:H,DDLVaccine:$,BaseIcon:A},props:{modelValue:{type:[String,Number,Boolean],default:null},data:{type:Object,default:null},mode:{type:String,default:""}}},le={class:"grid grid-cols-2 lg:grid-cols-4 gap-5"},oe={class:"grid grid-cols-2 lg:grid-cols-6 gap-5"},re={class:"overflow-x-auto"},ie=r("thead",null,[r("tr",null,[r("th",{class:"whitespace-nowrap"}," \u0E2D\u0E32\u0E2B\u0E32\u0E23/\u0E27\u0E31\u0E15\u0E16\u0E38\u0E14\u0E34\u0E1A "),r("th",{class:"whitespace-nowrap"}," \u0E23\u0E32\u0E04\u0E32/\u0E01\u0E01. "),r("th",{class:"whitespace-nowrap"}," \u0E08\u0E33\u0E19\u0E27\u0E19\u0E17\u0E35\u0E48\u0E43\u0E0A\u0E49/\u0E01\u0E01. "),r("th",{class:"whitespace-nowrap"}," \u0E08\u0E33\u0E19\u0E27\u0E19\u0E40\u0E07\u0E34\u0E19 "),r("th")])],-1),ne={"data-label":"\u0E2D\u0E32\u0E2B\u0E32\u0E23/\u0E27\u0E31\u0E15\u0E16\u0E38\u0E14\u0E34\u0E1A",class:"text-center"},se={"data-label":"\u0E23\u0E32\u0E04\u0E32/\u0E01\u0E01.",class:"text-center"},ce={"data-label":"\u0E08\u0E33\u0E19\u0E27\u0E19\u0E17\u0E35\u0E48\u0E43\u0E0A\u0E49/\u0E01\u0E01.",class:"text-center"},de={"data-label":"\u0E08\u0E33\u0E19\u0E27\u0E19\u0E40\u0E07\u0E34\u0E19",class:"text-center"},ue={class:"lg:w-6 whitespace-nowrap"};function me(t,e,u,V,a,s){const c=n("FormControl"),d=n("FormField"),m=n("BaseButton"),g=n("BaseButtons"),b=n("CardBox"),D=n("NotificationBar"),y=n("BaseDivider"),N=n("OverlayLayer");return S((_(),w(N,null,{default:i(()=>[S(l(b,{title:(this.mode==="create"?"\u0E1A\u0E31\u0E19\u0E17\u0E36\u0E01":"\u0E41\u0E01\u0E49\u0E44\u0E02")+"\u0E2A\u0E39\u0E15\u0E23\u0E2D\u0E32\u0E2B\u0E32\u0E23",class:"shadow-lg w-full overflow-y-auto lg:w-2/3 z-50","header-icon":"close",modal:"",form:"",onSubmit:P(s.submit,["prevent"]),onHeaderIconClick:s.cancel},{default:i(()=>[r("div",le,[l(d,{label:"\u0E23\u0E2B\u0E31\u0E2A\u0E2A\u0E39\u0E15\u0E23",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:i(()=>[l(c,{modelValue:a.recipe.code,"onUpdate:modelValue":e[0]||(e[0]=o=>a.recipe.code=o),icon:"vaccine",required:""},null,8,["modelValue"])]),_:1}),l(d,{label:"\u0E0A\u0E37\u0E48\u0E2D\u0E2A\u0E39\u0E15\u0E23",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:i(()=>[l(c,{modelValue:a.recipe.name,"onUpdate:modelValue":e[1]||(e[1]=o=>a.recipe.name=o),icon:"time",required:""},null,8,["modelValue"])]),_:1}),l(d,{label:"\u0E1B\u0E23\u0E30\u0E40\u0E20\u0E17\u0E2D\u0E32\u0E2B\u0E32\u0E23",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:i(()=>[l(c,{modelValue:a.recipe.type,"onUpdate:modelValue":e[2]||(e[2]=o=>a.recipe.type=o),options:a.type,required:""},null,8,["modelValue","options"])]),_:1}),l(d,{label:"\u0E15\u0E49\u0E19\u0E17\u0E38\u0E19\u0E23\u0E27\u0E21/\u0E01\u0E01."},{default:i(()=>[l(c,{modelValue:a.recipe.amount,"onUpdate:modelValue":e[3]||(e[3]=o=>a.recipe.amount=o),icon:"cash",type:"number",disabled:"",required:""},null,8,["modelValue"])]),_:1})]),l(b,{title:"\u0E23\u0E32\u0E22\u0E25\u0E30\u0E40\u0E2D\u0E35\u0E22\u0E14\u0E2A\u0E39\u0E15\u0E23\u0E2D\u0E32\u0E2B\u0E32\u0E23",class:"shadow-lg","has-table":"","header-icon":""},{default:i(()=>[r("div",oe,[l(d,{label:"\u0E2D\u0E32\u0E2B\u0E32\u0E23/\u0E27\u0E31\u0E15\u0E16\u0E38\u0E14\u0E34\u0E1A",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07",class:"col-span-2"},{default:i(()=>[l(c,{modelValue:a.recipeDetail.food,"onUpdate:modelValue":e[4]||(e[4]=o=>a.recipeDetail.food=o),icon:"food",required:""},null,8,["modelValue"])]),_:1}),l(d,{label:"\u0E23\u0E32\u0E04\u0E32/\u0E01\u0E01",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:i(()=>[l(c,{modelValue:a.recipeDetail.cost,"onUpdate:modelValue":e[5]||(e[5]=o=>a.recipeDetail.cost=o),icon:"time",type:"number",required:""},null,8,["modelValue"])]),_:1}),l(d,{label:"\u0E08\u0E33\u0E19\u0E27\u0E19\u0E17\u0E35\u0E48\u0E43\u0E0A\u0E49/\u0E01\u0E01",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:i(()=>[l(c,{modelValue:a.recipeDetail.qty,"onUpdate:modelValue":e[6]||(e[6]=o=>a.recipeDetail.qty=o),required:""},null,8,["modelValue"])]),_:1}),l(d,{label:"\u0E08\u0E33\u0E19\u0E27\u0E19\u0E40\u0E07\u0E34\u0E19"},{default:i(()=>[l(c,{modelValue:a.recipeDetail.amount,"onUpdate:modelValue":e[7]||(e[7]=o=>a.recipeDetail.amount=o),icon:"cash",type:"number",disabled:"",required:""},null,8,["modelValue"])]),_:1})]),r("div",re,[r("table",null,[ie,r("tbody",null,[(_(!0),k(Q,null,I(a.recipeDetails,o=>(_(),k("tr",{key:o.food},[r("td",ne,f(o.food),1),r("td",se,f(o.cost),1),r("td",ce,f(o.qty),1),r("td",de,f(o.amount),1),r("td",ue,[l(g,{type:"justify-end lg:justify-start","no-wrap":""},{default:i(()=>[l(m,{color:"danger",label:"\u0E25\u0E1A",onClick:_e=>t.remove(o.food)},null,8,["onClick"])]),_:2},1024)])]))),128))])])])]),_:1}),a.alert?(_(),w(D,{key:0,color:"danger",outline:"",icon:"alertCircleOutline"},{default:i(()=>[z(f(a.alert),1)]),_:1})):G("",!0),l(y),l(g,{type:"justify-center"},{default:i(()=>[l(m,{label:"\u0E1A\u0E31\u0E19\u0E17\u0E36\u0E01",color:"success",type:"submit",loading:a.loading},null,8,["loading"]),l(m,{label:"\u0E22\u0E01\u0E40\u0E25\u0E34\u0E01",color:"danger",onClick:s.cancel},null,8,["onClick"])]),_:1})]),_:1},8,["title","onSubmit","onHeaderIconClick"]),[[x,s.value]])]),_:1},512)),[[x,s.value]])}var pe=q(ae,[["render",me]]);const fe={data(){return{openModal:!1,modalData:null,items:[],forms:[{label:"\u0E2A\u0E39\u0E15\u0E23\u0E2D\u0E32\u0E2B\u0E32\u0E23",value:"recipe",icon:"recipe"},{label:"\u0E1B\u0E23\u0E30\u0E40\u0E20\u0E17",value:"type",options:B()}],search:{recipe:"",type:"",farm:M().farm._id},loading:!1,mode:"create",dataEdit:null,checked:{code:{value:"code"},label:{value:"name"}},datas:[{label:"\u0E2A\u0E39\u0E15\u0E23\u0E2D\u0E32\u0E2B\u0E32\u0E23",class:"text-center",func:t=>t.code+" : "+t.name},{label:"\u0E1B\u0E23\u0E30\u0E40\u0E20\u0E17",class:"text-center",func:t=>B()[t.type].label},{label:"\u0E15\u0E49\u0E19\u0E17\u0E38\u0E19/\u0E01\u0E01.",class:"text-center",value:"amount"}],buttons:[{label:"\u0E25\u0E1A",type:"delete",color:"danger"},{label:"\u0E41\u0E01\u0E49\u0E44\u0E02",type:"edit",color:"warning"}]}},components:{SectionMain:W,LayoutAuthenticated:J,SectionTitleBarSub:K,Table:X,Modal:pe,Criteria:Y},created(){this.getDatas()},methods:{async getDatas(t){this.loading=!0;const e=await v.all(t);this.items=[],e.data&&(this.items=e.data.recipes),this.loading=!1},async remove(t){this.loading=!0,(await v.delete(t)).data&&this.getDatas(),this.loading=!1,C.fire({icon:"success",title:"\u0E25\u0E1A\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25\u0E2A\u0E33\u0E40\u0E23\u0E47\u0E08"})},edit(t){this.modalData=t,this.mode="edit",this.openModal=!0},reset(){this.search.recipe="",this.search.type="",this.getDatas()}}};function he(t,e,u,V,a,s){const c=n("SectionTitleBarSub"),d=n("Modal"),m=n("Criteria"),g=n("Table"),b=n("SectionMain"),D=n("LayoutAuthenticated");return _(),w(D,null,{default:i(()=>[l(b,null,{default:i(()=>[l(c,{icon:"calculatorVariantOutline",title:"\u0E2A\u0E39\u0E15\u0E23\u0E2D\u0E32\u0E2B\u0E32\u0E23","has-btn-add":"",onOpenModal:e[0]||(e[0]=y=>{a.mode="create",a.openModal=!0}),btnText:"\u0E40\u0E1E\u0E34\u0E48\u0E21\u0E2A\u0E39\u0E15\u0E23\u0E2D\u0E32\u0E2B\u0E32\u0E23"}),l(d,{modelValue:a.openModal,"onUpdate:modelValue":e[1]||(e[1]=y=>a.openModal=y),data:a.modalData,mode:a.mode,onConfirm:s.getDatas,onCancel:s.getDatas},null,8,["modelValue","data","mode","onConfirm","onCancel"]),l(m,{grid:"grid-cols-2 lg:grid-cols-4",onSearch:s.getDatas,onReset:s.reset,forms:a.forms,search:a.search},null,8,["onSearch","onReset","forms","search"]),l(g,{title:"\u0E23\u0E32\u0E22\u0E01\u0E32\u0E23\u0E2A\u0E39\u0E15\u0E23\u0E2D\u0E32\u0E2B\u0E32\u0E23","has-checkbox":"","checked-data":a.checked,items:a.items,datas:a.datas,buttons:a.buttons,onEdit:s.edit,onDelete:s.remove,onDeleteSelected:t.removeSelected,loading:a.loading},null,8,["checked-data","items","datas","buttons","onEdit","onDelete","onDeleteSelected","loading"])]),_:1})]),_:1})}var Be=q(fe,[["render",he]]);export{Be as default};
