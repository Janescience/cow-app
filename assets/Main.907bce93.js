import{a0 as _,Z as M,N,a1 as p,O as Y,l as q,_ as A,k as R,R as I,g as W,h as E,e as H,U as P,Q as n,H as S,T as F,o as h,c as m,w as i,b as l,p as z,i as w,t as d,j as g,d as Q,S as j,P as Z,V as G}from"./index.5194e190.js";import{D as J,T as K,a as X}from"./Criteria.843b878b.js";import{_ as $}from"./BaseButtons.9b9a7825.js";import{_ as ee,a as te}from"./FormField.e3031c32.js";import{g as L}from"./age-calculate.285cb1f6.js";import{a as D}from"./auth-header.c682e10a.js";import"./CardBoxModal.f68b447b.js";async function ae(e={}){let t="?";if(e.farm&&(t=t+`farm=${e.farm}&`),e.cow&&(t=t+`cow=${e.cow}&`),e.date){const o=M(new Date(e.date)).format("YYYY-MM-DD");t=t+`date=${o}&`}return e.sex&&(t=t+`sex=${e.sex}&`),e?t.replace(/&*$/,""):""}class le{async all(t){const o=await ae(t);return _.get("/birth"+o,{headers:D()}).then(C=>C)}get(t){return _.get(`/birth/${t}`,{headers:D()})}create(t,o){return o.birthDate&&(o.birthDate=M(new Date(o.birthDate)).format("YYYY-MM-DD")),_.post(`/birth/${t}`,o,{headers:D()})}delete(t){return _.delete(`/birth/${t}`,{headers:D()})}update(t,o){return _.put(`/birth/${t}`,o,{headers:D()})}}var B=new le;const re={data(){return{birth:{sex:"F",overgrown:"N",birthDate:new Date,placentaDrugDate:p(new Date,15),uterusWashDate:p(new Date,29),newCow:{name:"",mom:"",farm:Y().farm._id}},show:{cow:null,seq:""},loading:!1,alert:""}},emits:["update:modelValue","cancel","confirm"],computed:{value:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}}},watch:{data(e){var t;e&&(this.show=e,this.birth.newCow.mom=e.cow.code,this.birth.newCow.name=(t=e.calf)==null?void 0:t.name,this.mode==="edit"&&(this.birth.birthDate=new Date(e.birthDate)))},"birth.date"(e){this.birth.placentaDrugDate=p(e,15)},"birth.placentaDrugDate"(e){this.birth.uterusWashDate=p(e,14)}},methods:{clear(){this.birth.sex="F",this.birth.overgrown="N",this.birth.newCow.name="",this.birth.birthDate=new Date,this.birth.placentaDrugDate=p(new Date,15),this.birth.uterusWashDate=p(new Date,14)},confirmCancel(e){this.value=!1,this.$emit(e)},confirm(){this.clear(),this.confirmCancel("confirm")},cancel(){this.clear(),this.confirmCancel("cancel")},async submit(){this.loading=!0,this.alert="";try{this.mode==="create"?await B.create(this.show._id,this.birth)&&(this.loading=!1,this.value=!1,this.confirmCancel("confirm")):await B.update(this.show._id,this.birth)&&(this.loading=!1,this.value=!1,this.confirmCancel("confirm"))}catch(e){console.error("Error : ",e),this.loading=!1,this.alert=e.response.data.message}},calAge(e){return L(e)}},components:{BaseButton:q,BaseButtons:$,CardBox:A,BaseDivider:R,OverlayLayer:I,FormField:ee,FormControl:W,NotificationBar:E,BaseLevel:H,DDLCow:J,FormCheckRadioPicker:te,BaseIcon:P},props:{modelValue:{type:[String,Number,Boolean],default:null},data:{type:Object,default:null},mode:{type:String,default:""}}},oe={class:"grid grid-cols-1 lg:grid-cols-3 gap-8"};function ne(e,t,o,C,a,s){const y=n("BaseIcon"),f=n("BaseLevel"),b=n("FormControl"),c=n("FormField"),v=n("FormCheckRadioPicker"),x=n("NotificationBar"),V=n("BaseDivider"),k=n("BaseButton"),T=n("BaseButtons"),O=n("CardBox"),U=n("OverlayLayer");return S((h(),m(U,null,{default:i(()=>[S(l(O,{title:(this.mode==="create"?"\u0E1A\u0E31\u0E19\u0E17\u0E36\u0E01":"\u0E41\u0E01\u0E49\u0E44\u0E02")+"\u0E01\u0E32\u0E23\u0E04\u0E25\u0E2D\u0E14\u0E25\u0E39\u0E01",class:"shadow-lg w-full overflow-y-auto lg:w-1/2 z-50","header-icon":"close",modal:"",form:"",onSubmit:Q(s.submit,["prevent"]),onHeaderIconClick:s.cancel},{default:i(()=>[z("div",oe,[l(f,{type:"justify-start"},{default:i(()=>{var r,u;return[l(y,{path:"cow",size:"24",class:"mr-3"}),w(" \u0E41\u0E21\u0E48\u0E1E\u0E31\u0E19\u0E18\u0E4C "+d((r=a.show.cow)==null?void 0:r.code)+" : "+d((u=a.show.cow)==null?void 0:u.name),1)]}),_:1}),l(f,{type:"justify-start"},{default:i(()=>{var r,u;return[w(" \u0E01\u0E32\u0E23\u0E2A\u0E37\u0E1A\u0E1E\u0E31\u0E19\u0E18\u0E38\u0E4C\u0E04\u0E23\u0E31\u0E49\u0E07\u0E17\u0E35\u0E48 : "+d((u=(r=a.show)==null?void 0:r.reproduction)==null?void 0:u.seq),1)]}),_:1}),l(f,{type:"justify-start"},{default:i(()=>{var r;return[w(" \u0E2D\u0E32\u0E22\u0E38\u0E04\u0E23\u0E23\u0E20\u0E4C : "+d(s.calAge((r=a.show)==null?void 0:r.pregnantDate,a.show.birthDate)),1)]}),_:1}),l(c,{label:"\u0E27\u0E31\u0E19\u0E17\u0E35\u0E48\u0E04\u0E25\u0E2D\u0E14",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:i(()=>[l(b,{modelValue:a.birth.birthDate,"onUpdate:modelValue":t[0]||(t[0]=r=>a.birth.birthDate=r),icon:"calendar",type:"date",required:""},null,8,["modelValue"])]),_:1}),l(c,{label:"\u0E40\u0E1E\u0E28",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:i(()=>[l(v,{modelValue:a.birth.sex,"onUpdate:modelValue":t[1]||(t[1]=r=>a.birth.sex=r),type:"radio",options:{M:"\u0E40\u0E1E\u0E28\u0E1C\u0E39\u0E49",F:"\u0E40\u0E1E\u0E28\u0E40\u0E21\u0E35\u0E22"}},null,8,["modelValue"])]),_:1}),o.mode==="edit"?(h(),m(f,{key:0,type:"justify-start"},{default:i(()=>{var r,u;return[l(y,{path:"babyFaceOutline",size:"24",class:"mr-3"}),w(" \u0E25\u0E39\u0E01\u0E27\u0E31\u0E27 "+d((r=a.show.calf)==null?void 0:r.code)+" : "+d((u=a.show.calf)==null?void 0:u.name),1)]}),_:1})):g("",!0),a.birth.sex=="F"&&o.mode==="create"?(h(),m(c,{key:1,label:"\u0E0A\u0E37\u0E48\u0E2D\u0E25\u0E39\u0E01\u0E27\u0E31\u0E27",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:i(()=>[l(b,{modelValue:a.birth.newCow.name,"onUpdate:modelValue":t[2]||(t[2]=r=>a.birth.newCow.name=r),icon:"babyFaceOutline",required:""},null,8,["modelValue"])]),_:1})):g("",!0),l(c,{label:"\u0E23\u0E01",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:i(()=>[l(v,{modelValue:a.birth.overgrown,"onUpdate:modelValue":t[3]||(t[3]=r=>a.birth.overgrown=r),type:"radio",options:{Y:"\u0E04\u0E49\u0E32\u0E07",N:"\u0E44\u0E21\u0E48\u0E04\u0E49\u0E32\u0E07"}},null,8,["modelValue"])]),_:1}),a.birth.overgrown==="Y"?(h(),m(c,{key:2,label:"\u0E27\u0E31\u0E19\u0E17\u0E35\u0E48\u0E43\u0E0A\u0E49\u0E22\u0E32\u0E02\u0E31\u0E1A",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07 (\u0E27\u0E31\u0E19\u0E17\u0E35\u0E48\u0E04\u0E25\u0E2D\u0E14 + 15 \u0E27\u0E31\u0E19)"},{default:i(()=>[l(b,{modelValue:a.birth.placentaDrugDate,"onUpdate:modelValue":t[4]||(t[4]=r=>a.birth.placentaDrugDate=r),icon:"calendar",type:"date","lower-limit":a.birth.date},null,8,["modelValue","lower-limit"])]),_:1})):g("",!0),a.birth.overgrown==="Y"?(h(),m(c,{key:3,label:"\u0E27\u0E31\u0E19\u0E17\u0E35\u0E48\u0E25\u0E49\u0E32\u0E07\u0E21\u0E14\u0E25\u0E39\u0E01",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07 (\u0E27\u0E31\u0E19\u0E17\u0E35\u0E48\u0E43\u0E0A\u0E49\u0E22\u0E32\u0E02\u0E31\u0E1A + 14 \u0E27\u0E31\u0E19)"},{default:i(()=>[l(b,{modelValue:a.birth.uterusWashDate,"onUpdate:modelValue":t[5]||(t[5]=r=>a.birth.uterusWashDate=r),icon:"calendar",type:"date","lower-limit":a.birth.placentaDrugDate},null,8,["modelValue","lower-limit"])]),_:1})):g("",!0)]),a.alert?(h(),m(x,{key:0,color:"danger",outline:"",icon:"alertCircleOutline"},{default:i(()=>[w(d(a.alert),1)]),_:1})):g("",!0),l(V),l(T,{type:"justify-center"},{default:i(()=>[l(k,{label:"\u0E1A\u0E31\u0E19\u0E17\u0E36\u0E01",color:"success",type:"submit",loading:a.loading},null,8,["loading"]),l(k,{label:"\u0E22\u0E01\u0E40\u0E25\u0E34\u0E01",color:"danger",onClick:s.cancel},null,8,["onClick"])]),_:1})]),_:1},8,["title","onSubmit","onHeaderIconClick"]),[[F,s.value]])]),_:1},512)),[[F,s.value]])}var ie=N(re,[["render",ne]]);const se=()=>({M:"\u0E40\u0E1E\u0E28\u0E1C\u0E39\u0E49",F:"\u0E40\u0E1E\u0E28\u0E40\u0E21\u0E35\u0E22"}),ce=()=>({Y:"\u0E04\u0E49\u0E32\u0E07",N:"\u0E44\u0E21\u0E48\u0E04\u0E49\u0E32\u0E07"}),ue={data(){return{openModal:!1,birthData:null,items:[],forms:[{label:"\u0E42\u0E04",value:"cow",type:"ddl",module:"cow"},{label:"\u0E40\u0E1E\u0E28",value:"sex",options:[{id:"",label:"\u0E17\u0E31\u0E49\u0E07\u0E2B\u0E21\u0E14"},{id:"M",label:"\u0E15\u0E31\u0E27\u0E1C\u0E39\u0E49"},{id:"F",label:"\u0E15\u0E31\u0E27\u0E40\u0E21\u0E35\u0E22"}]},{label:"\u0E27\u0E31\u0E19\u0E17\u0E35\u0E48\u0E04\u0E25\u0E2D\u0E14",value:"date",icon:"calendar",type:"date"}],search:{cow:null,date:null,sex:"",farm:Y().farm._id},loading:!1,mode:"create",dataEdit:null,checked:{code:{value:"seq"},label:{value:"cow.name"}},datas:[{label:"\u0E04\u0E23\u0E31\u0E49\u0E07\u0E17\u0E35\u0E48",value:"seq",class:"text-center"},{label:"\u0E23\u0E2B\u0E31\u0E2A\u0E42\u0E04",value:"cow.code"},{label:"\u0E0A\u0E37\u0E48\u0E2D\u0E42\u0E04",value:"cow.name"},{label:"\u0E27\u0E31\u0E19\u0E17\u0E35\u0E48\u0E15\u0E31\u0E49\u0E07\u0E04\u0E23\u0E23\u0E20\u0E4C",class:"text-center",value:"pregnantDate",type:"date"},{label:"\u0E2D\u0E32\u0E22\u0E38\u0E04\u0E23\u0E23\u0E20\u0E4C",func:e=>this.calAge(e==null?void 0:e.pregnantDate)},{label:"\u0E27\u0E31\u0E19\u0E17\u0E35\u0E48\u0E04\u0E25\u0E2D\u0E14",class:"text-center",value:"birthDate",type:"date"},{label:"\u0E40\u0E1E\u0E28",class:"text-center",func:e=>se()[e.sex]},{label:"\u0E25\u0E39\u0E01\u0E27\u0E31\u0E27",class:"text-center",func:e=>{var t,o;return e.calf?((t=e.calf)==null?void 0:t.code)+" : "+((o=e.calf)==null?void 0:o.name):""}},{label:"\u0E23\u0E01\u0E04\u0E49\u0E32\u0E07",class:"text-center",func:e=>ce()[e.overgrown]},{label:"\u0E27\u0E31\u0E19\u0E17\u0E35\u0E48\u0E43\u0E0A\u0E49\u0E22\u0E32\u0E02\u0E31\u0E1A",class:"text-center",value:"drugDate",type:"date"},{label:"\u0E27\u0E31\u0E19\u0E17\u0E35\u0E48\u0E25\u0E49\u0E32\u0E07\u0E21\u0E14\u0E25\u0E39\u0E01",class:"text-center",value:"washDate",type:"date"}],buttons:[{label:"\u0E25\u0E1A",type:"delete",color:"danger",condition:e=>!e.birthDate},{label:"\u0E41\u0E01\u0E49\u0E44\u0E02",type:"edit",color:"warning",condition:e=>e.birthDate},{label:"\u0E1A\u0E31\u0E19\u0E17\u0E36\u0E01\u0E01\u0E32\u0E23\u0E04\u0E25\u0E2D\u0E14\u0E25\u0E39\u0E01",color:"info",type:"oth",func:e=>{this.mode="create",this.openModal=!0,this.birthData=e},condition:e=>!e.birthDate}]}},components:{SectionMain:j,LayoutAuthenticated:Z,SectionTitleBarSub:G,Table:K,Modal:ie,Criteria:X},created(){this.getDatas()},methods:{async getDatas(e){this.loading=!0;const t=await B.all(e);this.items=[],t.data&&(this.items=t.data.births),this.loading=!1},async remove(e){this.loading=!0,(await B.delete(e)).data&&this.getDatas(),this.loading=!1},edit(e){this.birthData=e,this.mode="edit",this.openModal=!0},reset(){this.search.cow=null,this.search.date=null,this.search.sex=null},calAge(e){return L(e)}}};function de(e,t,o,C,a,s){const y=n("SectionTitleBarSub"),f=n("Modal"),b=n("Criteria"),c=n("Table"),v=n("SectionMain"),x=n("LayoutAuthenticated");return h(),m(x,null,{default:i(()=>[l(v,null,{default:i(()=>[l(y,{icon:"babyFaceOutline",title:"\u0E01\u0E32\u0E23\u0E04\u0E25\u0E2D\u0E14\u0E25\u0E39\u0E01"}),l(f,{modelValue:a.openModal,"onUpdate:modelValue":t[0]||(t[0]=V=>a.openModal=V),data:a.birthData,mode:a.mode,onConfirm:s.getDatas},null,8,["modelValue","data","mode","onConfirm"]),l(b,{grid:"grid-cols-2 lg:grid-cols-4",onSearch:s.getDatas,onReset:s.reset,forms:a.forms,search:a.search},null,8,["onSearch","onReset","forms","search"]),l(c,{title:"\u0E23\u0E32\u0E22\u0E01\u0E32\u0E23\u0E04\u0E25\u0E2D\u0E14\u0E25\u0E39\u0E01","has-checkbox":"","checked-data":a.checked,items:a.items,datas:a.datas,buttons:a.buttons,onEdit:s.edit,onDelete:s.remove,onDeleteSelected:e.removeSelected,loading:a.loading},null,8,["checked-data","items","datas","buttons","onEdit","onDelete","onDeleteSelected","loading"])]),_:1})]),_:1})}var ge=N(ue,[["render",de]]);export{ge as default};
