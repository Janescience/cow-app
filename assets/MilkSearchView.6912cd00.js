import{N as w,l as M,_ as S,k as D,R as Q,g as x,h as E,e as L,Q as n,H as g,T as b,o as _,c as k,w as i,b as a,p as T,i as F,t as N,j as U,d as A,S as O,P as H,V as R}from"./index.f7691b8e.js";import{D as v,T as j,a as I}from"./Criteria.3da13a2c.js";import{_ as q}from"./BaseButtons.c3d0341f.js";import{_ as z}from"./FormField.e8483ac0.js";import{M as u}from"./milking.c689e9d4.js";import"./CardBoxModal.d154ab7a.js";import"./auth-header.df4f3205.js";const P={data(){return{milk:{cow:null,date:new Date,morningQty:0,afternoonQty:0,amount:0},loading:!1,alert:""}},emits:["update:modelValue","cancel","confirm"],computed:{sumQty(){return this.milk.morningQty+this.milk.afternoonQty},calAmount(){return this.milk.amount=(this.milk.morningQty+this.milk.afternoonQty)*100,this.milk.amount},value:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}}},watch:{dataEdit:{handler(e,l){e!=null&&this.mode=="edit"&&(this.milk=e,this.milk.date=new Date(e.date))},deep:!0}},methods:{clear(){var e;this.mode==="edit"&&this.$emit("update:dataEdit",null),this.milk.cow=null,this.milk.date=new Date,this.milk.morningQty=0,this.milk.afternoonQty=0,this.milk.amount=0,(e=this.milk)==null||delete e._id},confirmCancel(e){this.value=!1,this.$emit(e)},confirm(){this.clear(),this.confirmCancel("confirm")},cancel(){this.clear(),this.confirmCancel("cancel")},async submit(){this.loading=!0,this.alert="";try{this.mode==="create"?await u.create(this.milk)&&(this.loading=!1,this.value=!1,this.confirmCancel("confirm")):await u.update(this.milk._id,this.milk)&&(this.loading=!1,this.value=!1,this.confirmCancel("confirm"))}catch(e){console.error("Error : ",e),this.loading=!1,this.alert=e.response.data.message}}},components:{BaseButton:M,BaseButtons:q,CardBox:S,BaseDivider:D,OverlayLayer:Q,FormField:z,FormControl:x,NotificationBar:E,BaseLevel:L,DDLCow:v},props:{modelValue:{type:[String,Number,Boolean],default:null},mode:{type:String,default:""},dataEdit:{type:Object,default:null}}},W={class:"grid grid-cols-1 lg:grid-cols-2 gap-3 mt-1"};function G(e,l,y,V,t,o){const m=n("FormControl"),r=n("FormField"),f=n("DDLCow"),h=n("NotificationBar"),p=n("BaseDivider"),d=n("BaseButton"),c=n("BaseButtons"),B=n("CardBox"),C=n("OverlayLayer");return g((_(),k(C,null,{default:i(()=>[g(a(B,{title:y.mode==="create"?"\u0E40\u0E1E\u0E34\u0E48\u0E21\u0E01\u0E32\u0E23\u0E23\u0E35\u0E14\u0E19\u0E21":"\u0E41\u0E01\u0E49\u0E44\u0E02\u0E01\u0E32\u0E23\u0E23\u0E35\u0E14\u0E19\u0E21",class:"shadow-lg w-full overflow-y-auto lg:w-1/3 z-50","header-icon":"close",modal:"",form:"",onSubmit:A(o.submit,["prevent"]),onHeaderIconClick:o.cancel},{default:i(()=>[T("div",W,[a(r,{label:"\u0E27\u0E31\u0E19\u0E17\u0E35\u0E48\u0E23\u0E35\u0E14\u0E19\u0E21",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:i(()=>[a(m,{modelValue:t.milk.date,"onUpdate:modelValue":l[0]||(l[0]=s=>t.milk.date=s),icon:"calendar",type:"date",required:""},null,8,["modelValue"])]),_:1}),a(r,{label:"\u0E42\u0E04",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:i(()=>[a(f,{modelValue:t.milk.cow,"onUpdate:modelValue":l[1]||(l[1]=s=>t.milk.cow=s)},null,8,["modelValue"])]),_:1}),a(r,{label:"\u0E1B\u0E23\u0E34\u0E21\u0E32\u0E13\u0E19\u0E49\u0E33\u0E19\u0E21/\u0E40\u0E0A\u0E49\u0E32",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:i(()=>[a(m,{modelValue:t.milk.morningQty,"onUpdate:modelValue":l[2]||(l[2]=s=>t.milk.morningQty=s),type:"number",icon:"weatherSunsetUp"},null,8,["modelValue"])]),_:1}),a(r,{label:"\u0E1B\u0E23\u0E34\u0E21\u0E32\u0E13\u0E19\u0E49\u0E33\u0E19\u0E21/\u0E1A\u0E48\u0E32\u0E22",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:i(()=>[a(m,{modelValue:t.milk.afternoonQty,"onUpdate:modelValue":l[3]||(l[3]=s=>t.milk.afternoonQty=s),type:"number",icon:"weatherSunsetDown"},null,8,["modelValue"])]),_:1}),a(r,{label:"\u0E1B\u0E23\u0E34\u0E21\u0E32\u0E13\u0E19\u0E49\u0E33\u0E19\u0E21\u0E23\u0E27\u0E21",help:"\u0E04\u0E33\u0E19\u0E27\u0E13\u0E2D\u0E31\u0E15\u0E42\u0E19\u0E21\u0E31\u0E15\u0E34"},{default:i(()=>[a(m,{modelValue:o.sumQty,"onUpdate:modelValue":l[4]||(l[4]=s=>o.sumQty=s),type:"number",disabled:"",icon:"water"},null,8,["modelValue"])]),_:1}),a(r,{label:"\u0E08\u0E33\u0E19\u0E27\u0E19\u0E40\u0E07\u0E34\u0E19\u0E23\u0E27\u0E21",help:"\u0E04\u0E33\u0E19\u0E27\u0E13\u0E2D\u0E31\u0E15\u0E42\u0E19\u0E21\u0E31\u0E15\u0E34 (\u0E23\u0E32\u0E04\u0E32\u0E19\u0E21/\u0E01\u0E01. = 100.00)"},{default:i(()=>[a(m,{modelValue:o.calAmount,"onUpdate:modelValue":l[5]||(l[5]=s=>o.calAmount=s),type:"number",icon:"cashMultiple"},null,8,["modelValue"])]),_:1})]),t.alert?(_(),k(h,{key:0,color:"danger",outline:"",icon:"alertCircleOutline"},{default:i(()=>[F(N(t.alert),1)]),_:1})):U("",!0),a(p),a(c,{type:"justify-center"},{default:i(()=>[a(d,{label:"\u0E1A\u0E31\u0E19\u0E17\u0E36\u0E01",color:"success",type:"submit",loading:t.loading},null,8,["loading"]),a(d,{label:"\u0E22\u0E01\u0E40\u0E25\u0E34\u0E01",color:"danger",onClick:o.cancel},null,8,["onClick"])]),_:1})]),_:1},8,["title","onSubmit","onHeaderIconClick"]),[[b,o.value]])]),_:1},512)),[[b,o.value]])}var J=w(P,[["render",G]]);const K={data(){return{modalMilk:!1,items:[],forms:[{label:"\u0E42\u0E04",class:"lg:col-start-2",value:"cow",type:"ddl",module:"cow"},{label:"\u0E27\u0E31\u0E19\u0E17\u0E35\u0E48\u0E23\u0E35\u0E14\u0E19\u0E21",value:"date",icon:"calendar",type:"date"}],search:{cow:null,date:null},loading:!1,mode:"create",dataEdit:null,checked:{code:{value:"date",type:"date"},label:{value:"cow.name"}},datas:[{label:"\u0E27\u0E31\u0E19\u0E17\u0E35\u0E48\u0E23\u0E35\u0E14\u0E19\u0E21",class:"text-center",type:"date",value:"date"},{label:"\u0E42\u0E04",class:"text-center",value:"cow.name"},{label:"\u0E1B\u0E23\u0E34\u0E21\u0E32\u0E13\u0E19\u0E49\u0E33\u0E19\u0E21\u0E14\u0E34\u0E1A/\u0E40\u0E0A\u0E49\u0E32 (\u0E01\u0E01.)",class:"text-center",value:"morningQty"},{label:"\u0E1B\u0E23\u0E34\u0E21\u0E32\u0E13\u0E19\u0E49\u0E33\u0E19\u0E21\u0E14\u0E34\u0E1A/\u0E1A\u0E48\u0E32\u0E22 (\u0E01\u0E01.)",class:"text-center",value:"afternoonQty"},{label:"\u0E1B\u0E23\u0E34\u0E21\u0E32\u0E13\u0E19\u0E49\u0E33\u0E19\u0E21\u0E14\u0E34\u0E1A\u0E23\u0E27\u0E21 (\u0E01\u0E01.)",class:"text-center",func:e=>e.morningQty+e.afternoonQty},{label:"\u0E08\u0E33\u0E19\u0E27\u0E19\u0E40\u0E07\u0E34\u0E19\u0E23\u0E27\u0E21",class:"text-right",type:"number",value:"amount"}],button:{edit:!0,delete:!0}}},components:{SectionMain:O,LayoutAuthenticated:H,Table:j,SectionTitleBarSub:R,DDLCow:v,MilkModal:J,Criteria:I},created(){this.getMilks()},methods:{async getMilks(e){this.loading=!0;const l=await u.all(e);this.items=[],l.data&&(this.items=l.data.milkings),this.loading=!1},async removeMilk(e){this.loading=!0,(await u.delete(e)).data&&this.getMilks(),this.loading=!1},edit(e){this.dataEdit=e,this.dataEdit.cow=e.cow._id,this.mode="edit",this.modalMilk=!0},reset(){this.search.cow=null,this.search.date=null}}};function X(e,l,y,V,t,o){const m=n("SectionTitleBarSub"),r=n("MilkModal"),f=n("Criteria"),h=n("Table"),p=n("SectionMain"),d=n("LayoutAuthenticated");return _(),k(d,null,{default:i(()=>[a(p,null,{default:i(()=>[a(m,{icon:"cupWater",title:"\u0E01\u0E32\u0E23\u0E23\u0E35\u0E14\u0E19\u0E21",btnText:"\u0E40\u0E1E\u0E34\u0E48\u0E21\u0E01\u0E32\u0E23\u0E23\u0E35\u0E14\u0E19\u0E21","has-btn-add":"",onOpenModal:l[0]||(l[0]=c=>{t.mode="create",t.modalMilk=!0})}),a(r,{modelValue:t.modalMilk,"onUpdate:modelValue":l[1]||(l[1]=c=>t.modalMilk=c),mode:t.mode,dataEdit:t.dataEdit,onConfirm:o.getMilks,onCancel:o.getMilks},null,8,["modelValue","mode","dataEdit","onConfirm","onCancel"]),a(f,{grid:"grid-cols-2 lg:grid-cols-4",onSearch:o.getMilks,onReset:o.reset,forms:t.forms,search:t.search},null,8,["onSearch","onReset","forms","search"]),a(h,{title:"\u0E23\u0E32\u0E22\u0E01\u0E32\u0E23\u0E23\u0E35\u0E14\u0E19\u0E21","has-checkbox":"","checked-data":t.checked,items:t.items,datas:t.datas,button:t.button,onEdit:o.edit,onDelete:o.removeMilk,onDeleteSelected:e.removeSelected},null,8,["checked-data","items","datas","button","onEdit","onDelete","onDeleteSelected"])]),_:1})]),_:1})}var oe=w(K,[["render",X]]);export{oe as default};
