import{K as M,a9 as E,p as N,m as O,_ as T,l as F,$ as L,i as U,j as W,f as R,X as A,N as c,P as k,W as S,o as p,c as D,w as o,d as i,s,h as C,t as h,k as x,x as v,U as I,V as H,e as Q,S as j,L as z,M as K}from"./index.664144a8.js";import{T as P}from"./Table.9b7e182c.js";import{R as w,C as X}from"./Criteria.90e0d8f0.js";import{_ as G}from"./FormField.8bbe3c5b.js";import{T as V}from"./alert.c1f6947c.js";import"./FormCheckRadioPicker.45cdfa4b.js";import"./Cow.f24886e5.js";import"./cow.4e92f3c6.js";const B=e=>e==="create"?[{id:1,label:"\u0E2B\u0E22\u0E32\u0E1A"},{id:2,label:"\u0E1C\u0E2A\u0E21\u0E40\u0E2D\u0E07"},{id:3,label:"\u0E2A\u0E33\u0E40\u0E23\u0E47\u0E08\u0E23\u0E39\u0E1B"}]:[{id:"",label:"\u0E17\u0E31\u0E49\u0E07\u0E2B\u0E21\u0E14"},{id:1,label:"\u0E2B\u0E22\u0E32\u0E1A"},{id:2,label:"\u0E1C\u0E2A\u0E21\u0E40\u0E2D\u0E07"},{id:3,label:"\u0E2A\u0E33\u0E40\u0E23\u0E47\u0E08\u0E23\u0E39\u0E1B"}],J={data(){return{recipe:{code:"",name:"",type:1,amount:0},recipeDetail:{},recipeDetails:[],type:B("create"),loading:!1,alertError:"",alertWarning:"",alertDetail:""}},emits:["update:modelValue","cancel","confirm"],computed:{value:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}},user(){return this.$store.state.auth.user}},watch:{data(e){e&&(this.mode==="edit"?(this.recipe=e,this.recipeDetails=e.recipeDetails):(this.recipe.name="",this.recipe.amount=0,this.recipe.type=1,this.recipeDetails=[]))},"recipe.frequency"(e){e&&(this.recipe.dateNext=E(new Date(this.recipe.dateCurrent),e))},"recipeDetail.cost"(e){var l,d;e&&((l=this.recipeDetail)==null?void 0:l.qty)?this.recipeDetail.amount=e*((d=this.recipeDetail)==null?void 0:d.qty):this.recipeDetail.amount=null},"recipeDetail.qty"(e){var l,d;e&&((l=this.recipeDetail)==null?void 0:l.cost)?this.recipeDetail.amount=e*((d=this.recipeDetail)==null?void 0:d.cost):this.recipeDetail.amount=null}},methods:{clear(){this.recipe.dateCurrent=new Date,this.recipe.dateNext=null,this.recipe.vaccine="",this.recipe.frequency="",this.recipe.remark=""},confirmCancel(e){this.value=!1,this.$emit(e)},confirm(){this.clear(),this.confirmCancel("confirm")},cancel(){this.clear(),this.confirmCancel("cancel")},addDetail(){var e,l,d,g;if(this.alertDetail="",((e=this.recipeDetail)==null?void 0:e.food)&&((l=this.recipeDetail)==null?void 0:l.qty)&&((d=this.recipeDetail)==null?void 0:d.cost))if(this.recipeDetails.filter(r=>{var n;return r.food===((n=this.recipeDetail)==null?void 0:n.food)}).length<=0)if(((g=this.recipeDetail)==null?void 0:g.qty)<=1){let r=0;this.recipeDetails.forEach(n=>{r+=n.qty}),r<=1?(this.recipeDetails.push(this.recipeDetail),this.recipe.amount=0,this.recipeDetails.forEach(n=>{this.recipe.amount+=n.amount}),this.recipeDetail={}):this.alertDetail="\u0E08\u0E33\u0E19\u0E27\u0E19\u0E17\u0E35\u0E48\u0E43\u0E0A\u0E49\u0E23\u0E27\u0E21\u0E2B\u0E49\u0E32\u0E21\u0E40\u0E01\u0E34\u0E19 1 \u0E01\u0E01."}else this.alertDetail="\u0E08\u0E33\u0E19\u0E27\u0E19\u0E17\u0E35\u0E48\u0E43\u0E0A\u0E49\u0E2B\u0E49\u0E32\u0E21\u0E40\u0E01\u0E34\u0E19 1 \u0E01\u0E01.";else this.alertDetail="\u0E2D\u0E32\u0E2B\u0E32\u0E23/\u0E27\u0E31\u0E15\u0E16\u0E38\u0E14\u0E34\u0E1A \u0E0B\u0E49\u0E33";else this.alertDetail="\u0E01\u0E23\u0E38\u0E13\u0E32\u0E01\u0E23\u0E2D\u0E01\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25\u0E43\u0E2B\u0E49\u0E04\u0E23\u0E1A"},removeDetail(e){var d;let l=this.recipeDetails.indexOf(e);l!==-1&&(this.recipe.amount-=(d=this.recipeDetails[l])==null?void 0:d.amount,this.recipeDetails.splice(l,1))},async submit(){this.loading=!0,this.alert="",this.alertWarning="";try{if(this.mode==="create"){let e=0;this.recipeDetails.forEach(l=>{e+=l.qty}),e===1?await w.create({recipe:this.recipe,recipeDetail:this.recipeDetails})&&(this.loading=!1,this.value=!1,this.confirmCancel("confirm"),V.fire({icon:"success",title:"\u0E1A\u0E31\u0E19\u0E17\u0E36\u0E01\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25\u0E2A\u0E33\u0E40\u0E23\u0E47\u0E08"})):this.alertWarning="\u0E01\u0E23\u0E38\u0E13\u0E32\u0E40\u0E1E\u0E34\u0E48\u0E21 \u0E23\u0E32\u0E22\u0E01\u0E32\u0E23\u0E2D\u0E32\u0E2B\u0E32\u0E23/\u0E27\u0E31\u0E15\u0E16\u0E38\u0E14\u0E34\u0E1A \u0E43\u0E2B\u0E49\u0E04\u0E23\u0E1A 1 \u0E01\u0E01."}else await w.update(this.recipe._id,{recipe:this.recipe,recipeDetail:this.recipeDetails})&&(this.loading=!1,this.value=!1,this.confirmCancel("confirm"),V.fire({icon:"success",title:"\u0E1A\u0E31\u0E19\u0E17\u0E36\u0E01\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25\u0E2A\u0E33\u0E40\u0E23\u0E47\u0E08"}))}catch(e){console.error("Error : ",e),this.clear(),this.loading=!1,this.alertError=await e.response.data.message,V.fire({icon:"error",title:"\u0E1A\u0E31\u0E19\u0E17\u0E36\u0E01\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25\u0E44\u0E21\u0E48\u0E2A\u0E33\u0E40\u0E23\u0E47\u0E08"})}}},components:{BaseButton:N,BaseButtons:O,CardBox:T,BaseDivider:F,OverlayLayer:L,FormField:G,FormControl:U,NotificationBar:W,BaseLevel:R,BaseIcon:A},props:{modelValue:{type:[String,Number,Boolean],default:null},data:{type:Object,default:null},mode:{type:String,default:""}}},Y={class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3 mb-5"},Z={class:"grid grid-cols-2 lg:grid-cols-6 gap-5"},$=s("header",{class:"flex items-stretch border-b border-gray-100 dark:border-gray-800"},[s("p",{class:"flex items-center py-3 grow font-bold"}," \u0E23\u0E32\u0E22\u0E01\u0E32\u0E23\u0E2D\u0E32\u0E2B\u0E32\u0E23/\u0E27\u0E31\u0E15\u0E16\u0E38\u0E14\u0E34\u0E1A ")],-1),ee={key:1,class:"overflow-x-auto"},te=s("thead",null,[s("tr",null,[s("th",{class:"whitespace-nowrap text-center"}," \u0E2D\u0E32\u0E2B\u0E32\u0E23/\u0E27\u0E31\u0E15\u0E16\u0E38\u0E14\u0E34\u0E1A "),s("th",{class:"whitespace-nowrap text-center"}," \u0E23\u0E32\u0E04\u0E32/\u0E01\u0E01. "),s("th",{class:"whitespace-nowrap text-center"}," \u0E08\u0E33\u0E19\u0E27\u0E19\u0E17\u0E35\u0E48\u0E43\u0E0A\u0E49 (\u0E01\u0E01.) "),s("th",{class:"whitespace-nowrap text-center"}," \u0E08\u0E33\u0E19\u0E27\u0E19\u0E40\u0E07\u0E34\u0E19 "),s("th")])],-1),le={"data-label":"\u0E2D\u0E32\u0E2B\u0E32\u0E23/\u0E27\u0E31\u0E15\u0E16\u0E38\u0E14\u0E34\u0E1A"},ie={"data-label":"\u0E23\u0E32\u0E04\u0E32/\u0E01\u0E01.",class:"text-center"},ae={"data-label":"\u0E08\u0E33\u0E19\u0E27\u0E19\u0E17\u0E35\u0E48\u0E43\u0E0A\u0E49 (\u0E01\u0E01.)",class:"text-center"},se={"data-label":"\u0E08\u0E33\u0E19\u0E27\u0E19\u0E40\u0E07\u0E34\u0E19",class:"text-right"},re={class:"lg:w-6 whitespace-nowrap"},oe={key:2,class:"text-center py-10 text-gray-500 dark:text-gray-400"},ne=s("p",null,"\u0E44\u0E21\u0E48\u0E21\u0E35\u0E23\u0E32\u0E22\u0E01\u0E32\u0E23...",-1),ce=[ne];function de(e,l,d,g,t,r){const n=c("FormControl"),u=c("FormField"),m=c("BaseButton"),f=c("BaseButtons"),_=c("NotificationBar"),y=c("CardBox"),b=c("BaseDivider"),q=c("OverlayLayer");return k((p(),D(q,null,{default:o(()=>[k(i(y,{title:(this.mode==="create"?"\u0E1A\u0E31\u0E19\u0E17\u0E36\u0E01":"\u0E41\u0E01\u0E49\u0E44\u0E02")+"\u0E2A\u0E39\u0E15\u0E23\u0E2D\u0E32\u0E2B\u0E32\u0E23",class:"shadow-lg w-full lg:w-2/3 z-50","header-icon":"close",modal:"",form:"",onSubmit:Q(r.submit,["prevent"]),onHeaderIconClick:r.cancel},{default:o(()=>[s("div",Y,[i(u,{label:"\u0E0A\u0E37\u0E48\u0E2D\u0E2A\u0E39\u0E15\u0E23\u0E2D\u0E32\u0E2B\u0E32\u0E23",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:o(()=>[i(n,{modelValue:t.recipe.name,"onUpdate:modelValue":l[0]||(l[0]=a=>t.recipe.name=a),icon:"potMixOutline",required:""},null,8,["modelValue"])]),_:1}),i(u,{label:"\u0E1B\u0E23\u0E30\u0E40\u0E20\u0E17\u0E2D\u0E32\u0E2B\u0E32\u0E23",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:o(()=>[i(n,{modelValue:t.recipe.type,"onUpdate:modelValue":l[1]||(l[1]=a=>t.recipe.type=a),options:t.type,required:""},null,8,["modelValue","options"])]),_:1}),i(u,{label:"\u0E08\u0E33\u0E19\u0E27\u0E19\u0E40\u0E07\u0E34\u0E19\u0E23\u0E27\u0E21"},{default:o(()=>[i(n,{modelValue:t.recipe.amount,"onUpdate:modelValue":l[2]||(l[2]=a=>t.recipe.amount=a),icon:"cashMultiple",type:"number",required:""},null,8,["modelValue"])]),_:1})]),i(y,{title:"\u0E23\u0E32\u0E22\u0E25\u0E30\u0E40\u0E2D\u0E35\u0E22\u0E14\u0E2A\u0E39\u0E15\u0E23\u0E2D\u0E32\u0E2B\u0E32\u0E23",class:"shadow-lg dark:bg-slate-700","header-icon":""},{default:o(()=>[s("div",Z,[i(u,{label:"\u0E2D\u0E32\u0E2B\u0E32\u0E23/\u0E27\u0E31\u0E15\u0E16\u0E38\u0E14\u0E34\u0E1A",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:o(()=>[i(n,{modelValue:t.recipeDetail.food,"onUpdate:modelValue":l[3]||(l[3]=a=>t.recipeDetail.food=a),icon:"foodVariant"},null,8,["modelValue"])]),_:1}),i(u,{label:"\u0E23\u0E32\u0E04\u0E32/\u0E01\u0E01.",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:o(()=>[i(n,{modelValue:t.recipeDetail.cost,"onUpdate:modelValue":l[4]||(l[4]=a=>t.recipeDetail.cost=a),icon:"cash",type:"number"},null,8,["modelValue"])]),_:1}),i(u,{label:"\u0E08\u0E33\u0E19\u0E27\u0E19\u0E17\u0E35\u0E48\u0E43\u0E0A\u0E49 (\u0E01\u0E01.)",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07 (\u0E2B\u0E49\u0E32\u0E21\u0E40\u0E01\u0E34\u0E19 1 \u0E01\u0E01.)"},{default:o(()=>[i(n,{icon:"scale",type:"number",modelValue:t.recipeDetail.qty,"onUpdate:modelValue":l[5]||(l[5]=a=>t.recipeDetail.qty=a)},null,8,["modelValue"])]),_:1}),i(u,{label:"\u0E08\u0E33\u0E19\u0E27\u0E19\u0E40\u0E07\u0E34\u0E19"},{default:o(()=>[i(n,{modelValue:t.recipeDetail.amount,"onUpdate:modelValue":l[6]||(l[6]=a=>t.recipeDetail.amount=a),icon:"cashMultiple",type:"number"},null,8,["modelValue"])]),_:1}),i(f,{class:"col-span-2",type:"justify-center"},{default:o(()=>[i(m,{label:"\u0E40\u0E1E\u0E34\u0E48\u0E21",color:"success",onClick:r.addDetail},null,8,["onClick"]),i(m,{label:"\u0E25\u0E49\u0E32\u0E07",color:"danger",onClick:l[7]||(l[7]=a=>e.resetDetail())})]),_:1})]),t.alertDetail?(p(),D(_,{key:0,color:"warning",outline:"",icon:"alertCircleOutline"},{default:o(()=>[C(h(t.alertDetail),1)]),_:1})):x("",!0),$,t.recipeDetails.length>0?(p(),v("div",ee,[s("table",null,[te,s("tbody",null,[(p(!0),v(I,null,H(t.recipeDetails,a=>(p(),v("tr",{key:a.food},[s("td",le,h(a.food),1),s("td",ie,h(a.cost),1),s("td",ae,h(a.qty),1),s("td",se,h(a.amount),1),s("td",re,[i(f,{type:"justify-end lg:justify-start","no-wrap":""},{default:o(()=>[i(m,{color:"danger",label:"\u0E25\u0E1A",onClick:he=>r.removeDetail(a)},null,8,["onClick"])]),_:2},1024)])]))),128))])])])):(p(),v("div",oe,ce))]),_:1}),t.alertError?(p(),D(_,{key:0,color:"danger",outline:"",icon:"alertCircleOutline"},{default:o(()=>[C(h(t.alertError),1)]),_:1})):x("",!0),t.alertWarning?(p(),D(_,{key:1,color:"warning",outline:"",icon:"alertCircleOutline"},{default:o(()=>[C(h(t.alertWarning),1)]),_:1})):x("",!0),i(b),i(f,{type:"justify-center"},{default:o(()=>[i(m,{label:"\u0E1A\u0E31\u0E19\u0E17\u0E36\u0E01",color:"success",type:"submit",loading:t.loading},null,8,["loading"]),i(m,{label:"\u0E22\u0E01\u0E40\u0E25\u0E34\u0E01",color:"danger",onClick:r.cancel},null,8,["onClick"])]),_:1})]),_:1},8,["title","onSubmit","onHeaderIconClick"]),[[S,r.value]])]),_:1},512)),[[S,r.value]])}var ue=M(J,[["render",de]]);const pe={data(){return{openModal:!1,modalData:null,items:[],forms:[{label:"\u0E2A\u0E39\u0E15\u0E23\u0E2D\u0E32\u0E2B\u0E32\u0E23",value:"recipe",type:"ddl",module:"recipe"},{label:"\u0E1B\u0E23\u0E30\u0E40\u0E20\u0E17",value:"type",options:B()}],search:{recipe:"",type:""},loading:!1,mode:"create",dataEdit:null,checked:{code:{value:"code"},label:{value:"name"}},datas:[{label:"\u0E2A\u0E39\u0E15\u0E23\u0E2D\u0E32\u0E2B\u0E32\u0E23",class:"text-center",value:"name"},{label:"\u0E1B\u0E23\u0E30\u0E40\u0E20\u0E17",class:"text-center",func:e=>B()[e.type].label},{label:"\u0E23\u0E32\u0E04\u0E32/\u0E01\u0E01.",class:"text-center",value:"amount"},{label:"\u0E08\u0E33\u0E19\u0E27\u0E19\u0E2D\u0E32\u0E2B\u0E32\u0E23/\u0E27\u0E31\u0E15\u0E16\u0E38\u0E14\u0E34\u0E1A",class:"text-center",func:e=>e.recipeDetails.length}],buttons:[{label:"\u0E25\u0E1A",type:"delete",color:"danger"},{label:"\u0E41\u0E01\u0E49\u0E44\u0E02",type:"edit",color:"warning"}]}},components:{SectionMain:j,LayoutAuthenticated:z,SectionTitleBarSub:K,Table:P,Modal:ue,Criteria:X},computed:{user(){return this.$store.state.auth.user}},created(){this.getDatas()},methods:{async getDatas(){this.loading=!0;const e=await w.all(this.search);this.items=[],e.data&&(this.items=e.data.recipes),this.loading=!1},async remove(e){this.loading=!0,(await w.delete(e)).data&&this.getDatas(),this.loading=!1,V.fire({icon:"success",title:"\u0E25\u0E1A\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25\u0E2A\u0E33\u0E40\u0E23\u0E47\u0E08"})},edit(e){this.modalData=e,this.mode="edit",this.openModal=!0},reset(){this.search.recipe="",this.search.type="",this.getDatas()}}};function me(e,l,d,g,t,r){const n=c("SectionTitleBarSub"),u=c("Modal"),m=c("Criteria"),f=c("Table"),_=c("SectionMain"),y=c("LayoutAuthenticated");return p(),D(y,null,{default:o(()=>[i(_,null,{default:o(()=>[i(n,{icon:"calculatorVariantOutline",title:"\u0E2A\u0E39\u0E15\u0E23\u0E2D\u0E32\u0E2B\u0E32\u0E23","has-btn-add":"",onOpenModal:l[0]||(l[0]=b=>{t.mode="create",t.openModal=!0}),btnText:"\u0E40\u0E1E\u0E34\u0E48\u0E21\u0E2A\u0E39\u0E15\u0E23\u0E2D\u0E32\u0E2B\u0E32\u0E23"}),i(u,{modelValue:t.openModal,"onUpdate:modelValue":l[1]||(l[1]=b=>t.openModal=b),data:t.modalData,mode:t.mode,onConfirm:r.getDatas},null,8,["modelValue","data","mode","onConfirm"]),i(m,{grid:"grid-cols-2 lg:grid-cols-4",onSearch:r.getDatas,onReset:r.reset,forms:t.forms,search:t.search},null,8,["onSearch","onReset","forms","search"]),i(f,{title:"\u0E23\u0E32\u0E22\u0E01\u0E32\u0E23\u0E2A\u0E39\u0E15\u0E23\u0E2D\u0E32\u0E2B\u0E32\u0E23","has-checkbox":"","checked-data":t.checked,items:t.items,datas:t.datas,buttons:t.buttons,onEdit:r.edit,onDelete:r.remove,onDeleteSelected:e.removeSelected,loading:t.loading},null,8,["checked-data","items","datas","buttons","onEdit","onDelete","onDeleteSelected","loading"])]),_:1})]),_:1})}var we=M(pe,[["render",me]]);export{we as default};
