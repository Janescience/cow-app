import{y as c,z as y,p as V,m as D,_ as w,l as x,F as N,i as M,j as k,f as T,N as F,E as n,G as v,H as S,o as B,c as C,w as i,d as l,s as L,e as O,S as U,C as q,D as E}from"./index-12b4016e.js";import{T as j}from"./Table-014b1938.js";import{C as A}from"./Criteria-72fb76ed.js";import{_ as H}from"./FormField-41447fb2.js";import{_ as I}from"./FormCheckRadioPicker-daaeed2d.js";import{T as b}from"./alert-8c8566fa.js";import"./Cow-f5825df1.js";import"./cow-a691a502.js";import"./Vaccine-79789b25.js";async function R(a={}){let e="?";return a.name&&(e=e+`name=${a.name}&`),a.code&&(e=e+`code=${a.code}&`),a.group&&(e=e+`group=${a.group}&`),a.valueNumber&&(e=e+`valueNumber=${a.valueNumber}&`),a.valueString&&(e=e+`valueString=${a.valueString}&`),a?e.replace(/&*$/,""):""}class z{async all(e){const m=await R(e);return c.get("/param"+m).then(f=>f)}get(e){return c.get(`/param/${e}`)}create(e){return c.post("/param",e)}delete(e){return c.delete(`/param/${e}`)}update(e,m){return c.put(`/param/${e}`,m)}}const p=new z,P={data(){return{param:{group:"",code:"",name:"",valueNumber:null,valueString:""},loading:!1,alert:""}},emits:["update:modelValue","cancel","confirm"],computed:{value:{get(){return this.modelValue},set(a){this.$emit("update:modelValue",a)}}},watch:{data:{handler(a,e){this.clear(),a!=null&&this.mode=="edit"&&(this.param=a)},deep:!0}},methods:{clear(){var a;this.mode==="edit"&&this.$emit("update:data",null),this.param.code="",this.param.name="",this.param.group="",this.param.valueString="",this.param.valueNumber=null,this.$emit("update:mode",""),(a=this.param)==null||delete a._id},confirmCancel(a){this.value=!1,this.$emit(a)},confirm(){this.confirmCancel("confirm")},cancel(){this.confirmCancel("cancel")},async submit(){this.loading=!0,this.alert="";try{this.mode==="create"?await p.create(this.param)&&(this.loading=!1,this.value=!1,this.confirm(),b.fire({icon:"success",title:"บันทึกข้อมูลสำเร็จ"})):await p.update(this.param._id,this.param)&&(this.loading=!1,this.value=!1,this.confirm(),b.fire({icon:"success",title:"บันทึกข้อมูลสำเร็จ"}))}catch(a){console.error("Error : ",a),this.loading=!1,this.alert=a.response.data.message}}},components:{BaseButton:V,BaseButtons:D,CardBox:w,BaseDivider:x,OverlayLayer:N,FormField:H,FormControl:M,NotificationBar:k,BaseLevel:T,FormCheckRadioPicker:I,BaseIcon:F},props:{modelValue:{type:[String,Number,Boolean],default:null},mode:{type:String,default:""},data:{type:Object,default:null}}},$={class:"grid grid-cols-2 lg:grid-cols-3 gap-3 mt-1"};function G(a,e,m,f,t,o){const s=n("FormControl"),u=n("FormField"),d=n("BaseButton"),h=n("BaseButtons"),_=n("CardBox"),g=n("OverlayLayer");return v((B(),C(g,null,{default:i(()=>[v(l(_,{title:(this.mode==="create"?"บันทึก":"แก้ไข")+"พารามิเตอร์",class:"shadow-lg w-full lg:w-1/2 z-50","header-icon":"close",modal:"",form:"","has-scroll":"",onSubmit:O(o.submit,["prevent"]),onHeaderIconClick:o.cancel},{default:i(()=>[L("div",$,[l(u,{label:"กลุ่ม",help:"* ห้ามว่าง"},{default:i(()=>[l(s,{modelValue:t.param.group,"onUpdate:modelValue":e[0]||(e[0]=r=>t.param.group=r),icon:"barcode",required:""},null,8,["modelValue"])]),_:1}),l(u,{label:"รหัส",help:"* ห้ามว่าง"},{default:i(()=>[l(s,{modelValue:t.param.code,"onUpdate:modelValue":e[1]||(e[1]=r=>t.param.code=r),icon:"barcode",required:""},null,8,["modelValue"])]),_:1}),l(u,{label:"ชื่อ",help:"* ห้ามว่าง"},{default:i(()=>[l(s,{modelValue:t.param.name,"onUpdate:modelValue":e[2]||(e[2]=r=>t.param.name=r),icon:"formTextbox",required:""},null,8,["modelValue"])]),_:1}),l(u,{label:"ข้อมูล(ตัวเลข)"},{default:i(()=>[l(s,{modelValue:t.param.valueNumber,"onUpdate:modelValue":e[3]||(e[3]=r=>t.param.valueNumber=r),icon:"formTextbox",type:"number"},null,8,["modelValue"])]),_:1}),l(u,{label:"ข้อมูล(ตัวหนังสือ)"},{default:i(()=>[l(s,{modelValue:t.param.valueString,"onUpdate:modelValue":e[4]||(e[4]=r=>t.param.valueString=r),icon:"formTextbox"},null,8,["modelValue"])]),_:1})]),l(h,{type:"justify-center mt-3"},{default:i(()=>[l(d,{label:"บันทึก",color:"success",type:"submit",loading:t.loading},null,8,["loading"]),l(d,{label:"ยกเลิก",color:"danger",onClick:o.cancel},null,8,["onClick"])]),_:1})]),_:1},8,["title","onSubmit","onHeaderIconClick"]),[[S,o.value]])]),_:1},512)),[[S,o.value]])}const Q=y(P,[["render",G]]),J={data(){return{openModal:!1,modalData:null,items:[],forms:[{label:"กลุ่ม",value:"group"},{label:"รหัส",value:"code"},{label:"ชื่อ",value:"name"},{label:"ข้อมูล(ตัวเลข)",value:"valueNumber",type:"number"},{label:"ข้อมูล(ตัวหนังสือ)",value:"valueString"}],search:{name:"",code:"",group:"",valueNumber:null,valueString:""},loading:!1,mode:"create",dataEdit:null,checked:{code:{value:"code"},label:{value:"name"}},datas:[{label:"กลุ่ม",value:"group"},{label:"รหัส",value:"code"},{label:"ชื่อ",value:"name"},{label:"ข้อมูล(ตัวเลข)",value:"valueNumber"},{label:"ข้อมูล(ตัวหนังสือ)",value:"valueString"}],buttons:[{label:"ลบ",type:"delete",color:"danger"},{label:"แก้ไข",type:"edit",color:"warning"}]}},components:{SectionMain:U,LayoutAuthenticated:q,SectionTitleBarSub:E,Table:j,Modal:Q,Criteria:A},computed:{getDataCopy(){return{...this.modalData}}},created(){this.getDatas()},methods:{async getDatas(a){this.loading=!0;const e=await p.all(a);this.items=[],e.data&&(this.items=e.data.params),this.loading=!1},async remove(a){this.loading=!0,(await p.delete(a)).data&&this.getDatas(),this.loading=!1,b.fire({icon:"success",title:"ลบข้อมูลสำเร็จ"})},edit(a){this.modalData=a,this.mode="edit",this.openModal=!0},reset(){this.search.name=""}}};function K(a,e,m,f,t,o){const s=n("SectionTitleBarSub"),u=n("Modal"),d=n("Criteria"),h=n("Table"),_=n("SectionMain"),g=n("LayoutAuthenticated");return B(),C(g,null,{default:i(()=>[l(_,null,{default:i(()=>[l(s,{icon:"applicationVariableOutline",title:"พารามิเตอร์","has-btn-add":"",onOpenModal:e[0]||(e[0]=r=>{t.mode="create",t.openModal=!0,t.modalData=null}),btnText:"เพิ่มพารามิเตอร์"}),l(u,{modelValue:t.openModal,"onUpdate:modelValue":e[1]||(e[1]=r=>t.openModal=r),data:o.getDataCopy,mode:t.mode,onConfirm:o.getDatas},null,8,["modelValue","data","mode","onConfirm"]),l(d,{grid:"grid-cols-2 lg:grid-cols-5",onSearch:o.getDatas,onReset:o.reset,forms:t.forms,search:t.search},null,8,["onSearch","onReset","forms","search"]),l(h,{title:"รายการพารามิเตอร์","has-checkbox":"","checked-data":t.checked,items:t.items,datas:t.datas,buttons:t.buttons,onEdit:o.edit,onDelete:o.remove,onDeleteSelected:a.removeSelected,loading:t.loading},null,8,["checked-data","items","datas","buttons","onEdit","onDelete","onDeleteSelected","loading"])]),_:1})]),_:1})}const re=y(J,[["render",K]]);export{re as default};
