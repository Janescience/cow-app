import{a0 as i,Z as f,N as C,O as V,Q as r,o as g,s as k,b as l,w as c,i as N,a3 as w,l as T,_ as O,k as L,R as F,g as I,h as U,e as A,U as H,H as S,T as B,c as y,p as j,t as q,j as E,d as P,S as R,P as Q,V as z}from"./index.da00f043.js";import{T as Z,a as G}from"./Criteria.5e5875e3.js";import{_ as J}from"./BaseButtons.91175924.js";import{_ as K,a as W}from"./FormField.7e5cafb1.js";import{a as s}from"./auth-header.d1470e16.js";import{H as x}from"./heal.84de5fca.js";import"./CardBoxModal.fa1f3c1a.js";async function X(t={}){let e="?";if(t.farm&&(e=e+`farm=${t.farm}&`),t.cows&&(e=e+`flag=${t.flag}&`),t.code&&(e=e+`code=${t.code}&`),t.name&&(e=e+`name=${t.name}&`),t.status&&(e=e+`status=${t.status}&`),t.birthDate){const n=f(new Date(t.birthDate)).format("YYYY-MM-DD");e=e+`birthDate=${n}&`}return t.corral&&(e=e+`corral=${t.corral}&`),t?e.replace(/&*$/,""):""}class ee{async all(e){const n=await X(e);return i.get("/cow"+n,{headers:s()}).then(d=>d)}get(e){return i.get(`/cow/${e}`,{headers:s()})}create(e){return e.dateCurrent&&(e.dateCurrent=f(new Date(e.dateCurrent)).format("YYYY-MM-DD")),e.dateNext&&(e.dateNext=f(new Date(e.dateNext)).format("YYYY-MM-DD")),i.post("/protection",e,{headers:s()})}delete(e){return i.delete(`/cow/${e}`,{headers:s()})}update(e,n){return i.put(`/cow/${e}`,n,{headers:s()})}}var te=new ee;const ae={data(){return{datas:[]}},created(){this.initialData()},computed:{value:{get(){return this.modelValue},set(t){this.$emit("update:modelValue",t)}}},methods:{async initialData(){const t={farm:V().farm._id};try{const e=await te.all(t);if(this.datas=[],e&&(this.datas=e.data.vaccines,this.datas.map(n=>n.vaccine_data=n.name)),this.defaultValue){const n=this.datas.filter(d=>d[this.defaultType]==this.defaultValue);n&&this.handleInput(this.reduceAction(n[0]))}}catch(e){this.datas=[],console.error("Error: "+e.message)}},reduceAction(t){return this.valueType==="object"?t:t[this.valueType]},handleInput(t){this.$emit("update:value",t),this.dataSelected=this.datas.find(e=>e.name===t),this.$emit("update:dataSelected",this.dataSelected)}},props:{clear:{default:!0,type:Boolean},disabled:{default:!1,type:Boolean},dataSelected:{default:null,type:Object},defaultType:{default:null,type:Object},valueType:{default:"_id",type:Object},defaultValue:{default:null,type:Object},modelValue:{type:[String,Number,Boolean,Array,Object],default:""},multiple:{default:!1,type:Boolean}}},ne={class:"relative"},le=N(" \u0E44\u0E21\u0E48\u0E1E\u0E1A\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25 ");function re(t,e,n,d,a,o){const h=r("mdicon"),u=r("v-select");return g(),k("div",ne,[l(u,{class:"ddl",clearable:n.clear,disabled:n.disabled,options:a.datas,reduce:o.reduceAction,label:"vaccine_data",placeholder:"\u0E40\u0E25\u0E37\u0E2D\u0E01\u0E27\u0E31\u0E04\u0E0B\u0E35\u0E19",onInput:o.handleInput,modelValue:o.value,"onUpdate:modelValue":e[0]||(e[0]=_=>o.value=_),dataSelected:n.dataSelected,multiple:""},{"no-options":c(()=>[l(h,{name:"alertCircleOutline",width:"16",height:"16",class:"inline-block"}),le]),_:1},8,["clearable","disabled","options","reduce","onInput","modelValue","dataSelected"])])}var oe=C(ae,[["render",re]]);async function ce(t={}){let e="?";if(t.farm&&(e=e+`farm=${t.farm}&`),t.cows&&(e=e+`flag=${t.flag}&`),t.code&&(e=e+`code=${t.code}&`),t.name&&(e=e+`name=${t.name}&`),t.status&&(e=e+`status=${t.status}&`),t.birthDate){const n=f(new Date(t.birthDate)).format("YYYY-MM-DD");e=e+`birthDate=${n}&`}return t.corral&&(e=e+`corral=${t.corral}&`),t?e.replace(/&*$/,""):""}class ie{async all(e){const n=await ce(e);return i.get("/cow"+n,{headers:s()}).then(d=>d)}get(e){return i.get(`/cow/${e}`,{headers:s()})}create(e){return e.dateCurrent&&(e.dateCurrent=f(new Date(e.dateCurrent)).format("YYYY-MM-DD")),e.dateNext&&(e.dateNext=f(new Date(e.dateNext)).format("YYYY-MM-DD")),i.post("/protection",e,{headers:s()})}delete(e){return i.delete(`/cow/${e}`,{headers:s()})}update(e,n){return i.put(`/cow/${e}`,n,{headers:s()})}}var se=new ie;const de={data(){return{protection:{cows:[],dateCurrent:new Date,dateNext:null,vaccine:null,farm:V().farm._id},loading:!1,alert:""}},emits:["update:modelValue","cancel","confirm"],computed:{value:{get(){return this.modelValue},set(t){this.$emit("update:modelValue",t)}}},watch:{data(t){t&&this.mode==="edit"&&(this.protection=t,this.protection.dateCurrent=new Date(t.dateCurrent),this.protection.dateNext=new Date(t.dateNext))}},methods:{clear(){this.protection.cows=[],this.protection.dateCurrent=new Date,this.protection.dateNext=null,this.protection.vaccine=null},confirmCancel(t){this.value=!1,this.$emit(t)},confirm(){this.clear(),this.confirmCancel("confirm")},cancel(){this.clear(),this.confirmCancel("cancel")},async submit(){this.loading=!0,this.alert="";try{this.mode==="create"?await se.create(this.protection)&&(this.loading=!1,this.value=!1,this.confirmCancel("confirm")):await HealService.update(this.protection)&&(this.loading=!1,this.value=!1,this.confirmCancel("confirm")),w.fire({icon:"success",title:"\u0E1A\u0E31\u0E19\u0E17\u0E36\u0E01\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25\u0E2A\u0E33\u0E40\u0E23\u0E47\u0E08"})}catch(t){console.error("Error : ",t),this.loading=!1,this.alert=t.response.data.message,w.fire({icon:"error",title:"\u0E1A\u0E31\u0E19\u0E17\u0E36\u0E01\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25\u0E44\u0E21\u0E48\u0E2A\u0E33\u0E40\u0E23\u0E47\u0E08"})}}},components:{BaseButton:T,BaseButtons:J,CardBox:O,BaseDivider:L,OverlayLayer:F,FormField:K,FormControl:I,NotificationBar:U,BaseLevel:A,DDLVaccine:oe,FormCheckRadioPicker:W,BaseIcon:H},props:{modelValue:{type:[String,Number,Boolean],default:null},data:{type:Object,default:null},mode:{type:String,default:""}}},ue={class:"grid grid-cols-1 lg:grid-cols-3 gap-8"};function me(t,e,n,d,a,o){const h=r("DDLCow"),u=r("FormField"),_=r("DDLVaccine"),v=r("FormControl"),D=r("NotificationBar"),b=r("BaseDivider"),p=r("BaseButton"),M=r("BaseButtons"),Y=r("CardBox"),$=r("OverlayLayer");return S((g(),y($,null,{default:c(()=>[S(l(Y,{title:(this.mode==="create"?"\u0E1A\u0E31\u0E19\u0E17\u0E36\u0E01":"\u0E41\u0E01\u0E49\u0E44\u0E02")+"\u0E01\u0E32\u0E23\u0E1B\u0E49\u0E2D\u0E07\u0E01\u0E31\u0E19/\u0E1A\u0E33\u0E23\u0E38\u0E07",class:"shadow-lg w-full overflow-y-auto lg:w-1/2 z-50","header-icon":"close",modal:"",form:"",onSubmit:P(o.submit,["prevent"]),onHeaderIconClick:o.cancel},{default:c(()=>[j("div",ue,[l(u,{label:"\u0E42\u0E04",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07",class:"col-span-3"},{default:c(()=>[l(h,{modelValue:a.protection.cows,"onUpdate:modelValue":e[0]||(e[0]=m=>a.protection.cows=m),multiple:""},null,8,["modelValue"])]),_:1}),l(u,{label:"\u0E27\u0E31\u0E04\u0E0B\u0E35\u0E19",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:c(()=>[l(_,{modelValue:a.protection.vaccine,"onUpdate:modelValue":e[1]||(e[1]=m=>a.protection.vaccine=m)},null,8,["modelValue"])]),_:1}),l(u,{label:"\u0E09\u0E35\u0E14\u0E27\u0E31\u0E04\u0E0B\u0E35\u0E19\u0E25\u0E48\u0E32\u0E2A\u0E38\u0E14",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:c(()=>[l(v,{modelValue:a.protection.dateCurrent,"onUpdate:modelValue":e[2]||(e[2]=m=>a.protection.dateCurrent=m),icon:"calendar",type:"date",required:""},null,8,["modelValue"])]),_:1}),l(u,{label:"\u0E09\u0E35\u0E14\u0E27\u0E31\u0E04\u0E0B\u0E35\u0E19\u0E04\u0E23\u0E31\u0E49\u0E07\u0E15\u0E48\u0E2D\u0E44\u0E1B",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:c(()=>[l(v,{modelValue:a.protection.dateNext,"onUpdate:modelValue":e[3]||(e[3]=m=>a.protection.dateNext=m),icon:"calendar",type:"date",required:""},null,8,["modelValue"])]),_:1})]),a.alert?(g(),y(D,{key:0,color:"danger",outline:"",icon:"alertCircleOutline"},{default:c(()=>[N(q(a.alert),1)]),_:1})):E("",!0),l(b),l(M,{type:"justify-center"},{default:c(()=>[l(p,{label:"\u0E1A\u0E31\u0E19\u0E17\u0E36\u0E01",color:"success",type:"submit",loading:a.loading},null,8,["loading"]),l(p,{label:"\u0E22\u0E01\u0E40\u0E25\u0E34\u0E01",color:"danger",onClick:o.cancel},null,8,["onClick"])]),_:1})]),_:1},8,["title","onSubmit","onHeaderIconClick"]),[[B,o.value]])]),_:1},512)),[[B,o.value]])}var fe=C(de,[["render",me]]);const he={data(){return{openModal:!1,modalData:null,items:[],forms:[{label:"\u0E42\u0E04",value:"cow",type:"ddl-multiple",module:"cow",class:"col-span-4"},{label:"\u0E27\u0E31\u0E04\u0E0B\u0E35\u0E19",value:"vaccine",type:"ddl",module:"vaccine"},{label:"\u0E09\u0E35\u0E14\u0E27\u0E31\u0E04\u0E0B\u0E35\u0E19\u0E25\u0E48\u0E32\u0E2A\u0E38\u0E14",value:"dateCurrent",icon:"calendar",type:"date"},{label:"\u0E09\u0E35\u0E14\u0E27\u0E31\u0E04\u0E0B\u0E35\u0E19\u0E04\u0E23\u0E31\u0E49\u0E07\u0E15\u0E48\u0E2D\u0E44\u0E1B",value:"dateNext",icon:"calendar",type:"date"}],search:{cow:[],dateCurrent:null,dateNext:null,vaccine:null,farm:V().farm._id},loading:!1,mode:"create",dataEdit:null,checked:{code:{value:"cow.name"},label:{value:"vaccine.name"}},datas:[{label:"\u0E42\u0E04",func:t=>t.cow.code+" : "+t.cow.name},{label:"\u0E27\u0E31\u0E04\u0E0B\u0E35\u0E19",class:"text-center",value:"vaccine.name"},{label:"\u0E09\u0E35\u0E14\u0E27\u0E31\u0E04\u0E0B\u0E35\u0E19\u0E25\u0E48\u0E32\u0E2A\u0E38\u0E14",class:"text-center",value:"dateCurrent",type:"date"},{label:"\u0E09\u0E35\u0E14\u0E27\u0E31\u0E04\u0E0B\u0E35\u0E19\u0E04\u0E23\u0E31\u0E49\u0E07\u0E15\u0E48\u0E2D\u0E44\u0E1B",class:"text-center",value:"dateNext",type:"date"}],buttons:[{label:"\u0E25\u0E1A",type:"delete",color:"danger"},{label:"\u0E41\u0E01\u0E49\u0E44\u0E02",type:"edit",color:"warning"}]}},components:{SectionMain:R,LayoutAuthenticated:Q,SectionTitleBarSub:z,Table:Z,Modal:fe,Criteria:G},created(){this.getDatas()},methods:{async getDatas(t){this.loading=!0;const e=await x.all(t);this.items=[],e.data&&(this.items=e.data.heals),this.loading=!1},async remove(t){this.loading=!0,(await x.delete(t)).data&&this.getDatas(),this.loading=!1,w.fire({icon:"success",title:"\u0E25\u0E1A\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25\u0E2A\u0E33\u0E40\u0E23\u0E47\u0E08"})},edit(t){this.modalData=t,this.modalData.cow=t.cow._id,this.modalData.vaccine=t.vaccine._id,this.mode="edit",this.openModal=!0},reset(){this.search.cow=[],this.search.dateCurrent=null,this.search.dateNext=null,this.search.vaccine=null}}};function _e(t,e,n,d,a,o){const h=r("SectionTitleBarSub"),u=r("Modal"),_=r("Criteria"),v=r("Table"),D=r("SectionMain"),b=r("LayoutAuthenticated");return g(),y(b,null,{default:c(()=>[l(D,null,{default:c(()=>[l(h,{icon:"doctor",title:"\u0E01\u0E32\u0E23\u0E1B\u0E49\u0E2D\u0E07\u0E01\u0E31\u0E19/\u0E1A\u0E33\u0E23\u0E38\u0E07","has-btn-add":"",onOpenModal:e[0]||(e[0]=p=>{a.mode="create",a.openModal=!0}),btnText:"\u0E40\u0E1E\u0E34\u0E48\u0E21\u0E01\u0E32\u0E23\u0E1B\u0E49\u0E2D\u0E07\u0E01\u0E31\u0E19/\u0E1A\u0E33\u0E23\u0E38\u0E07"}),l(u,{modelValue:a.openModal,"onUpdate:modelValue":e[1]||(e[1]=p=>a.openModal=p),data:a.modalData,mode:a.mode,onConfirm:o.getDatas,onCancel:o.getDatas},null,8,["modelValue","data","mode","onConfirm","onCancel"]),l(_,{grid:"grid-cols-2 lg:grid-cols-4",onSearch:o.getDatas,onReset:o.reset,forms:a.forms,search:a.search},null,8,["onSearch","onReset","forms","search"]),l(v,{title:"\u0E23\u0E32\u0E22\u0E01\u0E32\u0E23\u0E1B\u0E49\u0E2D\u0E07\u0E01\u0E31\u0E19/\u0E1A\u0E33\u0E23\u0E38\u0E07","has-checkbox":"","checked-data":a.checked,items:a.items,datas:a.datas,buttons:a.buttons,onEdit:o.edit,onDelete:o.remove,onDeleteSelected:t.removeSelected,loading:a.loading},null,8,["checked-data","items","datas","buttons","onEdit","onDelete","onDeleteSelected","loading"])]),_:1})]),_:1})}var Ce=C(he,[["render",_e]]);export{Ce as default};
