import{_ as ae}from"./LayoutAuthenticated-26010161.js";import{b as K,_ as Q,a as W,c as se,d as re}from"./BaseDivider-3bd10d7c.js";import{v as X,h as Z,_ as $,z as i,G as z,H as R,o as d,c as h,w as n,d as o,f as F,j as m,t as p,g as C,e as ne,s as w,F as G,D as Y,n as D}from"./index-c9555507.js";import{_ as ee}from"./UserAvatar-d47e699f.js";import{_ as te}from"./FormField-367a34f1.js";import{_ as le}from"./FormControl-9960a6f0.js";import{T as ie}from"./Table-fbdb84bf.js";import{C as ce}from"./Criteria-117f2e94.js";import{_ as ue}from"./SectionTitleBarSub-190378a7.js";import{a as de}from"./CardBoxModal-af2232b7.js";import{_ as me}from"./NotificationBar-f2db1bd0.js";import{I as fe}from"./ImageUpload-c97b82b0.js";import{C as v}from"./cow-8f324bef.js";import{s as U,q as oe}from"./cow-47ecf25e.js";import{T as J}from"./alert-b2181f36.js";import{D as ge}from"./Cow-180ca56b.js";import{g as pe}from"./age-calculate-3b5fe841.js";import"./CardBoxCollapse-79f0452c.js";import"./FormCheckRadioPicker-03a16da5.js";import"./Recipe-c53ee350.js";import"./Vaccine-8e495eea.js";const he={data(){return{cow:{image:null,file:null,code:"",name:"",status:1,birthDate:null,adopDate:null,corral:"",dad:"",mom:"",quality:1,weight:null},status:U("create"),quality:oe("create"),loading:!1,alert:""}},emits:["update:modelValue","cancel","confirm"],computed:{value:{get(){return this.modelValue},set(t){this.$emit("update:modelValue",t)}},user(){return this.$store.state.auth.user}},watch:{dataEdit:{handler(t,e){t!=null&&this.mode=="edit"&&(this.cow=t,this.cow.image=this.cow.image?this.cow.image:"/image/img-mockup.png")},deep:!0}},methods:{clear(){console.log("clear"),this.$emit("update:dataEdit",null),this.cow.image=null,this.cow.file=null,this.cow.code="",this.cow.name="",this.cow.birthDate="",this.cow.adopDate="",this.cow.status=1,this.cow.corral="",this.cow.dad="",this.cow.mom="",this.cow.weight=null,delete this.cow._id},confirmCancel(t){this.value=!1,this.$emit(t)},confirm(){this.clear(),this.confirmCancel("confirm")},cancel(){this.clear(),this.confirmCancel("cancel")},async submit(){this.loading=!0,this.alert="";try{const t=await v.create(this.cow);if(t){const e=t.data.newCow;e.file=this.cow.file,await v.upload(e),this.loading=!1,this.value=!1,this.confirm(),J.fire({icon:"success",title:"บันทึกข้อมูลสำเร็จ"})}}catch(t){console.error("Error : ",t),this.loading=!1,this.alert=t.response.data.message,J.fire({icon:"error",title:"บันทึกข้อมูลไม่สำเร็จ"})}},getFile(t){this.cow.file=t}},components:{BaseButton:K,BaseButtons:Z,CardBox:Q,BaseDivider:W,OverlayLayer:de,FormField:te,FormControl:le,NotificationBar:me,UserAvatar:ee,BaseLevel:$,ImageUpload:fe},props:{modelValue:{type:[String,Number,Boolean],default:null},mode:{type:String,default:""},dataEdit:{type:Object,default:null}}},_e={class:"grid lg:grid-cols-4 grid-cols-2 gap-5 mt-3"};function we(t,e,f,g,l,r){const V=i("ImageUpload"),x=i("BaseLevel"),c=i("FormControl"),u=i("FormField"),y=i("NotificationBar"),_=i("BaseDivider"),b=i("BaseButton"),k=i("BaseButtons"),q=i("CardBox"),S=i("OverlayLayer");return z((d(),h(S,null,{default:n(()=>[z(o(q,{title:f.mode==="create"?"เพิ่มโค":"แก้ไขโค",class:"shadow-lg w-full md:w-3/5 lg:w-1/1 z-50","header-icon":"close",modal:"",form:"",onSubmit:ne(r.submit,["prevent"]),onHeaderIconClick:r.cancel},{default:n(()=>[o(V,{modelValue:l.cow.image,"onUpdate:modelValue":e[0]||(e[0]=a=>l.cow.image=a),onFile:r.getFile},null,8,["modelValue","onFile"]),o(x,{type:"justify-center mb-6 text-sm"},{default:n(()=>[F(" อัพโหลดรูปภาพ (คลิกที่รูป) ")]),_:1}),m("div",_e,[o(u,{label:"รหัสโค",help:"* ห้ามว่าง"},{default:n(()=>[o(c,{modelValue:l.cow.code,"onUpdate:modelValue":e[1]||(e[1]=a=>l.cow.code=a),icon:"barcode",required:""},null,8,["modelValue"])]),_:1}),o(u,{label:"ชื่อโค",help:"* ห้ามว่าง"},{default:n(()=>[o(c,{modelValue:l.cow.name,"onUpdate:modelValue":e[2]||(e[2]=a=>l.cow.name=a),icon:"cow",required:""},null,8,["modelValue"])]),_:1}),o(u,{label:"น้ำหนัก(กก.)"},{default:n(()=>[o(c,{modelValue:l.cow.weight,"onUpdate:modelValue":e[3]||(e[3]=a=>l.cow.weight=a),icon:"scale",type:"number"},null,8,["modelValue"])]),_:1}),o(u,{label:"วันเกิด",help:"* ห้ามว่าง"},{default:n(()=>[o(c,{modelValue:l.cow.birthDate,"onUpdate:modelValue":e[4]||(e[4]=a=>l.cow.birthDate=a),icon:"calendar",type:"date",required:""},null,8,["modelValue"])]),_:1}),o(u,{label:"วันที่นำเข้าฟาร์ม",help:"* ห้ามว่าง"},{default:n(()=>[o(c,{modelValue:l.cow.adopDate,"onUpdate:modelValue":e[5]||(e[5]=a=>l.cow.adopDate=a),icon:"calendar",type:"date",required:""},null,8,["modelValue"])]),_:1}),o(u,{label:"สถานะ",help:"* ห้ามว่าง"},{default:n(()=>[o(c,{modelValue:l.cow.status,"onUpdate:modelValue":e[6]||(e[6]=a=>l.cow.status=a),options:l.status,icon:"",required:""},null,8,["modelValue","options"])]),_:1}),o(u,{label:"คุณภาพน้ำนม",help:"* ห้ามว่าง"},{default:n(()=>[o(c,{modelValue:l.cow.quality,"onUpdate:modelValue":e[7]||(e[7]=a=>l.cow.quality=a),options:l.quality,icon:""},null,8,["modelValue","options"])]),_:1}),o(u,{label:"คอก"},{default:n(()=>[o(c,{modelValue:l.cow.corral,"onUpdate:modelValue":e[8]||(e[8]=a=>l.cow.corral=a),icon:"barn"},null,8,["modelValue"])]),_:1}),o(u,{label:"พ่อพันธุ์"},{default:n(()=>[o(c,{modelValue:l.cow.dad,"onUpdate:modelValue":e[9]||(e[9]=a=>l.cow.dad=a),icon:"genderMale"},null,8,["modelValue"])]),_:1}),o(u,{label:"แม่พันธุ์"},{default:n(()=>[o(c,{modelValue:l.cow.mom,"onUpdate:modelValue":e[10]||(e[10]=a=>l.cow.mom=a),icon:"genderFemale"},null,8,["modelValue"])]),_:1})]),l.alert?(d(),h(y,{key:0,color:"danger",outline:"",icon:"alertCircleOutline"},{default:n(()=>[F(p(l.alert),1)]),_:1})):C("",!0),o(_),o(k,{type:"justify-center"},{default:n(()=>[o(b,{label:"บันทึก",color:"success",type:"submit",loading:l.loading},null,8,["loading"]),o(b,{label:"ยกเลิก",color:"danger",onClick:r.cancel},null,8,["onClick"])]),_:1})]),_:1},8,["title","onSubmit","onHeaderIconClick"]),[[R,r.value]])]),_:1},512)),[[R,r.value]])}const ye=X(he,[["render",we]]),be={data(){return{perPage:18,currentPage:0,modalCow:!1,cowStatus:U(),items:[],forms:[{label:"โค",value:"code",type:"ddl",module:"cow",valueType:"code"},{label:"สถานะ",value:"status",options:U()},{label:"คุณภาพน้ำนม",value:"quality",options:oe()},{label:"คอก",value:"corral",icon:"barn"}],search:{code:null,status:"",quality:"",corral:"",flag:"Y"},mode:"create",loading:!1}},computed:{itemsPaginated(){return this.items?this.items.slice(this.perPage*this.currentPage,this.perPage*(this.currentPage+1)):[]},numPages(){return Math.ceil((this.items?this.items.length:0)/this.perPage)},currentPageHuman(){return this.currentPage+1},pagesList(){const t=[];for(let e=0;e<this.numPages;e++)t.push(e);return t},user(){return this.$store.state.auth.user}},components:{SectionMain:se,LayoutAuthenticated:ae,BaseButton:K,BaseIcon:re,BaseButtons:Z,CardBox:Q,FormControl:le,FormField:te,BaseDivider:W,DDLCow:ge,CreateCowModal:ye,Table:ie,SectionTitleBarSub:ue,Criteria:ce,UserAvatar:ee,BaseLevel:$},created(){this.getCows()},methods:{async getCows(){this.loading=!0;const t=await v.all(this.search);this.items=[],t.data&&(this.items=t.data.cows,this.loading=!1)},async removeCow(t){this.loading=!0,(await v.update(t,{flag:"N"})).data&&this.getCows(),this.loading=!1},detail(t){this.$router.push({name:"cowDetail",params:{id:t._id}})},reset(){this.search.code=null,this.search.status="",this.search.quality="",this.search.corral=""},filter(t){const e={},f={},g={};return t.status==1?(e.icon="humanPregnant",e.style="text-blue-500 bg-indigo-900 rounded-full  p-1 mr-1"):t.status==2?(e.icon="waterOff",e.style="text-rose-500 bg-red-900 rounded-full p-1 mr-1"):t.status==3?(e.icon="water",e.style="text-white bg-teal-900 rounded-full p-1 mr-1"):t.status==4&&(e.icon="babyFaceOutline",e.style="text-yellow-500 bg-amber-900 rounded-full mr-1"),e.desc=this.cowStatus[t.status].label,t.grade==="A+"?f.style="text-lime-500":t.grade==="A"?f.style="text-green-500":t.grade==="B"?f.style="text-white":t.grade==="C"?f.style="text-orange-500":t.grade==="D"&&(f.style="text-red-500"),t.quality==1?(g.icon="medalOutline",g.style="text-green-600"):t.quality==3?(g.icon="medalOutline",g.style="text-red-600 "):t.quality==2&&(g.icon="medalOutline",g.style="text-gray-400"),{status:e,grade:f,quality:g}},calAge(t){return pe(t).ageString}}},Be={key:0,class:"grid lg:gap-3 md:gap-2 gap-1 grid-cols-3 lg:grid-cols-6 md:grid-cols-4"},Ce={class:"text-center font-extrabold"},ve={class:"text-center mt-2"},Ve={class:"lg:text-lg text-xs flex justify-center"},xe={class:"text-gray-400 mr-1"},ke={class:"justify-center flex mt-1 lg:p-2 p-1"},qe={key:1,class:"text-center py-10 text-gray-500 dark:text-gray-400"},Se=m("p",null," กำลังโหลดข้อมูล...",-1),De={class:"p-3 mt-2 border-t border-gray-100 dark:border-gray-800 dark:bg-gray-900 lg:rounded-lg shadow-lg"};function Fe(t,e,f,g,l,r){const V=i("SectionTitleBarSub"),x=i("CreateCowModal"),c=i("Criteria"),u=i("UserAvatar"),y=i("BaseLevel"),_=i("BaseIcon"),b=i("CardBox"),k=i("BaseButton"),q=i("BaseButtons"),S=i("SectionMain"),a=i("LayoutAuthenticated");return d(),h(a,null,{default:n(()=>[o(S,null,{default:n(()=>[o(V,{icon:"cow",title:"โค",btnText:"เพิ่มโค","has-btn-add":"",onOpenModal:e[0]||(e[0]=s=>{l.mode="create",l.modalCow=!0})}),o(x,{modelValue:l.modalCow,"onUpdate:modelValue":e[1]||(e[1]=s=>l.modalCow=s),onConfirm:r.getCows,mode:l.mode,dataEdit:t.dataEdit},null,8,["modelValue","onConfirm","mode","dataEdit"]),o(c,{grid:"grid-cols-2 md:grid-cols-3 lg:grid-cols-5",onSearch:r.getCows,onReset:r.reset,forms:l.forms,search:l.search},null,8,["onSearch","onReset","forms","search"]),l.loading?(d(),w("div",qe,[o(_,{path:"dotsCircle",size:"22",class:"animate-spin"}),Se])):(d(),w("div",Be,[(d(!0),w(G,null,Y(r.itemsPaginated,s=>(d(),h(b,{key:s.name,onClick:B=>r.detail(s),class:"bg-gray-200","has-table":"",hoverable:""},{default:n(()=>{var B,P,L,A,M,O,T,I,N,j,E,H;return[m("div",Ce,p(s.corral||"-"),1),o(y,{type:"justify-center"},{default:n(()=>[o(u,{username:"profile-card",class:"lg:w-24 lg:h-24 w-16 h-16 mt-2",avatar:s.image},null,8,["avatar"])]),_:2},1024),m("div",ve,[m("h4",Ve,[m("p",xe,p(s.code),1),F(" - "+p(s.name),1)]),m("div",ke,[s.grade?(d(),w("p",{key:0,class:D(((P=(B=r.filter(s))==null?void 0:B.grade)==null?void 0:P.style)+" flex items-center justify-center font-extrabold  lg:text-base text-sm text-center bg-gray-800 rounded-full lg:h-6 lg:w-6 w-4 h-4 shadow-xl mr-1")},[m("div",null,p(s.grade),1)],2)):C("",!0),s.status?(d(),h(_,{key:1,class:D((A=(L=r.filter(s))==null?void 0:L.status)==null?void 0:A.style),path:(O=(M=r.filter(s))==null?void 0:M.status)==null?void 0:O.icon,w:"w-4 lg:w-6",h:"h-4 lg:h-6"},null,8,["class","path"])):C("",!0),(I=(T=r.filter(s))==null?void 0:T.quality)!=null&&I.icon?(d(),h(_,{key:2,path:(j=(N=r.filter(s))==null?void 0:N.quality)==null?void 0:j.icon,w:"w-4 lg:w-6",h:"h-4 lg:h-6",class:D((H=(E=r.filter(s))==null?void 0:E.quality)==null?void 0:H.style)},null,8,["path","class"])):C("",!0)])])]}),_:2},1032,["onClick"]))),128))])),m("div",De,[o(y,null,{default:n(()=>[o(q,null,{default:n(()=>[(d(!0),w(G,null,Y(r.pagesList,s=>(d(),h(k,{key:s,active:s===l.currentPage,label:s+1,teeny:"",onClick:B=>l.currentPage=s},null,8,["active","label","onClick"]))),128))]),_:1}),m("small",null,"หน้า "+p(r.currentPageHuman)+" จาก "+p(r.numPages),1)]),_:1})])]),_:1})]),_:1})}const Ze=X(be,[["render",Fe]]);export{Ze as default};
