import{y as b,z as g,p as C,m as v,_ as S,l as T,F as w,i as M,j as F,f as k,N as x,E as n,G as h,H as y,o as D,c as V,w as r,d as o,s as N,e as L,S as U,C as E,D as O}from"./index-7127aab5.js";import{T as q}from"./Table-03458201.js";import{_ as A}from"./FormField-43f21bdf.js";import{_ as H}from"./FormCheckRadioPicker-06e43c39.js";import{T as I}from"./alert-993587e2.js";async function R(e={}){let t="?";return e.code&&(t=t+`code=${e.code}&`),e?t.replace(/&*$/,""):""}class ${async all(t){const m=await R(t);return b.get("/notiparam"+m).then(f=>f)}get(t){return b.get(`/notiparam/${t}`)}update(t,m){return b.put(`/notiparam/${t}`,m)}}const P=new $,z={data(){return{notiParam:{before:"",beforeType:"D",dueDate:!0,after:"",afterType:"D"},loading:!1,alert:""}},emits:["update:modelValue","cancel","confirm"],computed:{value:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}}},watch:{data:{handler(e,t){this.clear(),this.notiParam=e},deep:!0}},methods:{clear(){var e;this.$emit("update:data",null),this.notiParam.before="",this.notiParam.beforeType="D",this.notiParam.after="",this.notiParam.afterType="D",this.notiParam.dueDate=!0,(e=this.notiParam)==null||delete e._id},confirmCancel(e){this.value=!1,this.$emit(e)},confirm(){this.confirmCancel("confirm")},cancel(){this.confirmCancel("cancel")},async submit(){this.loading=!0,this.alert="";try{await P.update(this.notiParam._id,this.notiParam)&&(this.loading=!1,this.value=!1,this.confirm(),I.fire({icon:"success",title:"บันทึกข้อมูลสำเร็จ"}))}catch(e){console.error("Error : ",e),this.loading=!1,this.alert=e.response.data.message}}},components:{BaseButton:C,BaseButtons:v,CardBox:S,BaseDivider:T,OverlayLayer:w,FormField:A,FormControl:M,NotificationBar:F,BaseLevel:k,FormCheckRadioPicker:H,BaseIcon:x},props:{modelValue:{type:[String,Number,Boolean],default:null},data:{type:Object,default:null}}},j={class:"grid grid-cols-2 lg:grid-cols-3 gap-3 mt-1"};function G(e,t,m,f,a,i){const u=n("FormControl"),s=n("FormField"),d=n("FormCheckRadioPicker"),c=n("BaseButton"),p=n("BaseButtons"),_=n("CardBox"),B=n("OverlayLayer");return h((D(),V(B,null,{default:r(()=>[h(o(_,{title:"แก้ไขพารามิเตอร์ (การแจ้งเตือน)",class:"shadow-lg w-full lg:w-1/2 z-50","header-icon":"close",modal:"",form:"","has-scroll":"",onSubmit:L(i.submit,["prevent"]),onHeaderIconClick:i.cancel},{default:r(()=>[N("div",j,[o(s,{label:"ชื่อ",help:"* ห้ามว่าง"},{default:r(()=>[o(u,{modelValue:a.notiParam.name,"onUpdate:modelValue":t[0]||(t[0]=l=>a.notiParam.name=l),icon:"formTextbox",required:""},null,8,["modelValue"])]),_:1}),o(s,{label:"แจ้งเตือนวันมีผล",help:"* ห้ามว่าง"},{default:r(()=>[o(d,{modelValue:a.notiParam.dueDate,"onUpdate:modelValue":t[1]||(t[1]=l=>a.notiParam.dueDate=l),type:"radio",options:{true:"แจ้งเตือน",false:"ไม่แจ้งเตือน"}},null,8,["modelValue"])]),_:1}),o(s,{label:"แจ้งเตือน(ก่อน)"},{default:r(()=>[o(u,{modelValue:a.notiParam.before,"onUpdate:modelValue":t[2]||(t[2]=l=>a.notiParam.before=l),type:"number",icon:"formNumber"},null,8,["modelValue"])]),_:1}),o(s,{label:"ประเภทระยะเวลา(ก่อน)"},{default:r(()=>[o(d,{modelValue:a.notiParam.beforeType,"onUpdate:modelValue":t[3]||(t[3]=l=>a.notiParam.beforeType=l),type:"radio",options:{D:"วัน",M:"เดือน"}},null,8,["modelValue"])]),_:1}),o(s,{label:"แจ้งเตือน(หลัง)"},{default:r(()=>[o(u,{modelValue:a.notiParam.after,"onUpdate:modelValue":t[4]||(t[4]=l=>a.notiParam.after=l),icon:"formNumber",type:"number"},null,8,["modelValue"])]),_:1}),o(s,{label:"ประเภทระยะเวลา(หลัง)"},{default:r(()=>[o(d,{modelValue:a.notiParam.afterType,"onUpdate:modelValue":t[5]||(t[5]=l=>a.notiParam.afterType=l),type:"radio",options:{D:"วัน",M:"เดือน"}},null,8,["modelValue"])]),_:1})]),o(p,{type:"justify-center mt-3"},{default:r(()=>[o(c,{label:"บันทึก",color:"success",type:"submit",loading:a.loading},null,8,["loading"]),o(c,{label:"ยกเลิก",color:"danger",onClick:i.cancel},null,8,["onClick"])]),_:1})]),_:1},8,["onSubmit","onHeaderIconClick"]),[[y,i.value]])]),_:1},512)),[[y,i.value]])}const Q=g(z,[["render",G]]),J={data(){return{openModal:!1,modalData:null,items:[],forms:[],loading:!1,dataEdit:null,datas:[{label:"ชื่อ",value:"name"},{label:"แจ้งเตือนวันที่มีผล",func:e=>e.dueDate?"แจ้งเตือน":"ไม่แจ้งเตือน"},{label:"แจ้งเตือน (ก่อน)",func:e=>e.before?e.before:"-",class:"text-center"},{label:"หน่วย (ก่อน)",func:e=>e.beforeType=="D"?"วัน":"เดือน"},{label:"แจ้งเตือน (หลัง)",func:e=>e.after?e.after:"-",class:"text-center"},{label:"หน่วย (หลัง)",func:e=>e.afterType=="D"?"วัน":"เดือน"}],buttons:[{label:"แก้ไข",type:"edit",color:"warning"}]}},components:{SectionMain:U,LayoutAuthenticated:E,SectionTitleBarSub:O,Table:q,Modal:Q},computed:{getDataCopy(){return{...this.modalData}}},created(){this.getDatas()},methods:{async getDatas(e){this.loading=!0;const t=await P.all(e);this.items=[],t.data&&(this.items=t.data.notiParams),this.loading=!1},edit(e){this.modalData=e,this.openModal=!0}}};function K(e,t,m,f,a,i){const u=n("SectionTitleBarSub"),s=n("Modal"),d=n("Table"),c=n("SectionMain"),p=n("LayoutAuthenticated");return D(),V(p,null,{default:r(()=>[o(c,null,{default:r(()=>[o(u,{icon:"applicationVariableOutline",title:"พารามิเตอร์ (การแจ้งเตือน)"}),o(s,{modelValue:a.openModal,"onUpdate:modelValue":t[0]||(t[0]=_=>a.openModal=_),data:i.getDataCopy,mode:e.mode,onConfirm:i.getDatas},null,8,["modelValue","data","mode","onConfirm"]),o(d,{title:"รายการพารามิเตอร์ (การแจ้งเตือน)",items:a.items,datas:a.datas,buttons:a.buttons,onEdit:i.edit,onDelete:e.remove,onDeleteSelected:e.removeSelected,loading:a.loading},null,8,["items","datas","buttons","onEdit","onDelete","onDeleteSelected","loading"])]),_:1})]),_:1})}const te=g(J,[["render",K]]);export{te as default};
