import{Z as y,V as P,N as U,l as Y,_ as j,k as A,R as Z,g as N,h as J,e as R,Q as r,H as S,T as E,o as m,c as _,w as i,b as a,p as o,i as K,t as h,j as q,d as L,S as X,P as $,U as ee,$ as te,s as w,F,G as Q}from"./index.13a668bc.js";import{_ as H}from"./BaseButtons.5b9a86c4.js";import{_ as ae}from"./CardBoxModal.fe5e9f2d.js";import{_ as T}from"./FormField.812a9144.js";import{D as I,_ as le}from"./Cow.e63146eb.js";import{a as C}from"./auth-header.2a904230.js";async function ne(t={}){let e="?";if(t.cow&&(e=e+`cow=${t.cow}&`),t.date){const d=P(new Date(t.date)).format("YYYY-MM-DD");e=e+`date=${d}&`}return t.quantity&&(e=e+`quantity=${t.quantity}&`),t?e.replace(/&*$/,""):""}class oe{async all(e){const d=await ne(e);return y.get("/milking"+d,{headers:C()}).then(p=>p)}get(e){return y.get(`/milking/${e}`,{headers:C()})}create(e){return e.date&&(e.date=P(new Date(e.date)).format("YYYY-MM-DD")),y.post("/milking",e,{headers:C()})}delete(e){return y.delete(`/milking/${e}`,{headers:C()})}update(e,d){return y.put(`/milking/${e}`,d,{headers:C()})}}var B=new oe;const se={data(){return{milk:{cow:null,date:new Date,morningQty:0,afternoonQty:0,amount:0},loading:!1,alert:""}},emits:["update:modelValue","cancel","confirm"],computed:{sumQty(){return this.milk.morningQty+this.milk.afternoonQty},calAmount(){return this.milk.amount=(this.milk.morningQty+this.milk.afternoonQty)*100,this.milk.amount},value:{get(){return this.modelValue},set(t){this.$emit("update:modelValue",t)}}},watch:{dataEdit:{handler(t,e){t!=null&&this.mode=="edit"&&(this.milk=t,this.milk.date=new Date(t.date))},deep:!0}},methods:{clear(){var t;this.mode==="edit"&&this.$emit("update:dataEdit",null),this.milk.cow=null,this.milk.date=new Date,this.milk.morningQty=0,this.milk.afternoonQty=0,this.milk.amount=0,(t=this.milk)==null||delete t._id},confirmCancel(t){this.value=!1,this.$emit(t)},confirm(){this.clear(),this.confirmCancel("confirm")},cancel(){this.clear(),this.confirmCancel("cancel")},async submit(){this.loading=!0,this.alert="";try{this.mode==="create"?await B.create(this.milk)&&(this.loading=!1,this.value=!1,this.confirmCancel("confirm")):await B.update(this.milk._id,this.milk)&&(this.loading=!1,this.value=!1,this.confirmCancel("confirm"))}catch(t){console.error("Error : ",t),this.loading=!1,this.alert=t.response.data.message}}},components:{BaseButton:Y,BaseButtons:H,CardBox:j,BaseDivider:A,OverlayLayer:Z,FormField:T,FormControl:N,NotificationBar:J,BaseLevel:R,DDLCow:I},props:{modelValue:{type:[String,Number,Boolean],default:null},mode:{type:String,default:""},dataEdit:{type:Object,default:null}}},re={class:"grid grid-cols-1 lg:grid-cols-2 gap-3 mt-1"};function ie(t,e,d,p,n,s){const f=r("FormControl"),u=r("FormField"),v=r("DDLCow"),x=r("NotificationBar"),V=r("BaseDivider"),k=r("BaseButton"),M=r("BaseButtons"),D=r("CardBox"),g=r("OverlayLayer");return S((m(),_(g,null,{default:i(()=>[S(a(D,{title:d.mode==="create"?"\u0E40\u0E1E\u0E34\u0E48\u0E21\u0E01\u0E32\u0E23\u0E23\u0E35\u0E14\u0E19\u0E21":"\u0E41\u0E01\u0E49\u0E44\u0E02\u0E01\u0E32\u0E23\u0E23\u0E35\u0E14\u0E19\u0E21",class:"shadow-lg w-full overflow-y-auto lg:w-1/3 z-50","header-icon":"close",modal:"",form:"",onSubmit:L(s.submit,["prevent"]),onHeaderIconClick:s.cancel},{default:i(()=>[o("div",re,[a(u,{label:"\u0E27\u0E31\u0E19\u0E17\u0E35\u0E48\u0E23\u0E35\u0E14\u0E19\u0E21",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:i(()=>[a(f,{modelValue:n.milk.date,"onUpdate:modelValue":e[0]||(e[0]=c=>n.milk.date=c),icon:"calendar",type:"date",required:""},null,8,["modelValue"])]),_:1}),a(u,{label:"\u0E42\u0E04",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:i(()=>[a(v,{modelValue:n.milk.cow,"onUpdate:modelValue":e[1]||(e[1]=c=>n.milk.cow=c)},null,8,["modelValue"])]),_:1}),a(u,{label:"\u0E1B\u0E23\u0E34\u0E21\u0E32\u0E13\u0E19\u0E49\u0E33\u0E19\u0E21/\u0E40\u0E0A\u0E49\u0E32",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:i(()=>[a(f,{modelValue:n.milk.morningQty,"onUpdate:modelValue":e[2]||(e[2]=c=>n.milk.morningQty=c),type:"number",icon:"weatherSunsetUp"},null,8,["modelValue"])]),_:1}),a(u,{label:"\u0E1B\u0E23\u0E34\u0E21\u0E32\u0E13\u0E19\u0E49\u0E33\u0E19\u0E21/\u0E1A\u0E48\u0E32\u0E22",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:i(()=>[a(f,{modelValue:n.milk.afternoonQty,"onUpdate:modelValue":e[3]||(e[3]=c=>n.milk.afternoonQty=c),type:"number",icon:"weatherSunsetDown"},null,8,["modelValue"])]),_:1}),a(u,{label:"\u0E1B\u0E23\u0E34\u0E21\u0E32\u0E13\u0E19\u0E49\u0E33\u0E19\u0E21\u0E23\u0E27\u0E21",help:"\u0E04\u0E33\u0E19\u0E27\u0E13\u0E2D\u0E31\u0E15\u0E42\u0E19\u0E21\u0E31\u0E15\u0E34"},{default:i(()=>[a(f,{modelValue:s.sumQty,"onUpdate:modelValue":e[4]||(e[4]=c=>s.sumQty=c),type:"number",disabled:"",icon:"water"},null,8,["modelValue"])]),_:1}),a(u,{label:"\u0E08\u0E33\u0E19\u0E27\u0E19\u0E40\u0E07\u0E34\u0E19\u0E23\u0E27\u0E21",help:"\u0E04\u0E33\u0E19\u0E27\u0E13\u0E2D\u0E31\u0E15\u0E42\u0E19\u0E21\u0E31\u0E15\u0E34 (\u0E23\u0E32\u0E04\u0E32\u0E19\u0E21/\u0E01\u0E01. = 100.00)"},{default:i(()=>[a(f,{modelValue:s.calAmount,"onUpdate:modelValue":e[5]||(e[5]=c=>s.calAmount=c),type:"number",icon:"cashMultiple"},null,8,["modelValue"])]),_:1})]),n.alert?(m(),_(x,{key:0,color:"danger",outline:"",icon:"alertCircleOutline"},{default:i(()=>[K(h(n.alert),1)]),_:1})):q("",!0),a(V),a(M,{type:"justify-center"},{default:i(()=>[a(k,{label:"\u0E1A\u0E31\u0E19\u0E17\u0E36\u0E01",color:"success",type:"submit",loading:n.loading},null,8,["loading"]),a(k,{label:"\u0E22\u0E01\u0E40\u0E25\u0E34\u0E01",color:"danger",onClick:s.cancel},null,8,["onClick"])]),_:1})]),_:1},8,["title","onSubmit","onHeaderIconClick"]),[[E,s.value]])]),_:1},512)),[[E,s.value]])}var ce=U(se,[["render",ie]]);const de={data(){return{modalMilk:!1,textConfirm:"",modalConfirm:!1,funcConfirm:Function,idConfirm:null,perPage:10,currentPage:0,checkedRows:[],items:[],search:{cow:null,date:null},loading:!1,mode:"create",dataEdit:null}},components:{SectionMain:X,LayoutAuthenticated:$,BaseButton:Y,BaseIcon:ee,BaseButtons:H,CardBox:j,TableCheckboxCell:le,CardBoxModal:ae,BaseLevel:R,FormControl:N,FormField:T,BaseDivider:A,DDLCow:I,MilkModal:ce},created(){this.getMilks()},computed:{itemsPaginated(){return this.items?this.items.slice(this.perPage*this.currentPage,this.perPage*(this.currentPage+1)):[]},numPages(){return Math.ceil((this.items?this.items.length:0)/this.perPage)},currentPageHuman(){return this.currentPage+1},pagesList(){const t=[];for(let e=0;e<this.numPages;e++)t.push(e);return t}},methods:{async getMilks(){this.loading=!0;const t=await B.all(this.search);this.items=[],t.data&&(this.items=t.data.milkings),this.loading=!1},async removeMilk(){this.loading=!0,(await B.delete(this.idConfirm)).data&&this.getMilks(),this.loading=!1},edit(t){this.dataEdit=t,this.dataEdit.cow=t.cow._id,this.mode="edit",this.modalMilk=!0},reset(){this.search.cow=null,this.search.date=null},checked(t,e){t?(e.checked=!0,this.checkedRows.push(e)):(e.checked=!1,this.checkedRows=this.removeArr(this.checkedRows,d=>d._id===e._id))},removeArr(t,e){const d=[];return t.forEach(p=>{e(p)||d.push(p)}),d},confirm(t,e,d){this.textConfirm=t,this.funcConfirm=d,this.idConfirm=e,this.modalConfirm=!0},countChecked(){return this.checkedRows.length>0?"(\u0E40\u0E25\u0E37\u0E2D\u0E01 "+this.checkedRows.length+" \u0E23\u0E32\u0E22\u0E01\u0E32\u0E23)":""},formatDate(t){return t?P(new Date(t)).format("DD/MM/YYYY"):""},formatCurrency(t){return te(t).format(0,0)}}},ue={class:"px-6 sm:px-0 mb-6 flex items-center justify-between"},me={class:"flex items-center justify-start"},he=o("h1",{class:"text-2xl"}," \u0E01\u0E32\u0E23\u0E23\u0E35\u0E14\u0E19\u0E21 ",-1),fe={class:"grid grid-cols-2 lg:grid-cols-4 gap-5"},_e={key:0,class:"p-3 bg-gray-100/50 dark:bg-gray-800"},pe={class:"overflow-x-auto"},ge=o("thead",null,[o("tr",null,[o("th",{class:"text-center whitespace-nowrap"},"\u0E40\u0E25\u0E37\u0E2D\u0E01"),o("th",{class:"text-center whitespace-nowrap"},"\u0E42\u0E04"),o("th",{class:"text-center whitespace-nowrap"},"\u0E27\u0E31\u0E19\u0E17\u0E35\u0E48\u0E23\u0E35\u0E14\u0E19\u0E21"),o("th",{class:"text-center whitespace-nowrap"},"\u0E1B\u0E23\u0E34\u0E21\u0E32\u0E13\u0E19\u0E49\u0E33\u0E19\u0E21\u0E14\u0E34\u0E1A/\u0E40\u0E0A\u0E49\u0E32 (\u0E01\u0E01.)"),o("th",{class:"text-center whitespace-nowrap"},"\u0E1B\u0E23\u0E34\u0E21\u0E32\u0E13\u0E19\u0E49\u0E33\u0E19\u0E21\u0E14\u0E34\u0E1A/\u0E1A\u0E48\u0E32\u0E22 (\u0E01\u0E01.)"),o("th",{class:"text-center whitespace-nowrap"},"\u0E1B\u0E23\u0E34\u0E21\u0E32\u0E13\u0E19\u0E49\u0E33\u0E19\u0E21\u0E14\u0E34\u0E1A\u0E23\u0E27\u0E21 (\u0E01\u0E01.)"),o("th",{class:"text-center whitespace-nowrap"},"\u0E08\u0E33\u0E19\u0E27\u0E19\u0E40\u0E07\u0E34\u0E19\u0E23\u0E27\u0E21"),o("th")])],-1),we={"data-label":"\u0E42\u0E04",class:"whitespace-nowrap"},ke={"data-label":"\u0E27\u0E31\u0E19\u0E17\u0E35\u0E48\u0E23\u0E35\u0E14\u0E19\u0E21",class:"text-center"},ye={"data-label":"\u0E1B\u0E23\u0E34\u0E21\u0E32\u0E13\u0E19\u0E49\u0E33\u0E19\u0E21\u0E14\u0E34\u0E1A/\u0E40\u0E0A\u0E49\u0E32 (\u0E01\u0E01.)",class:"whitespace-nowrap text-center"},Ce={"data-label":"\u0E1B\u0E23\u0E34\u0E21\u0E32\u0E13\u0E19\u0E49\u0E33\u0E19\u0E21\u0E14\u0E34\u0E1A/\u0E1A\u0E48\u0E32\u0E22",class:"whitespace-nowrap text-center"},be={"data-label":"\u0E1B\u0E23\u0E34\u0E21\u0E32\u0E13\u0E19\u0E49\u0E33\u0E19\u0E21\u0E14\u0E34\u0E1A\u0E23\u0E27\u0E21",class:"whitespace-nowrap text-center"},Be={"data-label":"\u0E08\u0E33\u0E19\u0E27\u0E19\u0E40\u0E07\u0E34\u0E19\u0E23\u0E27\u0E21",class:"whitespace-nowrap text-right"},ve={class:"lg:w-6 whitespace-nowrap"},xe={class:"p-3 lg:px-6 border-t border-gray-100 dark:border-gray-800"};function Ve(t,e,d,p,n,s){const f=r("BaseIcon"),u=r("BaseButton"),v=r("MilkModal"),x=r("CardBoxModal"),V=r("DDLCow"),k=r("FormField"),M=r("FormControl"),D=r("BaseDivider"),g=r("BaseButtons"),c=r("CardBox"),O=r("TableCheckboxCell"),z=r("BaseLevel"),G=r("SectionMain"),W=r("LayoutAuthenticated");return m(),_(W,null,{default:i(()=>[a(G,null,{default:i(()=>[o("section",ue,[o("div",me,[a(f,{path:"cupWater",size:"30",class:"mr-3"}),he]),a(u,{label:"\u0E40\u0E1E\u0E34\u0E48\u0E21\u0E01\u0E32\u0E23\u0E23\u0E35\u0E14\u0E19\u0E21",color:"success",onClick:e[0]||(e[0]=l=>{n.mode="create",n.modalMilk=!0})})]),a(v,{modelValue:n.modalMilk,"onUpdate:modelValue":e[1]||(e[1]=l=>n.modalMilk=l),onConfirm:s.getMilks,onCancel:s.getMilks,mode:n.mode,dataEdit:n.dataEdit},null,8,["modelValue","onConfirm","onCancel","mode","dataEdit"]),a(x,{modelValue:n.modalConfirm,"onUpdate:modelValue":e[2]||(e[2]=l=>n.modalConfirm=l),title:"\u0E22\u0E37\u0E19\u0E22\u0E31\u0E19\u0E2D\u0E35\u0E01\u0E04\u0E23\u0E31\u0E49\u0E07","button-label":"\u0E22\u0E37\u0E19\u0E22\u0E31\u0E19",onConfirm:n.funcConfirm,"has-cancel":"","has-button":""},{default:i(()=>[o("p",null,h(n.textConfirm),1)]),_:1},8,["modelValue","onConfirm"]),a(c,{title:"\u0E04\u0E49\u0E19\u0E2B\u0E32\u0E01\u0E32\u0E23\u0E23\u0E35\u0E14\u0E19\u0E21",icon:"",form:"",class:"mb-3","header-icon":"",onSubmit:L(s.getMilks,["prevent"]),onReset:L(s.reset,["prevent"])},{default:i(()=>[o("div",fe,[a(k,{label:"\u0E42\u0E04",class:"lg:col-start-2"},{default:i(()=>[a(V,{modelValue:n.search.cow,"onUpdate:modelValue":e[3]||(e[3]=l=>n.search.cow=l)},null,8,["modelValue"])]),_:1}),a(k,{label:"\u0E27\u0E31\u0E19\u0E17\u0E35\u0E48\u0E23\u0E35\u0E14\u0E19\u0E21"},{default:i(()=>[a(M,{modelValue:n.search.date,"onUpdate:modelValue":e[4]||(e[4]=l=>n.search.date=l),icon:"calendar",type:"date"},null,8,["modelValue"])]),_:1})]),a(D),a(g,{type:"justify-center","no-wrap":""},{default:i(()=>[a(u,{type:"submit",color:"info",label:"\u0E04\u0E49\u0E19\u0E2B\u0E32"}),a(u,{type:"reset",color:"danger",label:"\u0E25\u0E49\u0E32\u0E07"})]),_:1})]),_:1},8,["onSubmit","onReset"]),s.itemsPaginated.length>0?(m(),_(c,{key:0,title:"\u0E23\u0E32\u0E22\u0E01\u0E32\u0E23\u0E23\u0E35\u0E14\u0E19\u0E21 "+s.countChecked(),class:"shadow-lg","has-table":"","header-icon":""},{default:i(()=>[n.checkedRows.length>0?(m(),w("div",_e,[(m(!0),w(F,null,Q(n.checkedRows,l=>(m(),w("span",{key:l._id,class:"inline-block px-2 py-1 rounded-sm mr-2 text-sm bg-gray-100 dark:bg-gray-700 mb-1"},h(l.cow.name),1))),128)),a(g,{type:"justify-start lg:justify-end","no-wrap":""},{default:i(()=>[a(u,{color:"danger",label:"\u0E25\u0E1A\u0E17\u0E31\u0E49\u0E07\u0E2B\u0E21\u0E14",onClick:e[5]||(e[5]=l=>t.isModalActive=!0)})]),_:1})])):q("",!0),o("div",pe,[o("table",null,[ge,o("tbody",null,[(m(!0),w(F,null,Q(s.itemsPaginated,l=>(m(),w("tr",{key:l._id},[a(O,{isChecked:l.checked,class:"text-center border-b-0 lg:w-6 before:hidden",onChecked:b=>s.checked(b,l)},null,8,["isChecked","onChecked"]),o("td",we,h(l.cow.code+" : "+l.cow.name),1),o("td",ke,h(s.formatDate(l.date)),1),o("td",ye,h(l.morningQty),1),o("td",Ce,h(l.afternoonQty),1),o("td",be,h(l.morningQty+l.afternoonQty),1),o("td",Be,h(s.formatCurrency(l.amount)),1),o("td",ve,[a(g,{type:"justify-end lg:justify-start","no-wrap":""},{default:i(()=>[a(u,{color:"danger",label:"\u0E25\u0E1A",onClick:b=>s.confirm("\u0E22\u0E37\u0E19\u0E22\u0E31\u0E19\u0E25\u0E1A\u0E01\u0E32\u0E23\u0E23\u0E35\u0E14\u0E19\u0E21\u0E02\u0E2D\u0E07\u0E42\u0E04 "+l.cow.name+" \u0E43\u0E0A\u0E48\u0E2B\u0E23\u0E37\u0E2D\u0E44\u0E21\u0E48 ?",l._id,s.removeMilk)},null,8,["onClick"]),a(u,{color:"warning",label:"\u0E41\u0E01\u0E49\u0E44\u0E02",onClick:b=>s.edit(l)},null,8,["onClick"])]),_:2},1024)])]))),128))])])]),o("div",xe,[a(z,null,{default:i(()=>[a(g,null,{default:i(()=>[(m(!0),w(F,null,Q(s.pagesList,l=>(m(),_(u,{key:l,active:l===n.currentPage,label:l+1,small:"",onClick:b=>n.currentPage=l},null,8,["active","label","onClick"]))),128))]),_:1}),o("small",null,"\u0E2B\u0E19\u0E49\u0E32 "+h(s.currentPageHuman)+" \u0E08\u0E32\u0E01 "+h(s.numPages),1)]),_:1})])]),_:1},8,["title"])):n.loading?(m(),_(c,{key:1,loading:""})):(m(),_(c,{key:2,empty:""}))]),_:1})]),_:1})}var Se=U(de,[["render",Ve]]);export{Se as default};
