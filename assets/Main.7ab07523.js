import{N as _,O as N,P as T,a2 as O,l as U,_ as L,k as E,T as R,g as H,h as A,e as I,V as Q,R as c,H as k,U as S,o as p,c as C,w as s,b as l,p as r,i as q,t as h,j as M,s as w,F as z,G,d as P,S as W,Q as j,W as J}from"./index.6537d914.js";import{T as K,a as X}from"./Criteria.895e36f8.js";import{_ as Y}from"./BaseButtons.a94d0ccd.js";import{_ as Z}from"./FormField.3f228d48.js";import{D as $}from"./Vaccine.c2ad37f4.js";import{T as x}from"./alert.92a69448.js";import{a as g}from"./auth-header.b6eae63e.js";import"./CardBoxModal.bde56a9f.js";async function ee(t={}){let e="?";return t.farm&&(e=e+`farm=${t.farm}&`),t.type&&(e=e+`type=${t.type}&`),t.recipe&&(e=e+`recipe=${t.recipe}&`),t?e.replace(/&*$/,""):""}class te{async all(e){const n=await ee(e);return _.get("/recipe"+n,{headers:g()}).then(y=>y)}get(e){return _.get(`/recipe/${e}`,{headers:g()})}create(e){return _.post("/recipe",e,{headers:g()})}delete(e){return _.delete(`/recipe/${e}`,{headers:g()})}update(e,n){return _.put(`/recipe/${e}`,n,{headers:g()})}}var V=new te;const B=t=>t==="create"?[{id:1,label:"\u0E2B\u0E22\u0E32\u0E1A"},{id:2,label:"\u0E1C\u0E2A\u0E21\u0E40\u0E2D\u0E07"},{id:3,label:"\u0E2A\u0E33\u0E40\u0E23\u0E47\u0E08\u0E23\u0E39\u0E1B"}]:[{id:"",label:"\u0E17\u0E31\u0E49\u0E07\u0E2B\u0E21\u0E14"},{id:1,label:"\u0E2B\u0E22\u0E32\u0E1A"},{id:2,label:"\u0E1C\u0E2A\u0E21\u0E40\u0E2D\u0E07"},{id:3,label:"\u0E2A\u0E33\u0E40\u0E23\u0E47\u0E08\u0E23\u0E39\u0E1B"}],ae={data(){return{recipe:{code:"",name:"",type:1,amount:"",farm:T().farm._id},recipeDetail:{},recipeDetails:[],type:B("create"),loading:!1,alert:"",alertDetail:""}},emits:["update:modelValue","cancel","confirm"],computed:{value:{get(){return this.modelValue},set(t){this.$emit("update:modelValue",t)}}},watch:{data(t){t&&this.mode==="edit"&&(this.recipe=t,this.recipe.dateCurrent=new Date(t.dateCurrent),this.recipe.dateNext=new Date(t.dateNext))},"recipe.frequency"(t){t&&(this.recipe.dateNext=O(new Date(this.recipe.dateCurrent),t))},"recipeDetail.cost"(t){var e,n;t&&((e=this.recipeDetail)==null?void 0:e.qty)?this.recipeDetail.amount=t*((n=this.recipeDetail)==null?void 0:n.qty):this.recipeDetail.amount=null},"recipeDetail.qty"(t){var e,n;t&&((e=this.recipeDetail)==null?void 0:e.cost)?this.recipeDetail.amount=t*((n=this.recipeDetail)==null?void 0:n.cost):this.recipeDetail.amount=null}},methods:{clear(){this.recipe.dateCurrent=new Date,this.recipe.dateNext=null,this.recipe.vaccine="",this.recipe.frequency="",this.recipe.remark=""},confirmCancel(t){this.value=!1,this.$emit(t)},confirm(){this.clear(),this.confirmCancel("confirm")},cancel(){this.clear(),this.confirmCancel("cancel")},addDetail(){var t,e,n;this.alertDetail="",((t=this.recipeDetail)==null?void 0:t.food)&&((e=this.recipeDetail)==null?void 0:e.qty)&&((n=this.recipeDetail)==null?void 0:n.cost)?this.recipeDetails.filter(a=>{var o;return a.food===((o=this.recipeDetail)==null?void 0:o.food)}).length<=0?(this.recipeDetails.push(this.recipeDetail),this.recipeDetail={}):this.alertDetail="\u0E2D\u0E32\u0E2B\u0E32\u0E23/\u0E27\u0E31\u0E15\u0E16\u0E38\u0E14\u0E34\u0E1A \u0E0B\u0E49\u0E33":this.alertDetail="\u0E01\u0E23\u0E38\u0E13\u0E32\u0E01\u0E23\u0E2D\u0E01\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25\u0E43\u0E2B\u0E49\u0E04\u0E23\u0E1A"},removeDetail(t){let e=this.recipeDetails.indexOf(t);e!==-1&&this.recipeDetails.splice(e,1)},async submit(){this.loading=!0,this.alert="";try{this.mode==="create"?await V.create(this.recipe)&&(this.loading=!1,this.value=!1,this.confirmCancel("confirm")):await V.update(this.recipe._id,this.recipe)&&(this.loading=!1,this.value=!1,this.confirmCancel("confirm")),x.fire({icon:"success",title:"\u0E1A\u0E31\u0E19\u0E17\u0E36\u0E01\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25\u0E2A\u0E33\u0E40\u0E23\u0E47\u0E08"})}catch(t){console.error("Error : ",t),this.clear(),this.loading=!1,this.alert=await t.response.data.message,x.fire({icon:"error",title:"\u0E1A\u0E31\u0E19\u0E17\u0E36\u0E01\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25\u0E44\u0E21\u0E48\u0E2A\u0E33\u0E40\u0E23\u0E47\u0E08"})}}},components:{BaseButton:U,BaseButtons:Y,CardBox:L,BaseDivider:E,OverlayLayer:R,FormField:Z,FormControl:H,NotificationBar:A,BaseLevel:I,DDLVaccine:$,BaseIcon:Q},props:{modelValue:{type:[String,Number,Boolean],default:null},data:{type:Object,default:null},mode:{type:String,default:""}}},le={class:"grid grid-cols-2 lg:grid-cols-4 gap-5"},ie={class:"grid grid-cols-2 lg:grid-cols-6 gap-5"},re=r("header",{class:"flex items-stretch border-b border-gray-100 dark:border-gray-800"},[r("p",{class:"flex items-center py-3 grow font-bold"}," \u0E23\u0E32\u0E22\u0E01\u0E32\u0E23\u0E2D\u0E32\u0E2B\u0E32\u0E23/\u0E27\u0E31\u0E15\u0E16\u0E38\u0E14\u0E34\u0E1A ")],-1),oe={key:1,class:"overflow-x-auto"},se=r("thead",null,[r("tr",null,[r("th",{class:"whitespace-nowrap text-center"}," \u0E2D\u0E32\u0E2B\u0E32\u0E23/\u0E27\u0E31\u0E15\u0E16\u0E38\u0E14\u0E34\u0E1A "),r("th",{class:"whitespace-nowrap text-center"}," \u0E23\u0E32\u0E04\u0E32/\u0E01\u0E01. "),r("th",{class:"whitespace-nowrap text-center"}," \u0E08\u0E33\u0E19\u0E27\u0E19\u0E17\u0E35\u0E48\u0E43\u0E0A\u0E49 (\u0E01\u0E01.) "),r("th",{class:"whitespace-nowrap text-center"}," \u0E08\u0E33\u0E19\u0E27\u0E19\u0E40\u0E07\u0E34\u0E19 "),r("th")])],-1),ne={"data-label":"\u0E2D\u0E32\u0E2B\u0E32\u0E23/\u0E27\u0E31\u0E15\u0E16\u0E38\u0E14\u0E34\u0E1A"},ce={"data-label":"\u0E23\u0E32\u0E04\u0E32/\u0E01\u0E01.",class:"text-center"},de={"data-label":"\u0E08\u0E33\u0E19\u0E27\u0E19\u0E17\u0E35\u0E48\u0E43\u0E0A\u0E49 (\u0E01\u0E01.)",class:"text-center"},ue={"data-label":"\u0E08\u0E33\u0E19\u0E27\u0E19\u0E40\u0E07\u0E34\u0E19",class:"text-right"},pe={class:"lg:w-6 whitespace-nowrap"},me={key:2,class:"text-center py-10 text-gray-500 dark:text-gray-400"},he=r("p",null,"\u0E44\u0E21\u0E48\u0E21\u0E35\u0E23\u0E32\u0E22\u0E01\u0E32\u0E23...",-1),fe=[he];function _e(t,e,n,y,a,o){const d=c("FormControl"),u=c("FormField"),m=c("BaseButton"),f=c("BaseButtons"),D=c("NotificationBar"),b=c("CardBox"),v=c("BaseDivider"),F=c("OverlayLayer");return k((p(),C(F,null,{default:s(()=>[k(l(b,{title:(this.mode==="create"?"\u0E1A\u0E31\u0E19\u0E17\u0E36\u0E01":"\u0E41\u0E01\u0E49\u0E44\u0E02")+"\u0E2A\u0E39\u0E15\u0E23\u0E2D\u0E32\u0E2B\u0E32\u0E23",class:"shadow-lg w-full overflow-y-auto lg:w-2/3 z-50","header-icon":"close",modal:"",form:"",onSubmit:P(o.submit,["prevent"]),onHeaderIconClick:o.cancel},{default:s(()=>[r("div",le,[l(u,{label:"\u0E0A\u0E37\u0E48\u0E2D\u0E2A\u0E39\u0E15\u0E23\u0E2D\u0E32\u0E2B\u0E32\u0E23",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:s(()=>[l(d,{modelValue:a.recipe.name,"onUpdate:modelValue":e[0]||(e[0]=i=>a.recipe.name=i),icon:"potMixOutline",required:""},null,8,["modelValue"])]),_:1}),l(u,{label:"\u0E1B\u0E23\u0E30\u0E40\u0E20\u0E17\u0E2D\u0E32\u0E2B\u0E32\u0E23",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:s(()=>[l(d,{modelValue:a.recipe.type,"onUpdate:modelValue":e[1]||(e[1]=i=>a.recipe.type=i),options:a.type,required:""},null,8,["modelValue","options"])]),_:1}),l(u,{label:"\u0E08\u0E33\u0E19\u0E27\u0E19\u0E40\u0E07\u0E34\u0E19\u0E23\u0E27\u0E21/\u0E2A\u0E39\u0E15\u0E23"},{default:s(()=>[l(d,{modelValue:a.recipe.amount,"onUpdate:modelValue":e[2]||(e[2]=i=>a.recipe.amount=i),icon:"cashMultiple",type:"number",disabled:"",required:""},null,8,["modelValue"])]),_:1})]),l(b,{title:"\u0E23\u0E32\u0E22\u0E25\u0E30\u0E40\u0E2D\u0E35\u0E22\u0E14\u0E2A\u0E39\u0E15\u0E23\u0E2D\u0E32\u0E2B\u0E32\u0E23",class:"shadow-lg dark:bg-slate-700","header-icon":""},{default:s(()=>[r("div",ie,[l(u,{label:"\u0E2D\u0E32\u0E2B\u0E32\u0E23/\u0E27\u0E31\u0E15\u0E16\u0E38\u0E14\u0E34\u0E1A",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07",class:"col-span-2"},{default:s(()=>[l(d,{modelValue:a.recipeDetail.food,"onUpdate:modelValue":e[3]||(e[3]=i=>a.recipeDetail.food=i),icon:"foodVariant",required:""},null,8,["modelValue"])]),_:1}),l(u,{label:"\u0E23\u0E32\u0E04\u0E32/\u0E01\u0E01.",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:s(()=>[l(d,{modelValue:a.recipeDetail.cost,"onUpdate:modelValue":e[4]||(e[4]=i=>a.recipeDetail.cost=i),icon:"cash",type:"number",required:""},null,8,["modelValue"])]),_:1}),l(u,{label:"\u0E08\u0E33\u0E19\u0E27\u0E19\u0E17\u0E35\u0E48\u0E43\u0E0A\u0E49 (\u0E01\u0E01.)",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:s(()=>[l(d,{icon:"scale",modelValue:a.recipeDetail.qty,"onUpdate:modelValue":e[5]||(e[5]=i=>a.recipeDetail.qty=i),required:""},null,8,["modelValue"])]),_:1}),l(u,{label:"\u0E08\u0E33\u0E19\u0E27\u0E19\u0E40\u0E07\u0E34\u0E19"},{default:s(()=>[l(d,{modelValue:a.recipeDetail.amount,"onUpdate:modelValue":e[6]||(e[6]=i=>a.recipeDetail.amount=i),icon:"cashMultiple",type:"number",disabled:"",required:""},null,8,["modelValue"])]),_:1}),l(f,{type:"justify-center"},{default:s(()=>[l(m,{label:"\u0E40\u0E1E\u0E34\u0E48\u0E21",color:"success",onClick:o.addDetail},null,8,["onClick"]),l(m,{label:"\u0E25\u0E49\u0E32\u0E07",color:"danger",onClick:e[7]||(e[7]=i=>t.resetDetail())})]),_:1})]),a.alertDetail?(p(),C(D,{key:0,color:"warning",outline:"",icon:"alertCircleOutline"},{default:s(()=>[q(h(a.alertDetail),1)]),_:1})):M("",!0),re,a.recipeDetails.length>0?(p(),w("div",oe,[r("table",null,[se,r("tbody",null,[(p(!0),w(z,null,G(a.recipeDetails,i=>(p(),w("tr",{key:i.food},[r("td",ne,h(i.food),1),r("td",ce,h(i.cost),1),r("td",de,h(i.qty),1),r("td",ue,h(i.amount),1),r("td",pe,[l(f,{type:"justify-end lg:justify-start","no-wrap":""},{default:s(()=>[l(m,{color:"danger",label:"\u0E25\u0E1A",onClick:be=>o.removeDetail(i)},null,8,["onClick"])]),_:2},1024)])]))),128))])])])):(p(),w("div",me,fe))]),_:1}),a.alert?(p(),C(D,{key:0,color:"danger",outline:"",icon:"alertCircleOutline"},{default:s(()=>[q(h(a.alert),1)]),_:1})):M("",!0),l(v),l(f,{type:"justify-center"},{default:s(()=>[l(m,{label:"\u0E1A\u0E31\u0E19\u0E17\u0E36\u0E01",color:"success",type:"submit",loading:a.loading},null,8,["loading"]),l(m,{label:"\u0E22\u0E01\u0E40\u0E25\u0E34\u0E01",color:"danger",onClick:o.cancel},null,8,["onClick"])]),_:1})]),_:1},8,["title","onSubmit","onHeaderIconClick"]),[[S,o.value]])]),_:1},512)),[[S,o.value]])}var ge=N(ae,[["render",_e]]);const ye={data(){return{openModal:!1,modalData:null,items:[],forms:[{label:"\u0E2A\u0E39\u0E15\u0E23\u0E2D\u0E32\u0E2B\u0E32\u0E23",value:"recipe",icon:"recipe"},{label:"\u0E1B\u0E23\u0E30\u0E40\u0E20\u0E17",value:"type",options:B()}],search:{recipe:"",type:"",farm:T().farm._id},loading:!1,mode:"create",dataEdit:null,checked:{code:{value:"code"},label:{value:"name"}},datas:[{label:"\u0E2A\u0E39\u0E15\u0E23\u0E2D\u0E32\u0E2B\u0E32\u0E23",class:"text-center",func:t=>t.code+" : "+t.name},{label:"\u0E1B\u0E23\u0E30\u0E40\u0E20\u0E17",class:"text-center",func:t=>B()[t.type].label},{label:"\u0E15\u0E49\u0E19\u0E17\u0E38\u0E19/\u0E01\u0E01.",class:"text-center",value:"amount"}],buttons:[{label:"\u0E25\u0E1A",type:"delete",color:"danger"},{label:"\u0E41\u0E01\u0E49\u0E44\u0E02",type:"edit",color:"warning"}]}},components:{SectionMain:W,LayoutAuthenticated:j,SectionTitleBarSub:J,Table:K,Modal:ge,Criteria:X},created(){this.getDatas()},methods:{async getDatas(t){this.loading=!0;const e=await V.all(t);this.items=[],e.data&&(this.items=e.data.recipes),this.loading=!1},async remove(t){this.loading=!0,(await V.delete(t)).data&&this.getDatas(),this.loading=!1,x.fire({icon:"success",title:"\u0E25\u0E1A\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25\u0E2A\u0E33\u0E40\u0E23\u0E47\u0E08"})},edit(t){this.modalData=t,this.mode="edit",this.openModal=!0},reset(){this.search.recipe="",this.search.type="",this.getDatas()}}};function De(t,e,n,y,a,o){const d=c("SectionTitleBarSub"),u=c("Modal"),m=c("Criteria"),f=c("Table"),D=c("SectionMain"),b=c("LayoutAuthenticated");return p(),C(b,null,{default:s(()=>[l(D,null,{default:s(()=>[l(d,{icon:"calculatorVariantOutline",title:"\u0E2A\u0E39\u0E15\u0E23\u0E2D\u0E32\u0E2B\u0E32\u0E23","has-btn-add":"",onOpenModal:e[0]||(e[0]=v=>{a.mode="create",a.openModal=!0}),btnText:"\u0E40\u0E1E\u0E34\u0E48\u0E21\u0E2A\u0E39\u0E15\u0E23\u0E2D\u0E32\u0E2B\u0E32\u0E23"}),l(u,{modelValue:a.openModal,"onUpdate:modelValue":e[1]||(e[1]=v=>a.openModal=v),data:a.modalData,mode:a.mode,onConfirm:o.getDatas,onCancel:o.getDatas},null,8,["modelValue","data","mode","onConfirm","onCancel"]),l(m,{grid:"grid-cols-2 lg:grid-cols-4",onSearch:o.getDatas,onReset:o.reset,forms:a.forms,search:a.search},null,8,["onSearch","onReset","forms","search"]),l(f,{title:"\u0E23\u0E32\u0E22\u0E01\u0E32\u0E23\u0E2A\u0E39\u0E15\u0E23\u0E2D\u0E32\u0E2B\u0E32\u0E23","has-checkbox":"","checked-data":a.checked,items:a.items,datas:a.datas,buttons:a.buttons,onEdit:o.edit,onDelete:o.remove,onDeleteSelected:t.removeSelected,loading:a.loading},null,8,["checked-data","items","datas","buttons","onEdit","onDelete","onDeleteSelected","loading"])]),_:1})]),_:1})}var qe=N(ye,[["render",De]]);export{qe as default};
