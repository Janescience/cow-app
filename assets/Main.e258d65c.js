import{K as B,a9 as b,p as S,m as k,_ as w,l as N,$ as M,i as q,j as T,f as F,X as L,N as n,P as C,W as y,o as _,c as v,w as r,d as a,s as O,h as U,t as E,k as P,e as j,S as A,L as I,M as R}from"./index.664144a8.js";import{T as H}from"./Table.9b7e182c.js";import{C as z}from"./Criteria.90e0d8f0.js";import{_ as K}from"./FormField.8bbe3c5b.js";import{T as g}from"./alert.c1f6947c.js";import{P as m}from"./protection.3a71ba24.js";import{_ as W}from"./FormCheckRadioPicker.45cdfa4b.js";import"./Cow.f24886e5.js";import"./cow.4e92f3c6.js";const X={data(){return{protection:{dateCurrent:new Date,dateNext:null,vaccine:"",frequency:null,remark:""},loading:!1,alert:""}},emits:["update:modelValue","cancel","confirm"],computed:{value:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}},user(){return this.$store.state.auth.user}},watch:{data(e){e&&this.mode==="edit"&&(this.protection=e,this.protection.dateCurrent=new Date(e.dateCurrent),this.protection.dateNext=new Date(e.dateNext))},"protection.frequency"(e){e&&(this.protection.dateNext=b(new Date(this.protection.dateCurrent),e))},"protection.dateCurrent"(e){e&&(this.protection.dateNext=b(new Date(e),this.protection.frequency))}},methods:{clear(){this.protection.dateCurrent=new Date,this.protection.dateNext=null,this.protection.vaccine="",this.protection.frequency="",this.protection.remark=""},confirmCancel(e){this.value=!1,this.$emit(e)},confirm(){this.clear(),this.confirmCancel("confirm")},cancel(){this.clear(),this.confirmCancel("cancel")},async submit(){this.loading=!0,this.alert="";try{this.mode==="create"?await m.create(this.protection)&&(this.loading=!1,this.value=!1,this.confirmCancel("confirm")):await m.update(this.protection._id,this.protection)&&(this.loading=!1,this.value=!1,this.confirmCancel("confirm")),g.fire({icon:"success",title:"\u0E1A\u0E31\u0E19\u0E17\u0E36\u0E01\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25\u0E2A\u0E33\u0E40\u0E23\u0E47\u0E08"})}catch(e){console.error("Error : ",e),this.clear(),this.loading=!1,this.alert=await e.response.data.message,g.fire({icon:"error",title:"\u0E1A\u0E31\u0E19\u0E17\u0E36\u0E01\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25\u0E44\u0E21\u0E48\u0E2A\u0E33\u0E40\u0E23\u0E47\u0E08"})}}},components:{BaseButton:S,BaseButtons:k,CardBox:w,BaseDivider:N,OverlayLayer:M,FormField:K,FormControl:q,NotificationBar:T,BaseLevel:F,FormCheckRadioPicker:W,BaseIcon:L},props:{modelValue:{type:[String,Number,Boolean],default:null},data:{type:Object,default:null},mode:{type:String,default:""}}},G={class:"grid grid-cols-2 lg:grid-cols-3 gap-8"};function J(e,o,x,V,t,l){const s=n("FormControl"),c=n("FormField"),p=n("NotificationBar"),f=n("BaseDivider"),d=n("BaseButton"),h=n("BaseButtons"),u=n("CardBox"),D=n("OverlayLayer");return C((_(),v(D,null,{default:r(()=>[C(a(u,{title:(this.mode==="create"?"\u0E1A\u0E31\u0E19\u0E17\u0E36\u0E01":"\u0E41\u0E01\u0E49\u0E44\u0E02")+"\u0E01\u0E32\u0E23\u0E1B\u0E49\u0E2D\u0E07\u0E01\u0E31\u0E19/\u0E1A\u0E33\u0E23\u0E38\u0E07",class:"shadow-lg w-full lg:w-1/2 z-50","header-icon":"close",modal:"",form:"",onSubmit:j(l.submit,["prevent"]),onHeaderIconClick:l.cancel},{default:r(()=>[O("div",G,[a(c,{label:"\u0E27\u0E31\u0E04\u0E0B\u0E35\u0E19",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:r(()=>[a(s,{modelValue:t.protection.vaccine,"onUpdate:modelValue":o[0]||(o[0]=i=>t.protection.vaccine=i),icon:"needle",required:""},null,8,["modelValue"])]),_:1}),a(c,{label:"\u0E04\u0E27\u0E32\u0E21\u0E16\u0E35\u0E48/\u0E27\u0E31\u0E04\u0E0B\u0E35\u0E19 (\u0E40\u0E14\u0E37\u0E2D\u0E19)",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:r(()=>[a(s,{modelValue:t.protection.frequency,"onUpdate:modelValue":o[1]||(o[1]=i=>t.protection.frequency=i),icon:"calendarClock",type:"number",required:""},null,8,["modelValue"])]),_:1}),a(c,{label:"\u0E09\u0E35\u0E14\u0E27\u0E31\u0E04\u0E0B\u0E35\u0E19\u0E25\u0E48\u0E32\u0E2A\u0E38\u0E14",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:r(()=>[a(s,{modelValue:t.protection.dateCurrent,"onUpdate:modelValue":o[2]||(o[2]=i=>t.protection.dateCurrent=i),icon:"calendar",type:"date",required:""},null,8,["modelValue"])]),_:1}),a(c,{label:"\u0E09\u0E35\u0E14\u0E27\u0E31\u0E04\u0E0B\u0E35\u0E19\u0E04\u0E23\u0E31\u0E49\u0E07\u0E15\u0E48\u0E2D\u0E44\u0E1B",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:r(()=>[a(s,{modelValue:t.protection.dateNext,"onUpdate:modelValue":o[3]||(o[3]=i=>t.protection.dateNext=i),icon:"calendar",type:"date",required:""},null,8,["modelValue"])]),_:1}),a(c,{label:"\u0E2B\u0E21\u0E32\u0E22\u0E40\u0E2B\u0E15\u0E38",class:"col-span-2"},{default:r(()=>[a(s,{modelValue:t.protection.remark,"onUpdate:modelValue":o[4]||(o[4]=i=>t.protection.remark=i),type:"textarea"},null,8,["modelValue"])]),_:1})]),t.alert?(_(),v(p,{key:0,color:"danger",outline:"",icon:"alertCircleOutline"},{default:r(()=>[U(E(t.alert),1)]),_:1})):P("",!0),a(f),a(h,{type:"justify-center"},{default:r(()=>[a(d,{label:"\u0E1A\u0E31\u0E19\u0E17\u0E36\u0E01",color:"success",type:"submit",loading:t.loading},null,8,["loading"]),a(d,{label:"\u0E22\u0E01\u0E40\u0E25\u0E34\u0E01",color:"danger",onClick:l.cancel},null,8,["onClick"])]),_:1})]),_:1},8,["title","onSubmit","onHeaderIconClick"]),[[y,l.value]])]),_:1},512)),[[y,l.value]])}var Q=B(X,[["render",J]]);const Y={data(){return{openModal:!1,modalData:null,items:[],forms:[{label:"\u0E27\u0E31\u0E04\u0E0B\u0E35\u0E19",value:"vaccine",icon:"needle"},{label:"\u0E09\u0E35\u0E14\u0E27\u0E31\u0E04\u0E0B\u0E35\u0E19\u0E25\u0E48\u0E32\u0E2A\u0E38\u0E14",value:"dateCurrent",icon:"calendar",type:"date"},{label:"\u0E09\u0E35\u0E14\u0E27\u0E31\u0E04\u0E0B\u0E35\u0E19\u0E04\u0E23\u0E31\u0E49\u0E07\u0E15\u0E48\u0E2D\u0E44\u0E1B",value:"dateNext",icon:"calendar",type:"date"}],search:{dateCurrent:null,dateNext:null,vaccine:""},loading:!1,mode:"create",dataEdit:null,checked:{label:{value:"vaccine"}},datas:[{label:"\u0E27\u0E31\u0E04\u0E0B\u0E35\u0E19",class:"text-center",value:"vaccine"},{label:"\u0E04\u0E27\u0E32\u0E21\u0E16\u0E35\u0E48/\u0E27\u0E31\u0E04\u0E0B\u0E35\u0E19 (\u0E40\u0E14\u0E37\u0E2D\u0E19)",class:"text-center",value:"frequency"},{label:"\u0E09\u0E35\u0E14\u0E27\u0E31\u0E04\u0E0B\u0E35\u0E19\u0E25\u0E48\u0E32\u0E2A\u0E38\u0E14",class:"text-center",value:"dateCurrent",type:"date"},{label:"\u0E09\u0E35\u0E14\u0E27\u0E31\u0E04\u0E0B\u0E35\u0E19\u0E04\u0E23\u0E31\u0E49\u0E07\u0E15\u0E48\u0E2D\u0E44\u0E1B",class:"text-center",value:"dateNext",type:"date"},{label:"\u0E2B\u0E21\u0E32\u0E22\u0E40\u0E2B\u0E15\u0E38",class:"text-center",value:"remark"}],buttons:[{label:"\u0E25\u0E1A",type:"delete",color:"danger"},{label:"\u0E41\u0E01\u0E49\u0E44\u0E02",type:"edit",color:"warning"}]}},components:{SectionMain:A,LayoutAuthenticated:I,SectionTitleBarSub:R,Table:H,Modal:Q,Criteria:z},computed:{user(){return this.$store.state.auth.user}},created(){this.getDatas()},methods:{async getDatas(e){this.loading=!0;const o=await m.all(e);this.items=[],o.data&&(this.items=o.data.protections),this.loading=!1},async remove(e){this.loading=!0,(await m.delete(e)).data&&this.getDatas(),this.loading=!1,g.fire({icon:"success",title:"\u0E25\u0E1A\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25\u0E2A\u0E33\u0E40\u0E23\u0E47\u0E08"})},edit(e){this.modalData=e,this.mode="edit",this.openModal=!0},reset(){this.search.dateCurrent=null,this.search.dateNext=null,this.search.vaccine=""}}};function Z(e,o,x,V,t,l){const s=n("SectionTitleBarSub"),c=n("Modal"),p=n("Criteria"),f=n("Table"),d=n("SectionMain"),h=n("LayoutAuthenticated");return _(),v(h,null,{default:r(()=>[a(d,null,{default:r(()=>[a(s,{icon:"doctor",title:"\u0E01\u0E32\u0E23\u0E1B\u0E49\u0E2D\u0E07\u0E01\u0E31\u0E19/\u0E1A\u0E33\u0E23\u0E38\u0E07","has-btn-add":"",onOpenModal:o[0]||(o[0]=u=>{t.mode="create",t.openModal=!0}),btnText:"\u0E40\u0E1E\u0E34\u0E48\u0E21\u0E01\u0E32\u0E23\u0E1B\u0E49\u0E2D\u0E07\u0E01\u0E31\u0E19/\u0E1A\u0E33\u0E23\u0E38\u0E07"}),a(c,{modelValue:t.openModal,"onUpdate:modelValue":o[1]||(o[1]=u=>t.openModal=u),data:t.modalData,mode:t.mode,onConfirm:l.getDatas},null,8,["modelValue","data","mode","onConfirm"]),a(p,{grid:"grid-cols-2 lg:grid-cols-4",onSearch:l.getDatas,onReset:l.reset,forms:t.forms,search:t.search},null,8,["onSearch","onReset","forms","search"]),a(f,{title:"\u0E23\u0E32\u0E22\u0E01\u0E32\u0E23\u0E1B\u0E49\u0E2D\u0E07\u0E01\u0E31\u0E19/\u0E1A\u0E33\u0E23\u0E38\u0E07","has-checkbox":"","checked-data":t.checked,items:t.items,datas:t.datas,buttons:t.buttons,onEdit:l.edit,onDelete:l.remove,onDeleteSelected:e.removeSelected,loading:t.loading},null,8,["checked-data","items","datas","buttons","onEdit","onDelete","onDeleteSelected","loading"])]),_:1})]),_:1})}var se=B(Y,[["render",Z]]);export{se as default};
