import{a0 as c,Z as h,N as V,O as x,Q as o,o as b,s as Y,b as r,w as i,i as N,a2 as k,l as T,_ as q,k as O,R as $,g as F,h as j,e as U,U as I,H as B,T as S,c as C,p as L,t as A,j as E,d as P,S as H,P as R,V as Q}from"./index.2c02b274.js";import{T as z,a as Z}from"./Criteria.7267797d.js";import{_ as G}from"./BaseButtons.ba774e2f.js";import{_ as J,a as K}from"./FormField.dd187006.js";import{a as s}from"./auth-header.3e53736b.js";import{T as w}from"./alert.9432a099.js";import"./CardBoxModal.f35e8fbe.js";async function W(t={}){let e="?";if(t.farm&&(e=e+`farm=${t.farm}&`),t.cows&&(e=e+`flag=${t.flag}&`),t.code&&(e=e+`code=${t.code}&`),t.name&&(e=e+`name=${t.name}&`),t.status&&(e=e+`status=${t.status}&`),t.birthDate){const n=h(new Date(t.birthDate)).format("YYYY-MM-DD");e=e+`birthDate=${n}&`}return t.corral&&(e=e+`corral=${t.corral}&`),t?e.replace(/&*$/,""):""}class X{async all(e){const n=await W(e);return c.get("/cow"+n,{headers:s()}).then(f=>f)}get(e){return c.get(`/cow/${e}`,{headers:s()})}create(e){return e.dateCurrent&&(e.dateCurrent=h(new Date(e.dateCurrent)).format("YYYY-MM-DD")),e.dateNext&&(e.dateNext=h(new Date(e.dateNext)).format("YYYY-MM-DD")),c.post("/protection",e,{headers:s()})}delete(e){return c.delete(`/cow/${e}`,{headers:s()})}update(e,n){return c.put(`/cow/${e}`,n,{headers:s()})}}var ee=new X;const te={data(){return{datas:[]}},created(){this.initialData()},computed:{value:{get(){return this.modelValue},set(t){this.$emit("update:modelValue",t)}}},methods:{async initialData(){const t={farm:x().farm._id};try{const e=await ee.all(t);if(this.datas=[],e&&(this.datas=e.data.vaccines,this.datas.map(n=>n.vaccine_data=n.name)),this.defaultValue){const n=this.datas.filter(f=>f[this.defaultType]==this.defaultValue);n&&this.handleInput(this.reduceAction(n[0]))}}catch(e){this.datas=[],console.error("Error: "+e.message)}},reduceAction(t){return this.valueType==="object"?t:t[this.valueType]},handleInput(t){this.$emit("update:value",t),this.dataSelected=this.datas.find(e=>e.name===t),this.$emit("update:dataSelected",this.dataSelected)}},props:{clear:{default:!0,type:Boolean},disabled:{default:!1,type:Boolean},dataSelected:{default:null,type:Object},defaultType:{default:null,type:Object},valueType:{default:"_id",type:Object},defaultValue:{default:null,type:Object},modelValue:{type:[String,Number,Boolean,Array,Object],default:""},multiple:{default:!1,type:Boolean}}},ae={class:"relative"},ne=N(" \u0E44\u0E21\u0E48\u0E1E\u0E1A\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25 ");function re(t,e,n,f,a,l){const d=o("mdicon"),u=o("v-select");return b(),Y("div",ae,[r(u,{class:"ddl",clearable:n.clear,disabled:n.disabled,options:a.datas,reduce:l.reduceAction,label:"vaccine_data",placeholder:"\u0E40\u0E25\u0E37\u0E2D\u0E01\u0E27\u0E31\u0E04\u0E0B\u0E35\u0E19",onInput:l.handleInput,modelValue:l.value,"onUpdate:modelValue":e[0]||(e[0]=p=>l.value=p),dataSelected:n.dataSelected,multiple:""},{"no-options":i(()=>[r(d,{name:"alertCircleOutline",width:"16",height:"16",class:"inline-block"}),ne]),_:1},8,["clearable","disabled","options","reduce","onInput","modelValue","dataSelected"])])}var le=V(te,[["render",re]]);async function oe(t={}){let e="?";if(t.farm&&(e=e+`farm=${t.farm}&`),t.dateCurrent){const n=h(new Date(t.dateCurrent)).format("YYYY-MM-DD");e=e+`dateCurrent=${n}&`}if(t.dateNext){const n=h(new Date(t.dateNext)).format("YYYY-MM-DD");e=e+`dateNext=${n}&`}return t.vaccine&&(e=e+`vaccine=${t.vaccine}&`),t?e.replace(/&*$/,""):""}class ie{async all(e){const n=await oe(e);return c.get("/protection"+n,{headers:s()}).then(f=>f)}get(e){return c.get(`/protection/${e}`,{headers:s()})}create(e){return e.dateCurrent&&(e.dateCurrent=h(new Date(e.dateCurrent)).format("YYYY-MM-DD")),e.dateNext&&(e.dateNext=h(new Date(e.dateNext)).format("YYYY-MM-DD")),c.post("/protection",e,{headers:s()})}delete(e){return c.delete(`/protection/${e}`,{headers:s()})}update(e,n){return c.put(`/protection/${e}`,n,{headers:s()})}}var g=new ie;const ce={data(){return{protection:{dateCurrent:new Date,dateNext:null,vaccine:"",frequency:null,remark:"",farm:x().farm._id},loading:!1,alert:""}},emits:["update:modelValue","cancel","confirm"],computed:{value:{get(){return this.modelValue},set(t){this.$emit("update:modelValue",t)}}},watch:{data(t){t&&this.mode==="edit"&&(this.protection=t,this.protection.dateCurrent=new Date(t.dateCurrent),this.protection.dateNext=new Date(t.dateNext))},"protection.frequency"(t){t&&(this.protection.dateNext=k(new Date(this.protection.dateCurrent),t))}},methods:{clear(){this.protection.dateCurrent=new Date,this.protection.dateNext=null,this.protection.vaccine="",this.protection.frequency="",this.protection.remark=""},confirmCancel(t){this.value=!1,this.$emit(t)},confirm(){this.clear(),this.confirmCancel("confirm")},cancel(){this.clear(),this.confirmCancel("cancel")},async submit(){this.loading=!0,this.alert="";try{this.mode==="create"?await g.create(this.protection)&&(this.loading=!1,this.value=!1,this.confirmCancel("confirm")):await g.update(this.protection._id,this.protection)&&(this.loading=!1,this.value=!1,this.confirmCancel("confirm")),w.fire({icon:"success",title:"\u0E1A\u0E31\u0E19\u0E17\u0E36\u0E01\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25\u0E2A\u0E33\u0E40\u0E23\u0E47\u0E08"})}catch(t){console.error("Error : ",t),this.clear(),this.loading=!1,this.alert=await t.response.data.message,w.fire({icon:"error",title:"\u0E1A\u0E31\u0E19\u0E17\u0E36\u0E01\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25\u0E44\u0E21\u0E48\u0E2A\u0E33\u0E40\u0E23\u0E47\u0E08"})}}},components:{BaseButton:T,BaseButtons:G,CardBox:q,BaseDivider:O,OverlayLayer:$,FormField:J,FormControl:F,NotificationBar:j,BaseLevel:U,DDLVaccine:le,FormCheckRadioPicker:K,BaseIcon:I},props:{modelValue:{type:[String,Number,Boolean],default:null},data:{type:Object,default:null},mode:{type:String,default:""}}},se={class:"grid grid-cols-1 lg:grid-cols-3 gap-8"};function de(t,e,n,f,a,l){const d=o("FormControl"),u=o("FormField"),p=o("NotificationBar"),y=o("BaseDivider"),_=o("BaseButton"),D=o("BaseButtons"),v=o("CardBox"),M=o("OverlayLayer");return B((b(),C(M,null,{default:i(()=>[B(r(v,{title:(this.mode==="create"?"\u0E1A\u0E31\u0E19\u0E17\u0E36\u0E01":"\u0E41\u0E01\u0E49\u0E44\u0E02")+"\u0E01\u0E32\u0E23\u0E1B\u0E49\u0E2D\u0E07\u0E01\u0E31\u0E19/\u0E1A\u0E33\u0E23\u0E38\u0E07",class:"shadow-lg w-full overflow-y-auto lg:w-1/2 z-50","header-icon":"close",modal:"",form:"",onSubmit:P(l.submit,["prevent"]),onHeaderIconClick:l.cancel},{default:i(()=>[L("div",se,[r(u,{label:"\u0E27\u0E31\u0E04\u0E0B\u0E35\u0E19",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:i(()=>[r(d,{modelValue:a.protection.vaccine,"onUpdate:modelValue":e[0]||(e[0]=m=>a.protection.vaccine=m),icon:"vaccine",required:""},null,8,["modelValue"])]),_:1}),r(u,{label:"\u0E04\u0E27\u0E32\u0E21\u0E16\u0E35\u0E48/\u0E27\u0E31\u0E04\u0E0B\u0E35\u0E19 (\u0E40\u0E14\u0E37\u0E2D\u0E19)",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:i(()=>[r(d,{modelValue:a.protection.frequency,"onUpdate:modelValue":e[1]||(e[1]=m=>a.protection.frequency=m),icon:"time",type:"number",required:""},null,8,["modelValue"])]),_:1}),r(u,{label:"\u0E09\u0E35\u0E14\u0E27\u0E31\u0E04\u0E0B\u0E35\u0E19\u0E25\u0E48\u0E32\u0E2A\u0E38\u0E14",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:i(()=>[r(d,{modelValue:a.protection.dateCurrent,"onUpdate:modelValue":e[2]||(e[2]=m=>a.protection.dateCurrent=m),icon:"calendar",type:"date",required:""},null,8,["modelValue"])]),_:1}),r(u,{label:"\u0E09\u0E35\u0E14\u0E27\u0E31\u0E04\u0E0B\u0E35\u0E19\u0E04\u0E23\u0E31\u0E49\u0E07\u0E15\u0E48\u0E2D\u0E44\u0E1B",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:i(()=>[r(d,{modelValue:a.protection.dateNext,"onUpdate:modelValue":e[3]||(e[3]=m=>a.protection.dateNext=m),icon:"calendar",type:"date",required:""},null,8,["modelValue"])]),_:1}),r(u,{label:"\u0E2B\u0E21\u0E32\u0E22\u0E40\u0E2B\u0E15\u0E38"},{default:i(()=>[r(d,{modelValue:a.protection.remark,"onUpdate:modelValue":e[4]||(e[4]=m=>a.protection.remark=m),type:"textarea"},null,8,["modelValue"])]),_:1})]),a.alert?(b(),C(p,{key:0,color:"danger",outline:"",icon:"alertCircleOutline"},{default:i(()=>[N(A(a.alert),1)]),_:1})):E("",!0),r(y),r(D,{type:"justify-center"},{default:i(()=>[r(_,{label:"\u0E1A\u0E31\u0E19\u0E17\u0E36\u0E01",color:"success",type:"submit",loading:a.loading},null,8,["loading"]),r(_,{label:"\u0E22\u0E01\u0E40\u0E25\u0E34\u0E01",color:"danger",onClick:l.cancel},null,8,["onClick"])]),_:1})]),_:1},8,["title","onSubmit","onHeaderIconClick"]),[[S,l.value]])]),_:1},512)),[[S,l.value]])}var ue=V(ce,[["render",de]]);const me={data(){return{openModal:!1,modalData:null,items:[],forms:[{label:"\u0E27\u0E31\u0E04\u0E0B\u0E35\u0E19",value:"vaccine",icon:"vaccine"},{label:"\u0E09\u0E35\u0E14\u0E27\u0E31\u0E04\u0E0B\u0E35\u0E19\u0E25\u0E48\u0E32\u0E2A\u0E38\u0E14",value:"dateCurrent",icon:"calendar",type:"date"},{label:"\u0E09\u0E35\u0E14\u0E27\u0E31\u0E04\u0E0B\u0E35\u0E19\u0E04\u0E23\u0E31\u0E49\u0E07\u0E15\u0E48\u0E2D\u0E44\u0E1B",value:"dateNext",icon:"calendar",type:"date"}],search:{dateCurrent:null,dateNext:null,vaccine:"",farm:x().farm._id},loading:!1,mode:"create",dataEdit:null,checked:{code:{value:""},label:{value:"vaccine"}},datas:[{label:"\u0E27\u0E31\u0E04\u0E0B\u0E35\u0E19",class:"text-center",value:"vaccine"},{label:"\u0E04\u0E27\u0E32\u0E21\u0E16\u0E35\u0E48/\u0E27\u0E31\u0E04\u0E0B\u0E35\u0E19 (\u0E40\u0E14\u0E37\u0E2D\u0E19)",class:"text-center",value:"frequency"},{label:"\u0E09\u0E35\u0E14\u0E27\u0E31\u0E04\u0E0B\u0E35\u0E19\u0E25\u0E48\u0E32\u0E2A\u0E38\u0E14",class:"text-center",value:"dateCurrent",type:"date"},{label:"\u0E09\u0E35\u0E14\u0E27\u0E31\u0E04\u0E0B\u0E35\u0E19\u0E04\u0E23\u0E31\u0E49\u0E07\u0E15\u0E48\u0E2D\u0E44\u0E1B",class:"text-center",value:"dateNext",type:"date"},{label:"\u0E2B\u0E21\u0E32\u0E22\u0E40\u0E2B\u0E15\u0E38",class:"text-center",value:"remark"}],buttons:[{label:"\u0E25\u0E1A",type:"delete",color:"danger"},{label:"\u0E41\u0E01\u0E49\u0E44\u0E02",type:"edit",color:"warning"}]}},components:{SectionMain:H,LayoutAuthenticated:R,SectionTitleBarSub:Q,Table:z,Modal:ue,Criteria:Z},created(){this.getDatas()},methods:{async getDatas(t){this.loading=!0;const e=await g.all(t);this.items=[],e.data&&(this.items=e.data.protections),this.loading=!1},async remove(t){this.loading=!0,(await g.delete(t)).data&&this.getDatas(),this.loading=!1,w.fire({icon:"success",title:"\u0E25\u0E1A\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25\u0E2A\u0E33\u0E40\u0E23\u0E47\u0E08"})},edit(t){this.modalData=t,this.mode="edit",this.openModal=!0},reset(){this.search.dateCurrent=null,this.search.dateNext=null,this.search.vaccine=""}}};function fe(t,e,n,f,a,l){const d=o("SectionTitleBarSub"),u=o("Modal"),p=o("Criteria"),y=o("Table"),_=o("SectionMain"),D=o("LayoutAuthenticated");return b(),C(D,null,{default:i(()=>[r(_,null,{default:i(()=>[r(d,{icon:"doctor",title:"\u0E01\u0E32\u0E23\u0E1B\u0E49\u0E2D\u0E07\u0E01\u0E31\u0E19/\u0E1A\u0E33\u0E23\u0E38\u0E07","has-btn-add":"",onOpenModal:e[0]||(e[0]=v=>{a.mode="create",a.openModal=!0}),btnText:"\u0E40\u0E1E\u0E34\u0E48\u0E21\u0E01\u0E32\u0E23\u0E1B\u0E49\u0E2D\u0E07\u0E01\u0E31\u0E19/\u0E1A\u0E33\u0E23\u0E38\u0E07"}),r(u,{modelValue:a.openModal,"onUpdate:modelValue":e[1]||(e[1]=v=>a.openModal=v),data:a.modalData,mode:a.mode,onConfirm:l.getDatas,onCancel:l.getDatas},null,8,["modelValue","data","mode","onConfirm","onCancel"]),r(p,{grid:"grid-cols-2 lg:grid-cols-4",onSearch:l.getDatas,onReset:l.reset,forms:a.forms,search:a.search},null,8,["onSearch","onReset","forms","search"]),r(y,{title:"\u0E23\u0E32\u0E22\u0E01\u0E32\u0E23\u0E1B\u0E49\u0E2D\u0E07\u0E01\u0E31\u0E19/\u0E1A\u0E33\u0E23\u0E38\u0E07","has-checkbox":"","checked-data":a.checked,items:a.items,datas:a.datas,buttons:a.buttons,onEdit:l.edit,onDelete:l.remove,onDeleteSelected:t.removeSelected,loading:a.loading},null,8,["checked-data","items","datas","buttons","onEdit","onDelete","onDeleteSelected","loading"])]),_:1})]),_:1})}var De=V(me,[["render",fe]]);export{De as default};
