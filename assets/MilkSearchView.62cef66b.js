import{a0 as b,Z as x,N as C,l as F,_ as L,k as E,R as A,g as U,h as O,e as q,Q as n,H as M,T as S,o as u,c as h,w as s,b as l,p as T,i as R,t as j,j as H,d as V,s as z,G as I,n as Q,F as G,S as P,P as W,V as Z}from"./index.02896ed2.js";import{D,T as J}from"./Cow.3933eb33.js";import{_ as N}from"./BaseButtons.564081da.js";import{_ as Y}from"./FormField.d32687d2.js";import{a as w}from"./auth-header.057bd6dc.js";import"./CardBoxModal.478691e3.js";async function K(t={}){let e="?";if(t.cow&&(e=e+`cow=${t.cow}&`),t.date){const i=x(new Date(t.date)).format("YYYY-MM-DD");e=e+`date=${i}&`}return t.quantity&&(e=e+`quantity=${t.quantity}&`),t?e.replace(/&*$/,""):""}class X{async all(e){const i=await K(e);return b.get("/milking"+i,{headers:w()}).then(B=>B)}get(e){return b.get(`/milking/${e}`,{headers:w()})}create(e){return e.date&&(e.date=x(new Date(e.date)).format("YYYY-MM-DD")),b.post("/milking",e,{headers:w()})}delete(e){return b.delete(`/milking/${e}`,{headers:w()})}update(e,i){return b.put(`/milking/${e}`,i,{headers:w()})}}var v=new X;const $={data(){return{milk:{cow:null,date:new Date,morningQty:0,afternoonQty:0,amount:0},loading:!1,alert:""}},emits:["update:modelValue","cancel","confirm"],computed:{sumQty(){return this.milk.morningQty+this.milk.afternoonQty},calAmount(){return this.milk.amount=(this.milk.morningQty+this.milk.afternoonQty)*100,this.milk.amount},value:{get(){return this.modelValue},set(t){this.$emit("update:modelValue",t)}}},watch:{dataEdit:{handler(t,e){t!=null&&this.mode=="edit"&&(this.milk=t,this.milk.date=new Date(t.date))},deep:!0}},methods:{clear(){var t;this.mode==="edit"&&this.$emit("update:dataEdit",null),this.milk.cow=null,this.milk.date=new Date,this.milk.morningQty=0,this.milk.afternoonQty=0,this.milk.amount=0,(t=this.milk)==null||delete t._id},confirmCancel(t){this.value=!1,this.$emit(t)},confirm(){this.clear(),this.confirmCancel("confirm")},cancel(){this.clear(),this.confirmCancel("cancel")},async submit(){this.loading=!0,this.alert="";try{this.mode==="create"?await v.create(this.milk)&&(this.loading=!1,this.value=!1,this.confirmCancel("confirm")):await v.update(this.milk._id,this.milk)&&(this.loading=!1,this.value=!1,this.confirmCancel("confirm"))}catch(t){console.error("Error : ",t),this.loading=!1,this.alert=t.response.data.message}}},components:{BaseButton:F,BaseButtons:N,CardBox:L,BaseDivider:E,OverlayLayer:A,FormField:Y,FormControl:U,NotificationBar:O,BaseLevel:q,DDLCow:D},props:{modelValue:{type:[String,Number,Boolean],default:null},mode:{type:String,default:""},dataEdit:{type:Object,default:null}}},ee={class:"grid grid-cols-1 lg:grid-cols-2 gap-3 mt-1"};function te(t,e,i,B,a,o){const m=n("FormControl"),d=n("FormField"),y=n("DDLCow"),g=n("NotificationBar"),f=n("BaseDivider"),_=n("BaseButton"),p=n("BaseButtons"),r=n("CardBox"),k=n("OverlayLayer");return M((u(),h(k,null,{default:s(()=>[M(l(r,{title:i.mode==="create"?"\u0E40\u0E1E\u0E34\u0E48\u0E21\u0E01\u0E32\u0E23\u0E23\u0E35\u0E14\u0E19\u0E21":"\u0E41\u0E01\u0E49\u0E44\u0E02\u0E01\u0E32\u0E23\u0E23\u0E35\u0E14\u0E19\u0E21",class:"shadow-lg w-full overflow-y-auto lg:w-1/3 z-50","header-icon":"close",modal:"",form:"",onSubmit:V(o.submit,["prevent"]),onHeaderIconClick:o.cancel},{default:s(()=>[T("div",ee,[l(d,{label:"\u0E27\u0E31\u0E19\u0E17\u0E35\u0E48\u0E23\u0E35\u0E14\u0E19\u0E21",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:s(()=>[l(m,{modelValue:a.milk.date,"onUpdate:modelValue":e[0]||(e[0]=c=>a.milk.date=c),icon:"calendar",type:"date",required:""},null,8,["modelValue"])]),_:1}),l(d,{label:"\u0E42\u0E04",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:s(()=>[l(y,{modelValue:a.milk.cow,"onUpdate:modelValue":e[1]||(e[1]=c=>a.milk.cow=c)},null,8,["modelValue"])]),_:1}),l(d,{label:"\u0E1B\u0E23\u0E34\u0E21\u0E32\u0E13\u0E19\u0E49\u0E33\u0E19\u0E21/\u0E40\u0E0A\u0E49\u0E32",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:s(()=>[l(m,{modelValue:a.milk.morningQty,"onUpdate:modelValue":e[2]||(e[2]=c=>a.milk.morningQty=c),type:"number",icon:"weatherSunsetUp"},null,8,["modelValue"])]),_:1}),l(d,{label:"\u0E1B\u0E23\u0E34\u0E21\u0E32\u0E13\u0E19\u0E49\u0E33\u0E19\u0E21/\u0E1A\u0E48\u0E32\u0E22",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:s(()=>[l(m,{modelValue:a.milk.afternoonQty,"onUpdate:modelValue":e[3]||(e[3]=c=>a.milk.afternoonQty=c),type:"number",icon:"weatherSunsetDown"},null,8,["modelValue"])]),_:1}),l(d,{label:"\u0E1B\u0E23\u0E34\u0E21\u0E32\u0E13\u0E19\u0E49\u0E33\u0E19\u0E21\u0E23\u0E27\u0E21",help:"\u0E04\u0E33\u0E19\u0E27\u0E13\u0E2D\u0E31\u0E15\u0E42\u0E19\u0E21\u0E31\u0E15\u0E34"},{default:s(()=>[l(m,{modelValue:o.sumQty,"onUpdate:modelValue":e[4]||(e[4]=c=>o.sumQty=c),type:"number",disabled:"",icon:"water"},null,8,["modelValue"])]),_:1}),l(d,{label:"\u0E08\u0E33\u0E19\u0E27\u0E19\u0E40\u0E07\u0E34\u0E19\u0E23\u0E27\u0E21",help:"\u0E04\u0E33\u0E19\u0E27\u0E13\u0E2D\u0E31\u0E15\u0E42\u0E19\u0E21\u0E31\u0E15\u0E34 (\u0E23\u0E32\u0E04\u0E32\u0E19\u0E21/\u0E01\u0E01. = 100.00)"},{default:s(()=>[l(m,{modelValue:o.calAmount,"onUpdate:modelValue":e[5]||(e[5]=c=>o.calAmount=c),type:"number",icon:"cashMultiple"},null,8,["modelValue"])]),_:1})]),a.alert?(u(),h(g,{key:0,color:"danger",outline:"",icon:"alertCircleOutline"},{default:s(()=>[R(j(a.alert),1)]),_:1})):H("",!0),l(f),l(p,{type:"justify-center"},{default:s(()=>[l(_,{label:"\u0E1A\u0E31\u0E19\u0E17\u0E36\u0E01",color:"success",type:"submit",loading:a.loading},null,8,["loading"]),l(_,{label:"\u0E22\u0E01\u0E40\u0E25\u0E34\u0E01",color:"danger",onClick:o.cancel},null,8,["onClick"])]),_:1})]),_:1},8,["title","onSubmit","onHeaderIconClick"]),[[S,o.value]])]),_:1},512)),[[S,o.value]])}var le=C($,[["render",te]]);const ae={props:{title:{type:String,default:""},grid:{type:String,default:"grid-cols-4"},forms:{type:Array,default:[]},search:{type:Object,default:null}},components:{BaseButton:F,BaseButtons:N,BaseDivider:E,CardBox:L,FormField:Y,FormControl:U,DDLCow:D},methods:{submit(){this.$emit("search",this.search)},reset(){this.$emit("reset",this.search)}}};function ne(t,e,i,B,a,o){const m=n("DDLCow"),d=n("FormControl"),y=n("FormField"),g=n("BaseDivider"),f=n("BaseButton"),_=n("BaseButtons"),p=n("CardBox");return u(),h(p,{title:i.title,icon:"",form:"",class:"mb-3","header-icon":"",onSubmit:V(o.submit,["prevent"]),onReset:V(o.reset,["prevent"])},{default:s(()=>[T("div",{class:Q(["grid gap-5",[i.grid]])},[(u(!0),z(G,null,I(i.forms,r=>(u(),h(y,{key:r.value,label:r.label,class:Q([r.class])},{default:s(()=>[r.type==="ddl"&&r.module==="cow"?(u(),h(m,{key:0,modelValue:i.search[r.value],"onUpdate:modelValue":k=>i.search[r.value]=k},null,8,["modelValue","onUpdate:modelValue"])):(u(),h(d,{key:1,modelValue:i.search[r.value],"onUpdate:modelValue":k=>i.search[r.value]=k,icon:r.icon,type:r.type},null,8,["modelValue","onUpdate:modelValue","icon","type"]))]),_:2},1032,["label","class"]))),128))],2),l(g),l(_,{type:"justify-center","no-wrap":""},{default:s(()=>[l(f,{type:"submit",color:"info",label:"\u0E04\u0E49\u0E19\u0E2B\u0E32"}),l(f,{type:"reset",color:"danger",label:"\u0E25\u0E49\u0E32\u0E07"})]),_:1})]),_:1},8,["title","onSubmit","onReset"])}var oe=C(ae,[["render",ne]]);const ie={data(){return{modalMilk:!1,items:[],forms:[{label:"\u0E42\u0E04",class:"lg:col-start-2",value:"cow",type:"ddl",module:"cow"},{label:"\u0E27\u0E31\u0E19\u0E17\u0E35\u0E48\u0E23\u0E35\u0E14\u0E19\u0E21",value:"date",icon:"calendar",type:"date"}],search:{cow:null,date:null},loading:!1,mode:"create",dataEdit:null,datas:[{label:"\u0E27\u0E31\u0E19\u0E17\u0E35\u0E48\u0E23\u0E35\u0E14\u0E19\u0E21",class:"text-center",type:"date",value:"date"},{label:"\u0E42\u0E04",class:"text-center",value:"cow.name"},{label:"\u0E1B\u0E23\u0E34\u0E21\u0E32\u0E13\u0E19\u0E49\u0E33\u0E19\u0E21\u0E14\u0E34\u0E1A/\u0E40\u0E0A\u0E49\u0E32 (\u0E01\u0E01.)",class:"text-center",value:"morningQty"},{label:"\u0E1B\u0E23\u0E34\u0E21\u0E32\u0E13\u0E19\u0E49\u0E33\u0E19\u0E21\u0E14\u0E34\u0E1A/\u0E1A\u0E48\u0E32\u0E22 (\u0E01\u0E01.)",class:"text-center",value:"afternoonQty"},{label:"\u0E1B\u0E23\u0E34\u0E21\u0E32\u0E13\u0E19\u0E49\u0E33\u0E19\u0E21\u0E14\u0E34\u0E1A\u0E23\u0E27\u0E21 (\u0E01\u0E01.)",class:"text-center",func:t=>t.morningQty+t.afternoonQty},{label:"\u0E08\u0E33\u0E19\u0E27\u0E19\u0E40\u0E07\u0E34\u0E19\u0E23\u0E27\u0E21",class:"text-right",type:"number",value:"amount"}],button:{edit:!0,delete:!0}}},components:{SectionMain:P,LayoutAuthenticated:W,Table:J,SectionTitleBarSub:Z,DDLCow:D,MilkModal:le,Criteria:oe},created(){this.getMilks()},methods:{async getMilks(t){this.loading=!0;const e=await v.all(t);this.items=[],e.data&&(this.items=e.data.milkings),this.loading=!1},async removeMilk(t){this.loading=!0,(await v.delete(t)).data&&this.getMilks(),this.loading=!1},edit(t){this.dataEdit=t,this.dataEdit.cow=t.cow._id,this.mode="edit",this.modalMilk=!0},reset(){this.search.cow=null,this.search.date=null}}};function se(t,e,i,B,a,o){const m=n("SectionTitleBarSub"),d=n("MilkModal"),y=n("Criteria"),g=n("Table"),f=n("SectionMain"),_=n("LayoutAuthenticated");return u(),h(_,null,{default:s(()=>[l(f,null,{default:s(()=>[l(m,{icon:"cupWater",title:"\u0E01\u0E32\u0E23\u0E23\u0E35\u0E14\u0E19\u0E21",btnText:"\u0E40\u0E1E\u0E34\u0E48\u0E21\u0E01\u0E32\u0E23\u0E23\u0E35\u0E14\u0E19\u0E21","has-btn-add":"",onOpenModal:e[0]||(e[0]=p=>{a.mode="create",a.modalMilk=!0})}),l(d,{modelValue:a.modalMilk,"onUpdate:modelValue":e[1]||(e[1]=p=>a.modalMilk=p),mode:a.mode,dataEdit:a.dataEdit,onConfirm:o.getMilks,onCancel:o.getMilks},null,8,["modelValue","mode","dataEdit","onConfirm","onCancel"]),l(y,{title:"\u0E04\u0E49\u0E19\u0E2B\u0E32\u0E01\u0E32\u0E23\u0E23\u0E35\u0E14\u0E19\u0E21",grid:"grid-cols-2 lg:grid-cols-4",onSearch:o.getMilks,onReset:o.reset,forms:a.forms,search:a.search},null,8,["onSearch","onReset","forms","search"]),l(g,{title:"\u0E23\u0E32\u0E22\u0E01\u0E32\u0E23\u0E23\u0E35\u0E14\u0E19\u0E21","has-checkbox":"",checkedLabel:"cow.name",items:a.items,datas:a.datas,button:a.button,onEdit:o.edit,onDelete:o.removeMilk,onDeleteSelected:t.removeSelected},null,8,["items","datas","button","onEdit","onDelete","onDeleteSelected"])]),_:1})]),_:1})}var fe=C(ie,[["render",se]]);export{fe as default};
