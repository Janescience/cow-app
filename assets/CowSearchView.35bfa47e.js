import{N as A,e as M,Q as d,o as h,c as v,w as i,p as n,O as E,l as j,_ as I,k as R,R as K,g as N,h as W,f as Y,H as P,T as S,b as a,i as T,t as _,j as O,d as L,S as X,P as Z,U as $,V as ee,s as V,F as U,G as F}from"./index.8283c5b3.js";import{_ as H}from"./BaseButtons.c22eaddc.js";import{_ as te}from"./CardBoxModal.d6ef96a2.js";import{_ as q}from"./FormField.d110645b.js";import{C as D,_ as ae,D as le}from"./Cow.82dd88a4.js";import"./auth-header.2a074e3c.js";const oe={computed:{value:{get(){return this.modelValue},set(l){this.$emit("update:modelValue",l)}}},methods:{chooseImg(){let l=document.getElementById("imageUpload");l!=null&&l.click()},handleFile(l){var e=l.target.files||l.dataTransfer.files;!e.length||this.createBase64(e[0])},createBase64(l){var e=new FileReader;e.onload=u=>{this.value=u.target.result},e.readAsDataURL(l)}},components:{BaseLevel:M},props:{modelValue:{type:String,default:""}}},se=["src"];function ne(l,e,u,w,t,r){const y=d("BaseLevel");return h(),v(y,{type:"justify-center mb-1"},{default:i(()=>[n("input",{id:"imageUpload",onChange:e[0]||(e[0]=(...c)=>r.handleFile&&r.handleFile(...c)),type:"file",accept:"image/*",hidden:""},null,32),n("img",{class:"w-56 cursor-pointer rounded-lg",onClick:e[1]||(e[1]=(...c)=>r.chooseImg&&r.chooseImg(...c)),src:r.value},null,8,se)]),_:1})}var re=A(oe,[["render",ne]]);const ie={data(){return{cow:{image:"../../src/assets/image/img-mockup.png",code:"",name:"",status:"1",birthDate:null,corral:"",dad:"",mom:"",farm:E().farm._id},status:[{id:1,label:"\u0E17\u0E49\u0E2D\u0E07"},{id:2,label:"\u0E19\u0E21\u0E41\u0E2B\u0E49\u0E07"},{id:3,label:"\u0E43\u0E2B\u0E49\u0E1C\u0E25\u0E1C\u0E25\u0E34\u0E15"},{id:4,label:"\u0E27\u0E31\u0E27\u0E40\u0E14\u0E47\u0E01"}],loading:!1,alert:""}},emits:["update:modelValue","cancel","confirm"],computed:{value:{get(){return this.modelValue},set(l){this.$emit("update:modelValue",l)}}},watch:{dataEdit:{handler(l,e){l!=null&&this.mode=="edit"&&(this.cow=l,this.cow.image=this.cow.image?this.cow.image:"../../src/assets/image/img-mockup.png")},deep:!0}},methods:{clear(){this.$emit("update:dataEdit",null),this.cow.image="../../src/assets/image/img-mockup.png",this.cow.code="",this.cow.name="",this.cow.birthDate=null,this.cow.status=1,this.cow.corral="",this.cow.dad="",this.cow.mom="",delete this.cow._id},confirmCancel(l){this.value=!1,this.$emit(l)},confirm(){this.clear(),this.confirmCancel("confirm")},cancel(){this.clear(),this.confirmCancel("cancel")},async submit(){this.loading=!0,this.alert="";try{this.mode==="create"?await D.create(this.cow)&&(this.loading=!1,this.value=!1,this.confirmCancel("confirm")):await D.update(this.cow._id,this.cow)&&(this.loading=!1,this.value=!1,this.confirmCancel("confirm"))}catch(l){console.error("Error : ",l),this.loading=!1,this.alert=l.response.data.message}}},components:{BaseButton:j,BaseButtons:H,CardBox:I,BaseDivider:R,OverlayLayer:K,FormField:q,FormControl:N,NotificationBar:W,UserAvatar:Y,BaseLevel:M,ImageUpload:re},props:{modelValue:{type:[String,Number,Boolean],default:null},mode:{type:String,default:""},dataEdit:{type:Object,default:null}}},de=T(" \u0E2D\u0E31\u0E1E\u0E42\u0E2B\u0E25\u0E14\u0E23\u0E39\u0E1B\u0E20\u0E32\u0E1E (\u0E04\u0E25\u0E34\u0E01\u0E17\u0E35\u0E48\u0E23\u0E39\u0E1B) "),ce={class:"grid lg:grid-cols-4 grid-cols-2 gap-5 mt-3"};function me(l,e,u,w,t,r){const y=d("ImageUpload"),c=d("BaseLevel"),f=d("FormControl"),p=d("FormField"),b=d("NotificationBar"),C=d("BaseDivider"),o=d("BaseButton"),g=d("BaseButtons"),B=d("CardBox"),k=d("OverlayLayer");return P((h(),v(k,null,{default:i(()=>[P(a(B,{title:u.mode==="create"?"\u0E40\u0E1E\u0E34\u0E48\u0E21\u0E42\u0E04":"\u0E41\u0E01\u0E49\u0E44\u0E02\u0E42\u0E04",class:"shadow-lg w-full overflow-y-auto md:w-3/5 lg:w-1/1 z-50","header-icon":"close",modal:"",form:"",onSubmit:L(r.submit,["prevent"]),onHeaderIconClick:r.cancel},{default:i(()=>[a(y,{modelValue:t.cow.image,"onUpdate:modelValue":e[0]||(e[0]=m=>t.cow.image=m)},null,8,["modelValue"]),a(c,{type:"justify-center mb-6"},{default:i(()=>[de]),_:1}),n("div",ce,[a(p,{label:"\u0E23\u0E2B\u0E31\u0E2A\u0E42\u0E04",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:i(()=>[a(f,{modelValue:t.cow.code,"onUpdate:modelValue":e[1]||(e[1]=m=>t.cow.code=m),icon:"barcode",required:""},null,8,["modelValue"])]),_:1}),a(p,{label:"\u0E0A\u0E37\u0E48\u0E2D\u0E42\u0E04",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:i(()=>[a(f,{modelValue:t.cow.name,"onUpdate:modelValue":e[2]||(e[2]=m=>t.cow.name=m),icon:"cow",required:""},null,8,["modelValue"])]),_:1}),a(p,{label:"\u0E27\u0E31\u0E19\u0E40\u0E01\u0E34\u0E14",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:i(()=>[a(f,{modelValue:t.cow.birthDate,"onUpdate:modelValue":e[3]||(e[3]=m=>t.cow.birthDate=m),icon:"calendar",type:"date",required:""},null,8,["modelValue"])]),_:1}),a(p,{label:"\u0E2A\u0E16\u0E32\u0E19\u0E30",help:"* \u0E2B\u0E49\u0E32\u0E21\u0E27\u0E48\u0E32\u0E07"},{default:i(()=>[a(f,{modelValue:t.cow.status,"onUpdate:modelValue":e[4]||(e[4]=m=>t.cow.status=m),options:t.status,icon:"",required:""},null,8,["modelValue","options"])]),_:1}),a(p,{label:"\u0E04\u0E2D\u0E01"},{default:i(()=>[a(f,{modelValue:t.cow.corral,"onUpdate:modelValue":e[5]||(e[5]=m=>t.cow.corral=m),icon:"barn"},null,8,["modelValue"])]),_:1}),a(p,{label:"\u0E1E\u0E48\u0E2D\u0E1E\u0E31\u0E19\u0E18\u0E38\u0E4C"},{default:i(()=>[a(f,{modelValue:t.cow.dad,"onUpdate:modelValue":e[6]||(e[6]=m=>t.cow.dad=m),icon:"genderMale"},null,8,["modelValue"])]),_:1}),a(p,{label:"\u0E41\u0E21\u0E48\u0E1E\u0E31\u0E19\u0E18\u0E38\u0E4C"},{default:i(()=>[a(f,{modelValue:t.cow.mom,"onUpdate:modelValue":e[7]||(e[7]=m=>t.cow.mom=m),icon:"genderFemale"},null,8,["modelValue"])]),_:1})]),t.alert?(h(),v(b,{key:0,color:"danger",outline:"",icon:"alertCircleOutline"},{default:i(()=>[T(_(t.alert),1)]),_:1})):O("",!0),a(C),a(g,{type:"justify-center"},{default:i(()=>[a(o,{label:"\u0E1A\u0E31\u0E19\u0E17\u0E36\u0E01",color:"success",type:"submit",loading:t.loading},null,8,["loading"]),a(o,{label:"\u0E22\u0E01\u0E40\u0E25\u0E34\u0E01",color:"danger",onClick:r.cancel},null,8,["onClick"])]),_:1})]),_:1},8,["title","onSubmit","onHeaderIconClick"]),[[S,r.value]])]),_:1},512)),[[S,r.value]])}var ue=A(ie,[["render",me]]),he=e=>{var e=new Date(e),u=e.getYear(),w=e.getMonth(),t=e.getDate(),r=new Date,y=r.getYear(),c=r.getMonth(),f=r.getDate(),o={},g="",p=y-u;if(c>=w)var b=c-w;else{p--;var b=12+c-w}if(f>=t)var C=f-t;else{b--;var C=31+f-t;b<0&&(b=11,p--)}var o={years:p,months:b,days:C},g="";return o.years>0&&o.months>0&&o.days>0?g=o.years+" \u0E1B\u0E35 "+o.months+" \u0E40\u0E14\u0E37\u0E2D\u0E19 "+o.days+" \u0E27\u0E31\u0E19":o.years==0&&o.months==0&&o.days>0?g=o.days+" \u0E27\u0E31\u0E19":o.years>0&&o.months==0&&o.days==0?g=o.years+" \u0E1B\u0E35 (\u0E27\u0E31\u0E19\u0E40\u0E01\u0E34\u0E14)":o.years>0&&o.months>0&&o.days==0?g=o.years+" \u0E1B\u0E35 "+o.months+" \u0E40\u0E14\u0E37\u0E2D\u0E19":o.years==0&&o.months>0&&o.days>0?g=o.months+" \u0E40\u0E14\u0E37\u0E2D\u0E19 "+o.days+" \u0E27\u0E31\u0E19":o.years>0&&o.months==0&&o.days>0?g=o.years+" \u0E1B\u0E35 "+o.days+" \u0E27\u0E31\u0E19":o.years==0&&o.months>0&&o.days==0&&(g=o.months+" \u0E40\u0E14\u0E37\u0E2D\u0E19"),g};const fe={data(){return{modalCow:!1,status:[{id:"",label:"\u0E17\u0E31\u0E49\u0E07\u0E2B\u0E21\u0E14"},{id:1,label:"\u0E17\u0E49\u0E2D\u0E07"},{id:2,label:"\u0E19\u0E21\u0E41\u0E2B\u0E49\u0E07"},{id:3,label:"\u0E43\u0E2B\u0E49\u0E1C\u0E25\u0E1C\u0E25\u0E34\u0E15"},{id:4,label:"\u0E27\u0E31\u0E27\u0E40\u0E14\u0E47\u0E01"}],textConfirm:"",modalConfirm:!1,funcConfirm:Function,idConfirm:null,perPage:10,currentPage:0,checkedRows:[],items:[],search:{code:null,status:"",birthDate:null,corral:"",flag:"Y",farm:E().farm._id},loading:!1,mode:"create",dataEdit:null}},components:{SectionMain:X,LayoutAuthenticated:Z,BaseButton:j,BaseIcon:$,BaseButtons:H,CardBox:I,UserAvatar:Y,TableCheckboxCell:ae,CardBoxModal:te,BaseLevel:M,FormControl:N,FormField:q,BaseDivider:R,DDLCow:le,CreateCowModal:ue},created(){this.getCows()},computed:{itemsPaginated(){return this.items?this.items.slice(this.perPage*this.currentPage,this.perPage*(this.currentPage+1)):[]},numPages(){return Math.ceil((this.items?this.items.length:0)/this.perPage)},currentPageHuman(){return this.currentPage+1},pagesList(){const l=[];for(let e=0;e<this.numPages;e++)l.push(e);return l}},methods:{async getCows(){this.loading=!0;const l=await D.all(this.search);this.items=[],l.data&&(this.items=l.data.cows),this.loading=!1},async removeCow(){this.loading=!0,(await D.update(this.idConfirm,{flag:"N"})).data&&this.getCows(),this.loading=!1},edit(l){this.dataEdit=l,this.mode="edit",this.dataEdit.birthDate=new Date(this.dataEdit.birthDate),this.modalCow=!0},reset(){this.search.code=null,this.search.status="",this.search.birthDate=null,this.search.corral=""},checked(l,e){l?(e.checked=!0,this.checkedRows.push(e)):(e.checked=!1,this.checkedRows=this.removeArr(this.checkedRows,u=>u._id===e._id))},removeArr(l,e){const u=[];return l.forEach(w=>{e(w)||u.push(w)}),u},confirm(l,e,u){this.textConfirm=l,this.funcConfirm=u,this.idConfirm=e,this.modalConfirm=!0},countChecked(){return this.checkedRows.length>0?"(\u0E40\u0E25\u0E37\u0E2D\u0E01 "+this.checkedRows.length+" \u0E23\u0E32\u0E22\u0E01\u0E32\u0E23)":""},calAge(l){return he(l)},formatDate(l){return l?ee(new Date(l)).format("DD/MM/YYYY"):""}}},pe={class:"px-6 sm:px-0 mb-6 flex items-center justify-between"},ge={class:"flex items-center justify-start"},_e=n("h1",{class:"text-2xl"}," \u0E42\u0E04 ",-1),we={class:"grid lg:grid-cols-4 md:grid-cols-3 grid-cols-2 gap-5"},be={key:0,class:"p-3 bg-gray-100/50 dark:bg-gray-800"},Ce={class:"overflow-x-auto"},ve=n("thead",null,[n("tr",null,[n("th",{class:"text-center whitespace-nowrap"},"\u0E40\u0E25\u0E37\u0E2D\u0E01"),n("th",{class:"text-center whitespace-nowrap"},"\u0E23\u0E39\u0E1B\u0E20\u0E32\u0E1E"),n("th",{class:"text-center whitespace-nowrap"},"\u0E23\u0E2B\u0E31\u0E2A\u0E42\u0E04"),n("th",{class:"text-center whitespace-nowrap"},"\u0E0A\u0E37\u0E48\u0E2D\u0E42\u0E04 "),n("th",{class:"text-center whitespace-nowrap"},"\u0E27\u0E31\u0E19\u0E40\u0E01\u0E34\u0E14"),n("th",{class:"text-center"},"\u0E2D\u0E32\u0E22\u0E38 "),n("th",{class:"text-center"},"\u0E2A\u0E16\u0E32\u0E19\u0E30 "),n("th",{class:"text-center"},"\u0E04\u0E2D\u0E01 "),n("th",{class:"text-center whitespace-nowrap"},"\u0E1E\u0E48\u0E2D\u0E1E\u0E31\u0E19\u0E18\u0E38\u0E4C "),n("th",{class:"text-center whitespace-nowrap"},"\u0E41\u0E21\u0E48\u0E1E\u0E31\u0E19\u0E18\u0E38\u0E4C "),n("th")])],-1),ye={class:"border-b-0 lg:w-6 before:hidden"},Be={"data-label":"\u0E23\u0E2B\u0E31\u0E2A\u0E42\u0E04",class:"whitespace-nowrap"},ke={"data-label":"\u0E0A\u0E37\u0E48\u0E2D\u0E42\u0E04",class:"whitespace-nowrap"},Ve={"data-label":"\u0E27\u0E31\u0E19\u0E40\u0E01\u0E34\u0E14",class:"text-center"},xe={"data-label":"\u0E2D\u0E32\u0E22\u0E38",class:"whitespace-nowrap"},De={"data-label":"\u0E2A\u0E16\u0E32\u0E19\u0E30",class:"whitespace-nowrap"},Ue={"data-label":"\u0E04\u0E2D\u0E01"},Fe={"data-label":"\u0E1E\u0E48\u0E2D\u0E1E\u0E31\u0E19\u0E18\u0E38\u0E4C",class:"whitespace-nowrap"},Le={"data-label":"\u0E41\u0E21\u0E48\u0E1E\u0E31\u0E19\u0E18\u0E38\u0E4C",class:"whitespace-nowrap"},Ae={class:"lg:w-6 whitespace-nowrap"},Me={class:"p-3 lg:px-6 border-t border-gray-100 dark:border-gray-800"};function Pe(l,e,u,w,t,r){const y=d("BaseIcon"),c=d("BaseButton"),f=d("CreateCowModal"),p=d("CardBoxModal"),b=d("DDLCow"),C=d("FormField"),o=d("FormControl"),g=d("BaseDivider"),B=d("BaseButtons"),k=d("CardBox"),m=d("TableCheckboxCell"),z=d("UserAvatar"),G=d("BaseLevel"),Q=d("SectionMain"),J=d("LayoutAuthenticated");return h(),v(J,null,{default:i(()=>[a(Q,null,{default:i(()=>[n("section",pe,[n("div",ge,[a(y,{path:"cow",size:"30",class:"mr-3"}),_e]),a(c,{label:"\u0E40\u0E1E\u0E34\u0E48\u0E21\u0E42\u0E04",color:"success",onClick:e[0]||(e[0]=s=>{t.mode="create",t.modalCow=!0})})]),a(f,{modelValue:t.modalCow,"onUpdate:modelValue":e[1]||(e[1]=s=>t.modalCow=s),onConfirm:r.getCows,onCancel:r.getCows,mode:t.mode,dataEdit:t.dataEdit},null,8,["modelValue","onConfirm","onCancel","mode","dataEdit"]),a(p,{modelValue:t.modalConfirm,"onUpdate:modelValue":e[2]||(e[2]=s=>t.modalConfirm=s),title:"\u0E22\u0E37\u0E19\u0E22\u0E31\u0E19\u0E2D\u0E35\u0E01\u0E04\u0E23\u0E31\u0E49\u0E07","button-label":"\u0E22\u0E37\u0E19\u0E22\u0E31\u0E19",onConfirm:t.funcConfirm,"has-cancel":"","has-button":""},{default:i(()=>[n("p",null,_(t.textConfirm),1)]),_:1},8,["modelValue","onConfirm"]),a(k,{title:"\u0E04\u0E49\u0E19\u0E2B\u0E32\u0E42\u0E04",icon:"",form:"",class:"mb-3","header-icon":"",onSubmit:L(r.getCows,["prevent"]),onReset:L(r.reset,["prevent"])},{default:i(()=>[n("div",we,[a(C,{label:"\u0E42\u0E04"},{default:i(()=>[a(b,{modelValue:t.search.code,"onUpdate:modelValue":e[3]||(e[3]=s=>t.search.code=s),valueType:"code"},null,8,["modelValue"])]),_:1}),a(C,{label:"\u0E27\u0E31\u0E19\u0E40\u0E01\u0E34\u0E14"},{default:i(()=>[a(o,{modelValue:t.search.birthDate,"onUpdate:modelValue":e[4]||(e[4]=s=>t.search.birthDate=s),icon:"calendar",type:"date"},null,8,["modelValue"])]),_:1}),a(C,{label:"\u0E2A\u0E16\u0E32\u0E19\u0E30"},{default:i(()=>[a(o,{modelValue:t.search.status,"onUpdate:modelValue":e[5]||(e[5]=s=>t.search.status=s),options:t.status},null,8,["modelValue","options"])]),_:1}),a(C,{label:"\u0E04\u0E2D\u0E01"},{default:i(()=>[a(o,{modelValue:t.search.corral,"onUpdate:modelValue":e[6]||(e[6]=s=>t.search.corral=s),icon:"barn"},null,8,["modelValue"])]),_:1})]),a(g),a(B,{type:"justify-center","no-wrap":""},{default:i(()=>[a(c,{type:"submit",color:"info",label:"\u0E04\u0E49\u0E19\u0E2B\u0E32"}),a(c,{type:"reset",color:"danger",label:"\u0E25\u0E49\u0E32\u0E07"})]),_:1})]),_:1},8,["onSubmit","onReset"]),r.itemsPaginated.length>0?(h(),v(k,{key:0,title:"\u0E23\u0E32\u0E22\u0E01\u0E32\u0E23\u0E42\u0E04 "+r.countChecked(),class:"shadow-lg","has-table":"","header-icon":""},{default:i(()=>[t.checkedRows.length>0?(h(),V("div",be,[(h(!0),V(U,null,F(t.checkedRows,s=>(h(),V("span",{key:s._id,class:"inline-block px-2 py-1 rounded-sm mr-2 text-sm bg-gray-100 dark:bg-gray-700 mb-1"},_(s.name),1))),128)),a(B,{type:"justify-start lg:justify-end","no-wrap":""},{default:i(()=>[a(c,{color:"danger",label:"\u0E25\u0E1A\u0E17\u0E31\u0E49\u0E07\u0E2B\u0E21\u0E14",onClick:e[7]||(e[7]=s=>l.isModalActive=!0)})]),_:1})])):O("",!0),n("div",Ce,[n("table",null,[ve,n("tbody",null,[(h(!0),V(U,null,F(r.itemsPaginated,s=>(h(),V("tr",{key:s._id},[a(m,{isChecked:s.checked,class:"text-center border-b-0 lg:w-6 before:hidden",onChecked:x=>r.checked(x,s)},null,8,["isChecked","onChecked"]),n("td",ye,[a(z,{avatar:s.image,class:"w-36 mx-auto lg:h-20 lg:w-20"},null,8,["avatar"])]),n("td",Be,[n("span",null,_(s.code),1)]),n("td",ke,_(s.name),1),n("td",Ve,_(r.formatDate(s.birthDate)),1),n("td",xe,_(r.calAge(s.birthDate)),1),n("td",De,_(t.status[s.status].label),1),n("td",Ue,_(s.corral),1),n("td",Fe,_(s.dad),1),n("td",Le,_(s.mom),1),n("td",Ae,[a(B,{type:"justify-end lg:justify-start","no-wrap":""},{default:i(()=>[a(c,{color:"danger",label:"\u0E25\u0E1A",onClick:x=>r.confirm("\u0E22\u0E37\u0E19\u0E22\u0E31\u0E19\u0E25\u0E1A\u0E42\u0E04 "+s.name+" \u0E43\u0E0A\u0E48\u0E2B\u0E23\u0E37\u0E2D\u0E44\u0E21\u0E48 ?",s._id,r.removeCow)},null,8,["onClick"]),a(c,{color:"warning",label:"\u0E41\u0E01\u0E49\u0E44\u0E02",onClick:x=>r.edit(s)},null,8,["onClick"]),a(c,{color:"info",label:"\u0E23\u0E32\u0E22\u0E25\u0E30\u0E40\u0E2D\u0E35\u0E22\u0E14",onClick:x=>l.detail(s._id)},null,8,["onClick"])]),_:2},1024)])]))),128))])])]),n("div",Me,[a(G,null,{default:i(()=>[a(B,null,{default:i(()=>[(h(!0),V(U,null,F(r.pagesList,s=>(h(),v(c,{key:s,active:s===t.currentPage,label:s+1,small:"",onClick:x=>t.currentPage=s},null,8,["active","label","onClick"]))),128))]),_:1}),n("small",null,"\u0E2B\u0E19\u0E49\u0E32 "+_(r.currentPageHuman)+" \u0E08\u0E32\u0E01 "+_(r.numPages),1)]),_:1})])]),_:1},8,["title"])):t.loading?(h(),v(k,{key:1,loading:""})):(h(),v(k,{key:2,empty:""}))]),_:1})]),_:1})}var Ye=A(fe,[["render",Pe]]);export{Ye as default};
